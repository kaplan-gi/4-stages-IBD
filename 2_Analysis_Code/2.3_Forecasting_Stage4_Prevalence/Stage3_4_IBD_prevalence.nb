(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    235361,       5175]
NotebookOptionsPosition[    225981,       5029]
NotebookOutlinePosition[    226377,       5045]
CellTagsIndexPosition[    226334,       5042]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["IBD Prevalence Modelling: Stage 3 & 4", "Chapter",
 CellChangeTimes->{{3.872775102000132*^9, 3.872775108325241*^9}, {
  3.887216916720684*^9, 3.887216941133984*^9}, {3.887217273662074*^9, 
  3.887217274894718*^9}, {3.913891583699381*^9, 
  3.913891584461204*^9}},ExpressionUUID->"e430721c-6c94-4807-8361-\
69747299fb80"],

Cell[CellGroupData[{

Cell["The Notebook", "Section",
 CellChangeTimes->{{3.8872173173180647`*^9, 
  3.887217337680772*^9}},ExpressionUUID->"7bd6f294-6512-4c33-b551-\
23c2f5d5cd00"],

Cell[TextData[{
 "This notebook is designed to find the prevalence as a function of time for \
a chronic disease under the assumption that the population mortality, ",
 StyleBox["m",
  FontSlant->"Italic"],
 "(",
 StyleBox["t",
  FontSlant->"Italic"],
 ", ",
 StyleBox["a",
  FontSlant->"Italic"],
 "), recovery rate, ",
 StyleBox["r",
  FontSlant->"Italic"],
 "(",
 StyleBox["t, a",
  FontSlant->"Italic"],
 "), and migration term, \[Mu](",
 StyleBox["t",
  FontSlant->"Italic"],
 ",",
 StyleBox["a",
  FontSlant->"Italic"],
 "), in the differential equation (Brinks ",
 StyleBox["et al",
  FontSlant->"Italic"],
 "., \[CloseCurlyDoubleQuote]Age- and time-dependent model of the prevalence \
of non-communicable diseases and application to dementia in Germany,\
\[CloseCurlyDoubleQuote] ",
 StyleBox["Theoretical Population Biology",
  FontSlant->"Italic"],
 " ",
 StyleBox["92",
  FontWeight->"Bold"],
 ", 62-68 (2014))\n\n(1) \t\t\t\t\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[PartialD]", 
        RowBox[{"\[PartialD]", "t"}]], 
       RowBox[{"+", 
        FractionBox["\[PartialD]", 
         RowBox[{"\[PartialD]", "a"}]]}]}], ")"}], "p"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"[", 
       RowBox[{"1", "-", 
        RowBox[{"p", "(", 
         RowBox[{"t", ",", "a"}], ")"}]}], "]"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i", "(", 
         RowBox[{"t", ",", "a"}], ")"}], "-", 
        RowBox[{
         RowBox[{"m", "(", 
          RowBox[{"t", ",", "a"}], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"p", "(", 
            RowBox[{"t", ",", "a"}], ")"}], "[", 
           RowBox[{
            RowBox[{"R", "(", 
             RowBox[{"t", ",", "a"}], ")"}], "-", "1"}], "]"}], 
          RowBox[{
           RowBox[{"[", 
            RowBox[{
             RowBox[{"R", "(", 
              RowBox[{"t", ",", "a"}], ")"}], "-", "1"}], "]"}], "+", 
           "1"}]]}]}], "}"}]}], "-", 
     RowBox[{
      RowBox[{"r", "(", 
       RowBox[{"t", ",", "a"}], ")"}], 
      RowBox[{"p", "(", 
       RowBox[{"t", ",", "a"}], ")"}]}], "+", 
     RowBox[{"\[Mu]", "(", 
      RowBox[{"t", ",", "a"}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "ce0be1b2-3607-4400-a628-f5939ab24fc9"],
 "\n\ncan be neglected. We can also assume that the incidence ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"i", "(", 
     RowBox[{"t", ",", "a"}], ")"}], "=", 
    RowBox[{"i", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "3765ff2a-c2d6-4cc1-81fa-a08c79cfd7bd"],
 " is independent of time; however, this constraint can be relaxed if the \
incidence can be assumed to be piecewise constant in time.\n\nThe notebook \
will use user-defined initial conditions, incidence, and population \
age-structure CSVs as input data for the solution to a simplified version of \
Equation 1. There are three types of  files and they must have the following \
characteristics:\n\n\t",
 StyleBox["Initial conditions",
  FontWeight->"Bold"],
 ".\n\t\t- ",
 StyleBox["File",
  FontSlant->"Italic"],
 ". The notebook will use only one file under the \
\[OpenCurlyDoubleQuote]initial_prevalence\[CloseCurlyDoubleQuote] directory \
and the name must contain the year the data were observed\n\t\t\t\
initial_prevalence/<start_year>.csv\n\t\t- ",
 StyleBox["Contents",
  FontSlant->"Italic"],
 ". The age-dependent prevalence at the model start date. The file must have \
a header\n\t\t   \tAge,Prevalence\n\t\t   with two data columns\n\t\t\t\
average-age-in-bin,prevalence-at-average-age-in-bin\n\t\t   ",
 StyleBox["Note 1",
  FontWeight->"Bold"],
 ". The average-age-in-bin should be the mean values between the edges of the \
age bin or range. For example, if the age range of the first bin is 0-17, the \
average-age-in-bin would be 8.5.\n\t\t   ",
 StyleBox["Note 2",
  FontWeight->"Bold"],
 ". The prevalence must be a decimal number between 0 and 1.\n\t\t- ",
 StyleBox["Use",
  FontSlant->"Italic"],
 ". These data will be used as the initial condition for the age- and \
time-dependent solution to the simplified version of Equation 1.\n\t\t\n\t",
 StyleBox["Incidence",
  FontWeight->"Bold"],
 ".\n\t\t- ",
 StyleBox["File",
  FontSlant->"Italic"],
 ". At least one required, but multiple allowed. Each file must contain the \
age-dependent incidence rate at a specific date that is encoded in the file \
name under the \[OpenCurlyDoubleQuote]incidence\[CloseCurlyDoubleQuote] \
directory. \n\t\t\tincidence/<year>.csv\n\t\t  For example, if there is data \
for the incidence rate for the years 2000, 2010, and 2020, the file names \
would be\n\t\t\tincidence/2000.csv\t\n\t\t\tincidence/2010.csv\t\n\t\t\t\
incidence/2020.csv\n\t \t- ",
 StyleBox["Contents",
  FontSlant->"Italic"],
 ". The age-dependent incidence rate. The file must have a header\n\t \t\t\
Age,IncidenceRate\n\t \t   with two data columns:\n\t \t \t\
average-age-in-bin,incidence-rate-at-average-age-in-bin\n\t \t    ",
 StyleBox["Note 1",
  FontWeight->"Bold"],
 ". The average-age-in-bin should be the mean values between the edges of the \
age bin or range. For example, if the age range of the first bin is 0-17, the \
average-age-in-bin would be 8.5.\n\t \t    ",
 StyleBox["Note 2",
  FontWeight->"Bold"],
 ". The incidence rate must be a decimal number, not a number per hundred \
thousand.\n\t \t    ",
 StyleBox["Note 3",
  FontWeight->"Bold"],
 ". To complete all of the computations in this notebook, the first year of \
incidence data should correspond to the date on which one has initial \
prevalence data.\n\t\t- ",
 StyleBox["Use",
  FontSlant->"Italic"],
 ". These data will be used as the incidences at various times for the age- \
and time-dependent solution to the simplified version of Equation 1.\n\t \t \n\
",
 StyleBox["\tPopulation age-structure",
  FontWeight->"Bold"],
 ".\n\t\t- ",
 StyleBox["File",
  FontSlant->"Italic"],
 ". At least one required, but multiple allowed. Each file must contain the \
age-dependent population at a specific date that is encoded in the file name \
under the \[OpenCurlyDoubleQuote]population\[CloseCurlyDoubleQuote] \
directory. \n\t\t\tpopulation/<year>.csv\n\t\t  For example, if there is data \
for the population for the years 2000, 2010, and 2020, the file names would \
be\n\t\t\tpopulation/2000.csv\t\n\t\t\tpopulation/2010.csv\t\n\t\t\t\
population/2020.csv\n\t \t- ",
 StyleBox["Contents",
  FontSlant->"Italic"],
 ". The age-dependent population fraction. The file must have a header\n\t \t\
\tAge,Population,Fraction\n\t \t   with three data columns:\n\t \t \t\
average-age-in-bin,population-at-average-age-in-bin,normalised-fraction-at-\
average-age-in-bin\n\t \t    ",
 StyleBox["Note 1",
  FontWeight->"Bold"],
 ". The average-age-in-bin should be the mean values between the edges of the \
age bin or range. For example, if the age range of the first bin is 0-17, the \
average-age-in-bin would be 8.5.\n\t \t    ",
 StyleBox["Note 2",
  FontWeight->"Bold"],
 ". The normalised-fraction-at-average-age-in-bin value must be a decimal \
number (the fraction of the population in that age bin, normalised to the \t\
width of the bin). Note that in the event that the normalisation is not \
perfect, these data are renormalised later in the the notebook.\n\t \t - ",
 StyleBox["Use",
  FontSlant->"Italic"],
 ". This will be used to integrate out the age dependence from the age- and \
time-dependent solution to the simplified version of  Equation 1, creating a \
time-dependent prevalence."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQncXeGOH+7Y3jo2LuFBDNycWQCaLZD/tXg2hP24xm
EP3A3G0+iJ54RX8xiH6XkfcQRN/ZY/MKRK9szQHTUhYqn0F0xq7Ddh5Aum/p
IQ8Q3TPN0A9EuzaE7kkC0tZmt4+D6I8lv56C6EW73v0G0U6TlycmA+lXz26A
aYng7EIQvdP5VgWI/npCaB+IdvBSPg6iH9m47UoB0m1TJh4A0QXP9/KnAmkZ
sduCINptzoViafm3jhdCrWtA9DUpqwh1zbeOk96JJ4Dobw/T0sB8w4P5IFrg
U2sxiHYTdiwB0Xa711aCaCkzoyoQPS0urA5E3++yXwqirzE8/QSib9Sv/gWi
TfgqmDSAtE+xDx+IfrRxynFdIF29fx6YXpSsUhsBpJc0OYNpALzOxLE=
  "],ExpressionUUID->"86175990-b432-49f8-8008-a9587fef0032"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Solution", "Section",
 CellChangeTimes->{{3.887217278079603*^9, 
  3.8872173064536953`*^9}},ExpressionUUID->"2fec88c8-fcd3-4a3d-8ba3-\
099c31e7900a"],

Cell[TextData[{
 "We will use a closed-form solution of the prevalence as a function of time \
and age to create rough predictions of the final two stages of the evolution \
of chronic disease prevalence as a function of age and time. First, let\
\[CloseCurlyQuote]s start with the simplified PDE for prevalence (this \
mortality, recover rate, and migration set to zero)\n\n(2)\t\t\t\t\t\t\t\t\t \
\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[PartialD]", 
        RowBox[{"\[PartialD]", "t"}]], 
       RowBox[{"+", 
        FractionBox["\[PartialD]", 
         RowBox[{"\[PartialD]", "a"}]]}]}], ")"}], "p"}], "=", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"1", "-", 
       RowBox[{"p", "(", 
        RowBox[{"t", ",", "a"}], ")"}]}], "]"}], 
     RowBox[{"i", "(", 
      RowBox[{"a", ",", "t"}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "5f6dc20a-b9ae-4399-809a-527e0a66a25b"],
 ".\n\nFor most western countries, where net immigration exceeds net \
emigration and immigrants typically have a lower IBD prevalence than \
emigrants, the effect will be to over-estimate the prevalence. \n\nWe then \
set ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{"1", "-", "p"}]}], TraditionalForm]],ExpressionUUID->
  "5b27b640-b602-4560-81aa-95fba54cce71"],
 " to yield the McKendrick-von Foerster equation\n\n(3)\t\t\t\t\t\t\t\t\t\t\t\
\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "t"], "u"}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "a"], "u"}]}], "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"i", "(", 
       RowBox[{"t", ",", "a"}], ")"}]}], " ", "u"}]}], TraditionalForm]],
  ExpressionUUID->"8eef0a12-ab86-4014-93b7-7d2fb049192f"],
 ",\n\nwith\n\t1.  the initial condition  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{"0", ",", "a"}], ")"}], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["p", "0"], "(", "a", ")"}], " ", "\[Implies]", " ", 
      RowBox[{"u", "(", 
       RowBox[{"0", ",", "a"}], ")"}]}], "=", 
     RowBox[{"1", "-", 
      RowBox[{
       SubscriptBox["p", "0"], "(", "a", ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"c0de1ef4-503c-4b94-910f-d5b97250f7db"],
 " for some initial age-distribution, and\n\t2.  the boundary condition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{"t", ",", "0"}], ")"}], "=", 
    RowBox[{
     RowBox[{"0", "\[Implies]", 
      RowBox[{"u", "(", 
       RowBox[{"t", ",", "0"}], ")"}]}], "=", "1"}]}], TraditionalForm]],
  ExpressionUUID->"da5f10d6-51a9-40d1-a7b6-29357bb01abd"],
 ", indicating that the prevalence must always go to zero when the age is \
zero.\n\nNote that for the boundary and initial conditions to be consistent, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{"0", ",", 
      RowBox[{"a", "=", "0"}]}], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "0"], "(", "0", ")"}], "=", "0"}]}], 
   TraditionalForm]],ExpressionUUID->"79843487-bbaf-4d8b-b181-e9e97e2d83b7"],
 ".\n\nEquation 2 is identical in form to the equation governing \
age-stratified population changes in a population with an age-varying and \
time-varying death rate and a constant (in time and age) birth rate.\n\nUsing \
the method of characteristics, one can solve the equation in two separate \
regions in space, allowing both the initial condition and bounds condition to \
be applied to the solution (see page 114, equation 1 of A.D. Polyanin, V. F. \
Zaitsev, and A. Mousiaux, \[OpenCurlyDoubleQuote]Handbook of First-Order \
Partial Differential Equations: v. 1(Differential and Integral Equations and \
Their Applications,\[CloseCurlyDoubleQuote] CRC Press (Taylor & Francis \
Group), 2001). \n\nIn the region ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "<=", "t", "<", "a"}], TraditionalForm]],ExpressionUUID->
  "5f413a63-e337-49f1-b578-fa9be7516bfd"],
 ", the initial condition, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"u", "(", 
     RowBox[{"0", ",", "a"}], ")"}], ","}], TraditionalForm]],ExpressionUUID->
  "85a65edc-3390-44d0-88b2-b4353e9f2d03"],
 " must be used to generate the solution\n\n(4)\t\t\t \t\t\t\t\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{"t", ",", "a"}], ")"}], "=", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"[", 
       RowBox[{"1", "-", 
        RowBox[{"p", "(", 
         RowBox[{"0", ",", 
          RowBox[{"a", "-", "t"}]}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{
         SubsuperscriptBox["\[Integral]", "0", "t"], 
         RowBox[{
          RowBox[{"i", "(", 
           RowBox[{"x", ",", 
            RowBox[{"x", "+", "a", "-", "t"}]}], ")"}], 
          RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}]}]}]}], 
   TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "14e823e9-0c17-403e-9d47-6eff940eda6e"],
 ",\n\nwhile in the region ",
 Cell[BoxData[
  FormBox[
   RowBox[{"0", "<=", "a", "<", "t"}], TraditionalForm]],ExpressionUUID->
  "e71e4ede-bc75-485d-ad60-4b149e585c59"],
 ", the boundary condition, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "(", 
    RowBox[{"t", ",", "0"}], ")"}], TraditionalForm]],ExpressionUUID->
  "52215215-5f39-440e-8685-6aefe90cfcb3"],
 ", must be used to yield\n\n(5)\t\t\t\t\t\t\t\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", 
     RowBox[{"t", ",", "a"}], ")"}], "=", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"[", 
       RowBox[{"1", "-", 
        RowBox[{"p", "(", 
         RowBox[{
          RowBox[{"t", "-", "a"}], ",", "0"}], ")"}]}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox[
          SubscriptBox["\[Integral]", "0"], "a"], 
         RowBox[{
          RowBox[{"i", "(", 
           RowBox[{
            RowBox[{"x", "+", "t", "-", "a"}], ",", "x"}], ")"}], 
          RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}]}]}]}], 
   TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "a2b9fe80-662f-48df-af4e-4d3e61ca9c5a"],
 ".\n\nTo define the prevalence at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", "=", "t"}], TraditionalForm]],ExpressionUUID->
  "dd0ef0c7-c5e0-4f91-94f4-d623fce92c75"],
 ", we will use an average over points equidistantly displaced a very small \
distance on either side of that line.\n\nThe age-independent prevalence at \
any time can be calculated where there exists age-structured population data. \
To do this, we multiply the the prevalence as a function of time and age, ",
 StyleBox["p",
  FontSlant->"Italic"],
 "(",
 StyleBox["t",
  FontSlant->"Italic"],
 ", ",
 StyleBox["a",
  FontSlant->"Italic"],
 "), by the normalised population age-distribution at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "t"], "(", "a", ")"}], TraditionalForm]],ExpressionUUID->
  "3927d030-c9c4-4426-b4b4-5005a6c5053a"],
 ", as per\n\n(6)\t\t\t \t\t\t\t\t\t\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", "t", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
     RowBox[{
      RowBox[{"p", "(", 
       RowBox[{"t", ",", "a"}], ")"}], 
      RowBox[{
       SubscriptBox["q", "t"], "(", "a", ")"}], 
      RowBox[{"\[DifferentialD]", "a"}]}]}]}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "338496e9-1ce8-45d8-ab92-ca5326e5ad50"],
 ".\n\nThe result depends on time only and can be used to extrapolate the \
prevalence into the future."
}], "Text",
 CellChangeTimes->{{3.872775122160392*^9, 3.8727754873393087`*^9}, {
   3.872779238039228*^9, 3.8727793450092916`*^9}, {3.872779487133151*^9, 
   3.872779527364933*^9}, 3.8727797253650084`*^9, {3.8727799182565613`*^9, 
   3.872779929665019*^9}, {3.8727800059675827`*^9, 3.872780008350583*^9}, {
   3.872780946811638*^9, 3.872781030919199*^9}, {3.872781168912114*^9, 
   3.872781169039295*^9}, {3.872781546723598*^9, 3.8727816200760593`*^9}, 
   3.87278168451891*^9, {3.8727843574535923`*^9, 3.8727845809073467`*^9}, {
   3.872784616474413*^9, 3.8727846637737494`*^9}, {3.8727847066529016`*^9, 
   3.872784767676753*^9}, {3.872785503043083*^9, 3.872785513954855*^9}, {
   3.87278570718961*^9, 3.872785707189805*^9}, {3.872845180949094*^9, 
   3.872845180949335*^9}, {3.872849238612382*^9, 3.8728492520549593`*^9}, {
   3.872849673406315*^9, 3.8728498202637167`*^9}, {3.87285615695831*^9, 
   3.872856245675643*^9}, {3.873106292495159*^9, 3.8731062952856083`*^9}, {
   3.873131736369131*^9, 3.873131740627269*^9}, {3.873131806240048*^9, 
   3.873131819425581*^9}, {3.874421114520513*^9, 3.87442111808737*^9}, {
   3.88721695844081*^9, 3.887217226187709*^9}, {3.8872172643000517`*^9, 
   3.8872172725124893`*^9}, {3.887217313227592*^9, 3.887217313358392*^9}, {
   3.887217443536024*^9, 3.8872174525654593`*^9}, {3.889880068867831*^9, 
   3.88988009453508*^9}, {3.890041419619101*^9, 3.890041689421483*^9}, 
   3.89004177894274*^9, {3.890042361361443*^9, 3.890042369148281*^9}, {
   3.890042424411811*^9, 3.890042518728842*^9}, {3.890042559564855*^9, 
   3.890042620066716*^9}, {3.9138911311885777`*^9, 3.913891323541279*^9}, {
   3.913891369441003*^9, 3.913891392650632*^9}, {3.913891507547017*^9, 
   3.913891546089971*^9}, {3.917006631053534*^9, 3.917007137030571*^9}, {
   3.9170071871135397`*^9, 3.917007310698243*^9}, {3.917007341491538*^9, 
   3.917007388955068*^9}, {3.921231208481086*^9, 
   3.921231248597891*^9}},ExpressionUUID->"8e7fecf3-81af-4c99-91cd-\
c5c999a09c19"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Country-Dependent Variables for Simulations", "Section",
 CellChangeTimes->{{3.8872192195265017`*^9, 3.8872192204394073`*^9}, {
  3.887219325881373*^9, 3.887219330876498*^9}, {3.9022272541329412`*^9, 
  3.9022272725603113`*^9}},ExpressionUUID->"2befff29-4607-43ee-b123-\
d9cc4ba1f79d"],

Cell[TextData[{
 "The listed variables are required to simulate the time-dependent prevalence \
for the countries below.\n\nNote that often the incidence and prevalence data \
for 2020 differ from expectations based on the previous few years of data. \
This could be an effect of under-reporting due to COVID-19. As such, all \
projections will start in 2019 or earlier unless the data are clearly \
consistent with that from earlier years.\n\n",
 StyleBox["NOTE",
  FontWeight->"Bold"],
 ": For countries in IBD Epidemiological Stage 3, all incidence averages will \
use up to the eight most recent years of data."
}], "Text",
 CellChangeTimes->{{3.887274557200183*^9, 3.887274580531761*^9}, {
   3.8872748089835052`*^9, 3.887274866605139*^9}, {3.890043163982441*^9, 
   3.8900432184794283`*^9}, {3.890043275426342*^9, 3.8900432959256077`*^9}, 
   3.9022272447759323`*^9, {3.9022272753068943`*^9, 3.902227320441353*^9}, {
   3.920450119640329*^9, 3.920450248109309*^9}, {3.920980948861041*^9, 
   3.920981055736229*^9}},ExpressionUUID->"f1f05168-c25b-4119-932b-\
dc60df1c1edc"],

Cell[CellGroupData[{

Cell["Canada", "Subsubsection",
 CellChangeTimes->{{3.901983036405815*^9, 
  3.901983049028824*^9}},ExpressionUUID->"579eb7ff-cc38-456b-9e23-\
2900d76ac18e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"country", "=", "\"\<Canada\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidenceYears", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2007", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevalenceYears", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2002", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populationYears", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"2002", " ", "+", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "41"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionStartYear", "=", 
   RowBox[{"prevalenceYears", "\[LeftDoubleBracket]", 
    RowBox[{"Length", "[", "prevalenceYears", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionEndYear", "=", "2043"}], ";"}]}], "Input",
 CellChangeTimes->{{3.90198307468703*^9, 3.9019830963955517`*^9}, {
   3.901983126856586*^9, 3.901983161687944*^9}, {3.90198332335846*^9, 
   3.901983323537815*^9}, {3.902220815495474*^9, 3.9022208158785667`*^9}, {
   3.902227399597664*^9, 3.902227412895335*^9}, {3.902227470595296*^9, 
   3.902227471866489*^9}, 3.902661408847064*^9, {3.9086233497040977`*^9, 
   3.908623355143009*^9}, 3.9139746060976763`*^9, 3.913974662872924*^9, {
   3.9139754188308992`*^9, 3.913975419640411*^9}, {3.920448569988717*^9, 
   3.92044861058906*^9}, 3.920448678132271*^9, {3.9204490416989107`*^9, 
   3.920449057246427*^9}, {3.920887813195368*^9, 3.9208878180113173`*^9}, 
   3.920887872296856*^9, {3.929196118630452*^9, 3.929196124293407*^9}, {
   3.929431527613659*^9, 3.929431554174246*^9}, 
   3.9387773703078737`*^9},ExpressionUUID->"95366923-800c-4510-bbca-\
c99dce6b2b3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Denmark", "Subsubsection",
 CellChangeTimes->{{3.901983166838369*^9, 
  3.9019831699872913`*^9}},ExpressionUUID->"cda8a5c9-65a1-4d8a-a948-\
017a5c9f8634"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"country", "=", "\"\<Denmark\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidenceYears", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2010", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevalenceYears", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2010", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populationYears", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"2010", " ", "+", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "33"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionStartYear", "=", 
   RowBox[{"prevalenceYears", "\[LeftDoubleBracket]", 
    RowBox[{"Length", "[", "prevalenceYears", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionEndYear", "=", "2043"}], ";"}]}], "Input",
 CellChangeTimes->{{3.90198307468703*^9, 3.9019830963955517`*^9}, {
   3.901983126856586*^9, 3.901983197913259*^9}, {3.901983325689535*^9, 
   3.901983325913652*^9}, {3.9019833959343348`*^9, 3.9019834341129093`*^9}, {
   3.902220811500951*^9, 3.902220812153638*^9}, {3.902227415054207*^9, 
   3.902227425360694*^9}, {3.902227464712845*^9, 3.90222746766003*^9}, {
   3.902242777885796*^9, 3.902242806169161*^9}, 3.9026614069355392`*^9, {
   3.9088899719187307`*^9, 3.908889978354851*^9}, {3.908976072402714*^9, 
   3.908976072503455*^9}, {3.9139745989342813`*^9, 3.913974601361971*^9}, 
   3.913974660110531*^9, {3.913975422005239*^9, 3.913975422386827*^9}, {
   3.920448576363605*^9, 3.920448614146913*^9}, 3.920448683736968*^9, {
   3.920449060259179*^9, 3.9204490633459187`*^9}, {3.9208878237494183`*^9, 
   3.92088782434907*^9}, 
   3.920887867210552*^9},ExpressionUUID->"62e2124d-bb5b-490d-ae13-\
5c501600d4f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scotland - Lothian", "Subsubsection",
 CellChangeTimes->{{3.901983166838369*^9, 3.9019831699872913`*^9}, {
   3.9019832162023687`*^9, 3.901983220051197*^9}, {3.902227336370977*^9, 
   3.902227337900536*^9}, {3.920543871618223*^9, 3.9205438738452253`*^9}, {
   3.923652026363592*^9, 3.923652031379023*^9}, 
   3.9387766509122963`*^9},ExpressionUUID->"755412ed-7b01-492a-b3e6-\
5e44fcd37f2e"],

Cell[TextData[{
 StyleBox["Note",
  FontWeight->"Bold"],
 ": The 2018-2020 prevalence data is incomplete (missing data for specific \
age ranges) or inconsistent with previous years, so it will not be used in \
the model."
}], "Text",
 CellChangeTimes->{{3.9024998619605417`*^9, 3.902499908791205*^9}, {
  3.902499958965201*^9, 3.9024999894976*^9}, {3.909057407686255*^9, 
  3.909057425898179*^9}, {3.909218084558601*^9, 3.909218097618326*^9}, {
  3.913893134115988*^9, 3.913893138874411*^9}, {3.913974671337483*^9, 
  3.913974730343216*^9}},ExpressionUUID->"fbcc6daa-7dd3-4746-9b19-\
0d37b4ff1117"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"country", "=", "\"\<Scotland_Lothian\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidenceYears", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2010", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevalenceYears", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2009", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "8"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populationYears", "=", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"2009", "+", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "34"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionStartYear", "=", 
   RowBox[{"prevalenceYears", "\[LeftDoubleBracket]", 
    RowBox[{"Length", "[", "prevalenceYears", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionEndYear", "=", "2043"}], ";"}]}], "Input",
 CellChangeTimes->{{3.90198307468703*^9, 3.9019830963955517`*^9}, {
   3.901983126856586*^9, 3.901983197913259*^9}, {3.901983239313559*^9, 
   3.901983240209059*^9}, 3.9019833298175507`*^9, {3.9019833648415623`*^9, 
   3.90198339384203*^9}, {3.902220804539918*^9, 3.9022208065130463`*^9}, {
   3.902227427474429*^9, 3.9022274343596907`*^9}, {3.902227475164345*^9, 
   3.9022274764560328`*^9}, {3.902497439718102*^9, 3.902497535612887*^9}, {
   3.902499858533345*^9, 3.902499859495058*^9}, {3.90888336220862*^9, 
   3.908883368840219*^9}, {3.9088899905936403`*^9, 3.908889990666841*^9}, 
   3.909056288438673*^9, {3.909057382421177*^9, 3.9090573956140137`*^9}, 
   3.9139746095466223`*^9, {3.913974747861877*^9, 3.913974759223606*^9}, {
   3.917282075905533*^9, 3.9172820804614773`*^9}, {3.920448578831975*^9, 
   3.920448580718602*^9}, {3.920448616152748*^9, 3.920448616674654*^9}, 
   3.9204486873256702`*^9, {3.920449065301154*^9, 3.920449068498019*^9}, {
   3.920543853866679*^9, 3.920543856654941*^9}, {3.92088783193925*^9, 
   3.92088786013314*^9}},ExpressionUUID->"abe92b34-73aa-4c67-992e-\
eaa963301146"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loading the data", "Section",
 CellChangeTimes->{{3.901983250294942*^9, 
  3.901983261926572*^9}},ExpressionUUID->"b2dbf604-abce-4337-9fc1-\
b443afbda1d8"],

Cell[TextData[{
 "The rest of the notebook will require the following variables be set.\n\n1) \
",
 StyleBox["subType",
  FontWeight->"Bold"],
 ". The disease-specific and/or sex-specific data sub-type to load.\n2) ",
 StyleBox["country",
  FontWeight->"Bold"],
 ". The country\[CloseCurlyQuote]s data that should be loaded.\n3) ",
 StyleBox["incidenceYears",
  FontWeight->"Bold"],
 ". Years for which incidence data will be loaded (for average initial \
incidence).\n4) ",
 StyleBox["populationYears",
  FontWeight->"Bold"],
 ". Years on which the population age-structure is known.\n5) ",
 StyleBox["projectionStartYear",
  FontWeight->"Bold"],
 ". The start year for the projection.\n6) ",
 StyleBox["projectionEndYear",
  FontWeight->"Bold"],
 ". The end year for the projection.\n\nOne also needs to set the root \
directories from which the data will be loaded and to which data will be \
saved. Here, the country name is part of the directory tree.\n\n",
 StyleBox["Note 1",
  FontWeight->"Bold"],
 ". The incidence data is currently averaged to produce a mean incidence and \
95% confidence intervals. It is not used to create an age- and time-dependent \
incidence, although with some straightforward modification, it could be.\n",
 StyleBox["Note 2",
  FontWeight->"Bold"],
 ". The incidenceYears, prevalenceYears, and populationYears variables allow \
loading of specific data sets. Each type of data (incidence rate, prevalence, \
population distributions) is located in its own directory, and the \
age-distributions for each year are found in file named <data_years>.csv. "
}], "Text",
 CellChangeTimes->{{3.901983274681876*^9, 3.901983285862118*^9}, 
   3.901983335386366*^9, {3.9022272486364098`*^9, 3.902227250172907*^9}, {
   3.9138916065339518`*^9, 3.91389171275604*^9}, {3.913892790026762*^9, 
   3.913892821875222*^9}, {3.913892940305894*^9, 3.913893051287549*^9}, {
   3.913977940236021*^9, 3.913978007291174*^9}, 3.913978050310717*^9, {
   3.9139894741162653`*^9, 3.913989474317669*^9}, {3.928248695583815*^9, 
   3.92824894213122*^9}, {3.928249644952962*^9, 3.928249651980661*^9}, 
   3.928249704208323*^9, {3.928250340289784*^9, 3.928250341368742*^9}, {
   3.9282508263712463`*^9, 3.928250896326831*^9}, {3.9387768337738543`*^9, 
   3.938776967657525*^9}},ExpressionUUID->"90a716b0-6034-4129-a192-\
046569864003"],

Cell[CellGroupData[{

Cell["Sub-Types", "Subsubsection",
 CellChangeTimes->{{3.928250750234852*^9, 
  3.928250753485586*^9}},ExpressionUUID->"72ad302b-a21c-4f1a-9793-\
fb8412f55a94"],

Cell["\<\
These are the possible sub-types of disease and sex, and correspond to \
directory names where the yearly age-distributed incidence rate, prevalence, \
and population distributions are stored. Note that we typically combine the \
ulcerative colitis and unknown IBD type data in pre-processing, so the \
\[OpenCurlyDoubleQuote]ibdu\[CloseCurlyDoubleQuote] (and similar) variables \
are not often used.\
\>", "Text",
 CellChangeTimes->{{3.9282506473859377`*^9, 3.928250696354968*^9}, {
  3.9282507306708107`*^9, 3.928250743666312*^9}, {3.938776994533803*^9, 
  3.9387771382278757`*^9}},ExpressionUUID->"d8762fda-d5f7-4226-a04f-\
787e3bc081b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subTypes", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<cd\>\"", ",", "\[IndentingNewLine]", "\"\<cd-in-females-only\>\"", 
     ",", "\"\<cd-in-males-only\>\"", ",", "\[IndentingNewLine]", 
     "\"\<cd-females-in-total\>\"", ",", "\"\<cd-males-in-total\>\"", ",", 
     "\[IndentingNewLine]", "\"\<uc\>\"", ",", "\[IndentingNewLine]", 
     "\"\<uc-in-females-only\>\"", ",", "\"\<uc-in-males-only\>\"", ",", 
     "\[IndentingNewLine]", "\"\<uc-females-in-total\>\"", ",", 
     "\"\<uc-males-in-total\>\"", ",", "\[IndentingNewLine]", "\"\<ibdu\>\"", 
     ",", "\[IndentingNewLine]", "\"\<ibdu-in-females-only\>\"", ",", 
     "\"\<ibdu-in-males-only\>\"", ",", "\[IndentingNewLine]", 
     "\"\<ibdu-females-in-total\>\"", ",", "\"\<ibdu-males-in-total\>\"", ",",
      "\[IndentingNewLine]", "\"\<in-females-only\>\"", ",", 
     "\"\<in-males-only\>\"", ",", "\[IndentingNewLine]", 
     "\"\<females-in-total\>\"", ",", "\"\<males-in-total\>\"", ",", 
     "\[IndentingNewLine]", "\"\<total\>\""}], "\[IndentingNewLine]", "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{
  3.928250318710949*^9},ExpressionUUID->"d75a6f22-ab2b-4fb8-acac-\
95f22676a355"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variables", "Subsubsection",
 CellChangeTimes->{{3.9282507639299917`*^9, 
  3.9282507648861103`*^9}},ExpressionUUID->"14631489-77a5-476d-9529-\
294c77a7f26c"],

Cell["Variables required for loading of the data.", "Text",
 CellChangeTimes->{{3.928250345784198*^9, 
  3.9282503569607964`*^9}},ExpressionUUID->"5c8305e4-8cdf-4bd3-a986-\
dd65d9c462e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"subType", "=", "\"\<total\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"country", "=", "\"\<Canada_5_yr_washout\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidenceYears", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2007", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "7"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevalenceYears", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"2002", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populationYears", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"2002", " ", "+", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "41"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projectionStartYear", "=", 
   RowBox[{"prevalenceYears", "\[LeftDoubleBracket]", 
    RowBox[{"Length", "[", "prevalenceYears", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"projectionEndYear", "=", "2043"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"saveInitialData", "=", "True"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Do", " ", "we", " ", "want", " ", "the", " ", "initial", " ", 
    "conditions", " ", "for", " ", "the", " ", "projections", " ", "to", " ", 
    "be", " ", "saved", " ", "to", " ", "the", " ", "output", " ", 
    RowBox[{"directory", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Setting", " ", "the", " ", "interpolation", " ", "order", " ", "to", " ",
      "unity"}], ",", " ", 
    RowBox[{
    "so", " ", "that", " ", "all", " ", "data", " ", "are", " ", "treated", 
     " ", "the", " ", "same", " ", 
     RowBox[{"way", "."}]}]}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Linear", " ", "interpolation", " ", "should", " ", "also", " ", "enable", 
    " ", "slightly", " ", "faster", " ", "calculation", " ", "than", " ", 
    "the", " ", "quadratic", " ", "or", " ", "cubic", " ", 
    RowBox[{"forms", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidenceInterpolationOrder", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevalenceInterpolationOrder", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populationInterpolationOrder", "=", "1"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Note", " ", "that", " ", "UNIX"}], "-", 
     RowBox[{"style", " ", "directory", " ", "separators", " ", "are", " ", 
      RowBox[{"used", ".", " ", "For"}], " ", "Windows"}]}], ",", " ", 
    RowBox[{
    "the", " ", "direction", " ", "of", " ", "the", " ", "slashes", " ", 
     "may", " ", "need", " ", "to", " ", "be", " ", "changed", " ", "here", 
     " ", "and", " ", "in", " ", "all", " ", "save", " ", "locations"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rootInputDir", "=", 
   RowBox[{"\"\</input/path/here/\>\"", "<>", 
    RowBox[{"ToLowerCase", "[", "country", "]"}], "<>", "\"\</\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rootOutputDir", "=", 
   RowBox[{"\"\</output/path/here/\>\"", "<>", 
    RowBox[{"ToLowerCase", "[", "country", "]"}], "<>", "\"\</\>\""}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.887274013618046*^9, 3.8872740437894917`*^9}, {
   3.887274110351287*^9, 3.887274116597949*^9}, 3.887274265625057*^9, {
   3.887274794068503*^9, 3.8872748046215076`*^9}, {3.887274868198619*^9, 
   3.8872748824692783`*^9}, {3.8872749684738817`*^9, 
   3.8872750910156593`*^9}, {3.887275124675712*^9, 3.887275222482678*^9}, {
   3.887275728696499*^9, 3.887275729661734*^9}, {3.887275838360319*^9, 
   3.887275874097557*^9}, {3.887275928887092*^9, 3.8872759321631536`*^9}, {
   3.887276620791361*^9, 3.887276620930448*^9}, {3.887276737473675*^9, 
   3.887276755306282*^9}, {3.8872775821718683`*^9, 3.887277650795376*^9}, {
   3.887278296626615*^9, 3.887278312541718*^9}, {3.887282801311262*^9, 
   3.887282807579348*^9}, {3.887313283495432*^9, 3.887313284112306*^9}, 
   3.887367173081028*^9, {3.889602191642549*^9, 3.889602286591878*^9}, 
   3.8896024310636044`*^9, {3.889602792011529*^9, 3.889602794193136*^9}, {
   3.889603319928809*^9, 3.889603332970317*^9}, {3.889603720357066*^9, 
   3.88960372604423*^9}, {3.889603767830839*^9, 3.889603791638772*^9}, {
   3.889610949309284*^9, 3.8896109851219187`*^9}, {3.9019827132400417`*^9, 
   3.9019827133587627`*^9}, {3.901982840995092*^9, 3.901982872933915*^9}, 
   3.901982965891464*^9, {3.9019831047180357`*^9, 3.901983105909374*^9}, {
   3.9019831511122828`*^9, 3.901983151360147*^9}, {3.9019834501633577`*^9, 
   3.901983452633739*^9}, {3.902220799362759*^9, 3.902220800723686*^9}, {
   3.902227448216387*^9, 3.9022274590616302`*^9}, 3.902497509135501*^9, {
   3.902497539337688*^9, 3.902497541462837*^9}, 3.902499607928681*^9, 
   3.902499852521173*^9, 3.9026615981666594`*^9, {3.902667974922915*^9, 
   3.902667975957159*^9}, {3.902674825444785*^9, 3.902674835661076*^9}, 
   3.9026797664052753`*^9, 3.902699947392061*^9, 3.90273284431246*^9, 
   3.902787369155264*^9, 3.9028432575245943`*^9, {3.902863659497026*^9, 
   3.902863659543386*^9}, 3.903176364841144*^9, 3.903176407071659*^9, 
   3.903183645907013*^9, 3.903197076698737*^9, 3.90319820155422*^9, 
   3.9033584897947598`*^9, 3.903361066916642*^9, 3.903710921677743*^9, 
   3.9042276150956793`*^9, {3.904813673755295*^9, 3.904813687549889*^9}, 
   3.904818791676242*^9, 3.9053517199718037`*^9, 3.907419284245491*^9, {
   3.9074196078236723`*^9, 3.9074196260800533`*^9}, {3.9074272324259233`*^9, 
   3.907427235708714*^9}, {3.907520570485735*^9, 3.907520570639279*^9}, {
   3.9076797957180233`*^9, 3.907679818871559*^9}, 3.907680035398329*^9, {
   3.908623363979265*^9, 3.908623367856495*^9}, 3.9088830631544657`*^9, {
   3.9088834044137*^9, 3.908883408369451*^9}, 3.9088900060084963`*^9, 
   3.908974541860271*^9, 3.908976059750094*^9, 3.908991101076824*^9, 
   3.90899217733773*^9, {3.909056127521443*^9, 3.909056140991164*^9}, {
   3.909056180676239*^9, 3.909056181220777*^9}, 3.909056283419304*^9, {
   3.909057400397744*^9, 3.909057402645629*^9}, {3.9090651622394743`*^9, 
   3.9090651817733994`*^9}, 3.9090652868460083`*^9, {3.909065485097513*^9, 
   3.909065496130143*^9}, {3.909065530532422*^9, 3.909065530644511*^9}, 
   3.909065591717355*^9, 3.909065830302094*^9, {3.909066082743554*^9, 
   3.909066091000918*^9}, {3.909066316765196*^9, 3.909066354935576*^9}, 
   3.909067692979465*^9, {3.909218013488242*^9, 3.909218059359317*^9}, 
   3.90921810804007*^9, {3.909218143637669*^9, 3.909218144290227*^9}, 
   3.909219652734809*^9, 3.909224485875956*^9, 3.90922859511157*^9, 
   3.909228658616337*^9, {3.90922869892449*^9, 3.909228702364904*^9}, 
   3.909482772449663*^9, 3.909483043083147*^9, 3.909483195398609*^9, 
   3.909483351570369*^9, {3.913893059830524*^9, 3.9138930978416443`*^9}, 
   3.913897485906993*^9, 3.913911514459897*^9, {3.913974615090405*^9, 
   3.913974639160348*^9}, {3.9139780996970863`*^9, 3.91397811231669*^9}, {
   3.9139893292743263`*^9, 3.913989347915597*^9}, {3.9139894073152523`*^9, 
   3.913989413276758*^9}, {3.913989464645995*^9, 3.913989464883808*^9}, {
   3.913990127850395*^9, 3.9139901552598333`*^9}, {3.913991820587178*^9, 
   3.913991911135557*^9}, {3.917005982802311*^9, 3.9170059951505957`*^9}, 
   3.9170141495515003`*^9, {3.9172799940507917`*^9, 3.9172799960278597`*^9}, 
   3.9172800434612303`*^9, {3.917282062907999*^9, 3.917282069668284*^9}, {
   3.920379753191259*^9, 3.920379754242251*^9}, 3.920380463333696*^9, 
   3.920380620606286*^9, {3.9203819754726353`*^9, 3.920381977163823*^9}, {
   3.9204485478012857`*^9, 3.920448561459222*^9}, {3.9204485939946947`*^9, 
   3.92044859986537*^9}, 3.920448704203348*^9, {3.92044907430884*^9, 
   3.9204491545147867`*^9}, {3.920449549838997*^9, 3.9204495859763737`*^9}, {
   3.920449624136208*^9, 3.9204496291503*^9}, 3.920543987871867*^9, {
   3.92054447404436*^9, 3.9205444798247004`*^9}, 3.920544842358665*^9, 
   3.9205482398805447`*^9, 3.920549590730083*^9, {3.920633433494679*^9, 
   3.92063346555695*^9}, {3.920633848764202*^9, 3.920633862675119*^9}, {
   3.920716974081781*^9, 3.920716976047391*^9}, {3.920717236697798*^9, 
   3.92071723784584*^9}, 3.920717585005537*^9, {3.92073897232067*^9, 
   3.920738975204178*^9}, {3.920797040322639*^9, 3.920797040545701*^9}, 
   3.920799917940547*^9, 3.920801703126184*^9, 3.9208036724806967`*^9, {
   3.920803986404593*^9, 3.920803993259449*^9}, {3.920804127920081*^9, 
   3.9208041295892*^9}, 3.920805339117996*^9, 3.920805414896448*^9, 
   3.9208268662712917`*^9, 3.9208819768435993`*^9, 3.920885298610972*^9, {
   3.920887844722266*^9, 3.920887847825158*^9}, 3.920890227594612*^9, {
   3.92089126419499*^9, 3.920891298504013*^9}, 3.920896464506584*^9, {
   3.920922433562592*^9, 3.9209224429215803`*^9}, 3.92092648249492*^9, {
   3.920967300454241*^9, 3.9209673155019073`*^9}, 3.9209817923153143`*^9, 
   3.921003266338797*^9, 3.921004935578973*^9, 3.921053604876544*^9, 
   3.921055185276166*^9, 3.921055942264111*^9, 3.9210628345863934`*^9, {
   3.9210794329316998`*^9, 3.921079433949028*^9}, {3.921080063556224*^9, 
   3.921080075313538*^9}, {3.921080112886951*^9, 3.921080164434453*^9}, {
   3.921080272676387*^9, 3.921080293830245*^9}, {3.921081038434271*^9, 
   3.921081038753039*^9}, 3.921144979299024*^9, {3.921145207854115*^9, 
   3.921145219419858*^9}, 3.921145451376253*^9, {3.921145563899654*^9, 
   3.92114558789333*^9}, 3.921145786040916*^9, 3.921145915283595*^9, 
   3.921156617957439*^9, {3.92115742698035*^9, 3.9211574280386333`*^9}, 
   3.921157526313136*^9, 3.9211576659316874`*^9, 3.921157765061912*^9, 
   3.921157873177253*^9, 3.921158053334708*^9, 3.9213190094018497`*^9, {
   3.923066389069909*^9, 3.923066392845254*^9}, 3.923066637713044*^9, 
   3.923066945187883*^9, {3.9230687739212837`*^9, 3.923068774967617*^9}, 
   3.923129683196229*^9, 3.9231376672908897`*^9, 3.923663823223106*^9, 
   3.923671405102042*^9, {3.923674536509143*^9, 3.9236745388454733`*^9}, 
   3.923676355265319*^9, 3.9236818394475718`*^9, 3.923683398533682*^9, 
   3.9236837674391127`*^9, {3.9282487792909193`*^9, 3.9282487859717073`*^9}, {
   3.928248944724783*^9, 3.928248961398275*^9}, {3.9282490565859737`*^9, 
   3.928249086079775*^9}, 3.928249364850212*^9, {3.928249633261058*^9, 
   3.928249662400223*^9}, {3.928249706993354*^9, 3.928249731607359*^9}, {
   3.928249866194686*^9, 3.9282498988503227`*^9}, {3.9282499708582172`*^9, 
   3.9282501940757*^9}, {3.928250303700951*^9, 3.928250308494972*^9}, {
   3.928250782690422*^9, 3.9282508191454372`*^9}, {3.928250923821411*^9, 
   3.928251123180847*^9}, {3.928253663245098*^9, 3.928253710435975*^9}, {
   3.928253768755084*^9, 3.928253818605082*^9}, {3.928253861307692*^9, 
   3.928253862143219*^9}, {3.928253957253034*^9, 3.9282539608480186`*^9}, {
   3.928254070277822*^9, 3.928254082913973*^9}, {3.929199204846814*^9, 
   3.929199206860611*^9}, {3.9292000867602654`*^9, 3.929200086812436*^9}, {
   3.929200206759384*^9, 3.929200206801194*^9}, {3.929200520166877*^9, 
   3.929200523346169*^9}, {3.9294314987068377`*^9, 3.9294315107839203`*^9}, {
   3.92943212144623*^9, 3.9294321215236673`*^9}, {3.9294329939143667`*^9, 
   3.929432993978372*^9}, 3.9294334711176558`*^9, {3.9294344660548487`*^9, 
   3.929434466260641*^9}, {3.929436433307933*^9, 3.9294364333548527`*^9}, {
   3.929439486478386*^9, 3.9294394869640837`*^9}, 3.9294408828391733`*^9, {
   3.9294421669481773`*^9, 3.92944216707479*^9}, {3.929444135319539*^9, 
   3.929444135506545*^9}, {3.929625875363227*^9, 3.92962588284127*^9}, {
   3.9296262103094788`*^9, 3.929626210416986*^9}, {3.9296264527018967`*^9, 
   3.929626452800645*^9}, {3.929626500755487*^9, 3.929626503321618*^9}, 
   3.9297831294165983`*^9, {3.9297832882333813`*^9, 3.929783288367763*^9}, {
   3.929783327133568*^9, 3.929783327274623*^9}, 3.9297833821051083`*^9, {
   3.929783434950177*^9, 3.9297834350283422`*^9}, {3.929783469337669*^9, 
   3.929783469831526*^9}, {3.9297835102630453`*^9, 3.929783514525182*^9}, {
   3.9297835590287437`*^9, 3.929783559100916*^9}, {3.9297835921324577`*^9, 
   3.929783592202291*^9}, {3.929783622346361*^9, 3.929783622481226*^9}, {
   3.9298023873355303`*^9, 3.929802387412957*^9}, 3.929805381938691*^9, 
   3.9298078927459106`*^9, {3.9298079363212233`*^9, 3.9298079368138638`*^9}, {
   3.938777166438918*^9, 
   3.938777184310601*^9}},ExpressionUUID->"82f4fafa-4f2f-4091-a9ad-\
cbd08216daa1"],

Cell["\<\
The population sub-type can only depend on sex (the population data includes \
all people, not just those with IBD), and we can derive it from the subType \
variable.\
\>", "Text",
 CellChangeTimes->{{3.928253864198209*^9, 3.928253903766958*^9}, {
  3.938777198144618*^9, 
  3.938777227436048*^9}},ExpressionUUID->"d8de29b1-3f47-40fe-8538-\
f82f205b9ac0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subType", "=", 
   RowBox[{"ToLowerCase", "[", "subType", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"subType", "==", "\"\<uc\>\""}], "||", 
     RowBox[{"subType", "==", "\"\<cd\>\""}], "||", 
     RowBox[{"subType", "==", "\"\<ibdu\>\""}], "||", 
     RowBox[{"subType", "==", "\"\<total\>\""}]}], ",", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"popSubType", "=", "\"\<total\>\""}], ";"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"subTypePieces", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{"subType", ",", "\"\<-\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"popSubType", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "2"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "subTypePieces", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"popSubType", "=", 
            RowBox[{
            "subTypePieces", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"popSubType", "=", 
            RowBox[{"popSubType", "<>", "\"\<-\>\"", "<>", 
             RowBox[{
             "subTypePieces", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9282539090080633`*^9, 3.928253944742846*^9}, {
  3.928253987266724*^9, 3.9282540519207067`*^9}, {3.928254089874867*^9, 
  3.9282541095205097`*^9}, {3.9282542091863728`*^9, 3.9282542207129593`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"494ba29f-5b85-4fe9-8963-163ce1c6a0ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial conditions", "Subsection",
 CellChangeTimes->{{3.887219345736392*^9, 
  3.887219358910851*^9}},ExpressionUUID->"50b9eff3-6281-41eb-8969-\
730523eebc02"],

Cell["\<\
Load the age-dependent initial prevalence. Note that the file name must \
contain the data year.\
\>", "Text",
 CellChangeTimes->{{3.887274587506654*^9, 3.887274610039545*^9}, {
  3.8872746465806847`*^9, 3.887274653928049*^9}, {3.9138929170409727`*^9, 
  3.913892920111451*^9}},ExpressionUUID->"b4eda8b7-6282-4405-83eb-\
54bfe8c31a9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prevalences", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "prevalenceYears", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"prevalencePath", "=", 
      RowBox[{
      "rootInputDir", "<>", "\"\<prevalence/\>\"", "<>", "subType", "<>", 
       "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
        "prevalenceYears", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "]"}], "<>", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prevalence", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"prevalencePath", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prevalence", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
        "prevalence", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "prevalence", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"prevalences", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"prevalences", ",", "prevalence"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Prevalence: \>\"", "<>", "prevalencePath", "<>", " ", 
       "\"\< loaded\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<   Length = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "prevalence", "]"}], "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.887219360243113*^9, 3.8872193609821043`*^9}, {
   3.887273276377097*^9, 3.88727330511305*^9}, {3.887273403312993*^9, 
   3.8872734290373077`*^9}, {3.887273960002459*^9, 3.887273993008541*^9}, {
   3.887274121041438*^9, 3.8872742232155943`*^9}, {3.887274263654601*^9, 
   3.8872742645224123`*^9}, {3.8872744604753733`*^9, 3.887274486743832*^9}, {
   3.8872747808291473`*^9, 3.887274785401516*^9}, {3.8872754572314253`*^9, 
   3.8872754705311832`*^9}, 3.887276389389565*^9, {3.8872764300840597`*^9, 
   3.887276476080558*^9}, {3.887276775819954*^9, 3.88727678591521*^9}, {
   3.887282836453885*^9, 3.887282898162984*^9}, {3.887283135189196*^9, 
   3.887283206548222*^9}, {3.887284032649933*^9, 3.887284036142535*^9}, {
   3.887448323350209*^9, 3.887448324115258*^9}, {3.889603351967317*^9, 
   3.889603433976881*^9}, {3.889603559884676*^9, 3.889603569961803*^9}, 
   3.889603609400639*^9, {3.889603732406067*^9, 3.889603752205344*^9}, 
   3.889603802596806*^9, {3.889610774300974*^9, 3.8896107799063997`*^9}, {
   3.8896108203071117`*^9, 3.8896108205469217`*^9}, {3.889610903194811*^9, 
   3.889610906750126*^9}, {3.8901341355935287`*^9, 3.890134144679921*^9}, {
   3.8901341846463213`*^9, 3.89013430551175*^9}, {3.890143375478508*^9, 
   3.890143376252678*^9}, {3.891687503012898*^9, 3.89168750377166*^9}, {
   3.901982924064885*^9, 3.9019829291275997`*^9}, 3.90198310176412*^9, {
   3.913975430093933*^9, 3.9139754310725946`*^9}, 3.9139894196484613`*^9, 
   3.9203805803328876`*^9, {3.928249741663993*^9, 3.9282497639023447`*^9}, {
   3.928254198007494*^9, 3.928254199762895*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"bfc140f6-6b51-45eb-8d93-2f442c5a7070"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Incidences", "Subsection",
 CellChangeTimes->{{3.887219345736392*^9, 
  3.8872193752925863`*^9}},ExpressionUUID->"b58a7232-80ea-48f0-9ea0-\
cbb99490d807"],

Cell[TextData[{
 "Load the age-dependent incidence data.\n\n",
 StyleBox["Note",
  FontWeight->"Bold"],
 ". These data are currently averaged to create a single, averaged incidence \
rate for the following calculations."
}], "Text",
 CellChangeTimes->{{3.887274617319086*^9, 3.88727470316531*^9}, {
  3.887276562051793*^9, 3.887276594589459*^9}, {3.890043330865576*^9, 
  3.8900434185493317`*^9}, {3.91389288312097*^9, 3.913892899185462*^9}, {
  3.913893169546054*^9, 
  3.9138931936601963`*^9}},ExpressionUUID->"3f922bad-4440-4dc2-9cde-\
e07e33730685"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"incidences", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "incidenceYears", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"incidencePath", "=", 
      RowBox[{
      "rootInputDir", "<>", "\"\<incidence/\>\"", "<>", "subType", "<>", 
       "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
        "incidenceYears", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "]"}], "<>", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"incidence", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"incidencePath", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"incidence", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
        "incidence", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "incidence", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"incidences", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"incidences", ",", "incidence"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Incidence: \>\"", "<>", "incidencePath", "<>", " ", 
       "\"\< loaded\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<   Length = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "incidence", "]"}], "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.887219360243113*^9, 3.8872193609821043`*^9}, {
   3.887274233157563*^9, 3.887274372094933*^9}, {3.887274426286211*^9, 
   3.887274448999161*^9}, {3.8872744932675123`*^9, 3.887274535224073*^9}, {
   3.887275482139018*^9, 3.8872754904668837`*^9}, {3.8872764085277557`*^9, 
   3.887276420124861*^9}, {3.88727645395684*^9, 3.887276468417444*^9}, {
   3.88727682459406*^9, 3.887276830921815*^9}, {3.887282927757986*^9, 
   3.887282938643178*^9}, 3.887283099416813*^9, {3.88728321345465*^9, 
   3.887283239923498*^9}, {3.887283282141158*^9, 3.887283302769052*^9}, {
   3.887283402088677*^9, 3.887283405743444*^9}, {3.8896112796376333`*^9, 
   3.8896113178042507`*^9}, {3.889611353815877*^9, 3.889611380036048*^9}, {
   3.889611425970376*^9, 3.889611437184133*^9}, {3.89177467986207*^9, 
   3.891774682259631*^9}, 3.89177471694802*^9, 3.913989423385769*^9, {
   3.9210678236096983`*^9, 3.921067824463649*^9}, 3.9282497784547997`*^9, {
   3.928254191800414*^9, 3.9282541936481953`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1e3e5f02-afe2-41f2-afdc-d6f221602c77"],

Cell[TextData[{
 "Now, calculate the mean incidence, and the 95 % upper and lower confidence \
bounds. The bounds are determined from the ",
 StyleBox["t",
  FontSlant->"Italic"],
 "-score for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{"DOF", "-", "1"}]}], TraditionalForm]],ExpressionUUID->
  "c14a7450-ad3f-4e94-b7ae-4a4ae5dd4898"],
 " degrees of freedom \[LineSeparator]and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "=", "0.95"}], TraditionalForm]],ExpressionUUID->
  "1cb16d4d-408b-411e-beb3-650ede0c729c"],
 " (i.e., a two-tailed 95% CI), as we may have small numbers of incidence \
data sets that we are averaging (for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"DOF", ">", "25"}], TraditionalForm]],ExpressionUUID->
  "4edf5829-c5d5-435f-89b3-462ca3a7702c"],
 " this converges to the normal distribution CIs)."
}], "Text",
 CellChangeTimes->{{3.889613240138949*^9, 3.889613269961887*^9}, {
   3.8900448675536737`*^9, 3.890044872233333*^9}, {3.891774614308858*^9, 
   3.8917746711023817`*^9}, {3.907759909440481*^9, 3.90775990968458*^9}, {
   3.908627106604985*^9, 3.908627180338725*^9}, 3.9138932073781433`*^9, {
   3.913896195279201*^9, 3.913896243666706*^9}, {3.913896350319461*^9, 
   3.9138963913817596`*^9}, 3.920897487424876*^9, {3.938777268388163*^9, 
   3.938777288770979*^9}},ExpressionUUID->"2588b0dc-243e-47cd-a0a8-\
d928233055a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aveIncidence", "=", 
   RowBox[{"Mean", "[", "incidences", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dof", "=", 
    RowBox[{
     RowBox[{"Length", "[", "incidences", "]"}], "-", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"dof", ">", "0"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Alpha]", "=", "0.95"}], ";", 
     RowBox[{"xo", "=", "5"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T", "[", "x_", "]"}], "=", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"PDF", "[", 
         RowBox[{
          RowBox[{"StudentTDistribution", "[", "dof", "]"}], ",", " ", "x"}], 
         "]"}], ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tScore", "=", 
      RowBox[{"x", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          FractionBox["\[Alpha]", "2"], "==", 
          RowBox[{"T", "[", "x", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xo"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"transposeIncidences", "=", 
      RowBox[{"Transpose", "[", "incidences", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdIncidence", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "transposeIncidences", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          FractionBox[
           RowBox[{"tScore", "\[Times]", 
            RowBox[{
             RowBox[{"StandardDeviation", "[", 
              RowBox[{
              "transposeIncidences", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], 
           SqrtBox[
            RowBox[{"Length", "[", "incidences", "]"}]]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "transposeIncidences", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lowerIncidence", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "aveIncidence", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"aveIncidence", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
            RowBox[{
            "stdIncidence", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "aveIncidence", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"upperIncidence", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
           "aveIncidence", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"aveIncidence", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{
            RowBox[{
            "stdIncidence", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "aveIncidence", "]"}]}], "}"}]}], "]"}]}], 
     ";"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "If", " ", "there", " ", "is", " ", "only", " ", "one", " ", 
       "incidence", " ", "data", " ", "set"}], ",", " ", 
      RowBox[{
      "there", " ", "are", " ", "no", " ", "confidence", " ", "bounds"}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lowerIncidence", "=", "aveIncidence"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upperIncidence", "=", "aveIncidence"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.889611439328459*^9, 3.88961145438093*^9}, {
   3.889611487773158*^9, 3.889611826786459*^9}, {3.889611858148465*^9, 
   3.8896119057342043`*^9}, {3.8896119554951477`*^9, 3.889611973256494*^9}, 
   3.889612033152109*^9, {3.889612154770788*^9, 3.889612233208373*^9}, {
   3.889612305269556*^9, 3.889612398098713*^9}, {3.889612434512944*^9, 
   3.889612554555236*^9}, {3.889612629727673*^9, 3.889612808100885*^9}, {
   3.8900448757717543`*^9, 3.89004488323328*^9}, {3.891766226573935*^9, 
   3.891766275901071*^9}, {3.891766466709002*^9, 3.891766467688002*^9}, {
   3.891766525872788*^9, 3.8917665493073893`*^9}, {3.9031836613273287`*^9, 
   3.903183662341436*^9}, {3.9031970868770323`*^9, 3.903197087743579*^9}, {
   3.907757879682233*^9, 3.907757905440205*^9}, {3.907758047497048*^9, 
   3.907758058081006*^9}, {3.907758151048349*^9, 3.907758222360724*^9}, {
   3.907758275551345*^9, 3.907758293109201*^9}, {3.9077596724318857`*^9, 
   3.90775987401198*^9}, {3.907759962821383*^9, 3.907759982549666*^9}, {
   3.907760052716763*^9, 3.9077600756538763`*^9}, {3.907760117547538*^9, 
   3.907760148387165*^9}, {3.908285180667951*^9, 3.908285186045104*^9}, {
   3.9086271659421673`*^9, 3.908627183711876*^9}, 3.913896203285734*^9, {
   3.913896249485404*^9, 3.913896342340323*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"eb4cafcb-5fdf-4c75-91ec-16376a08aa09"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Population age-structures", "Subsection",
 CellChangeTimes->{{3.887219345736392*^9, 
  3.887219385717169*^9}},ExpressionUUID->"556f98b9-67ea-47b3-8b22-\
510e694ba59e"],

Cell["\<\
Loading the age-dependent population structure data. Note that if there is \
population age-structure data across multiple years, each can be loaded here. \
Each file path must be named by the year of the population data set.\
\>", "Text",
 CellChangeTimes->{{3.887276536978948*^9, 3.887276600649951*^9}, {
  3.887276803885302*^9, 
  3.887276815381398*^9}},ExpressionUUID->"89b7075d-a9ea-4d9c-b5da-\
e4412bd27f61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"populations", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "populationYears", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"populationPath", "=", 
      RowBox[{
      "rootInputDir", "<>", "\"\<population/\>\"", "<>", "popSubType", "<>", 
       "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
        "populationYears", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "]"}], "<>", "\"\<.csv\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"population", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"populationPath", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"population", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
        "population", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2", ",", 
          RowBox[{"Length", "[", "population", "]"}]}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"populations", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"populations", ",", "population"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Population: \>\"", "<>", "populationPath", "<>", " ", 
       "\"\< loaded\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<   Length = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "population", "]"}], "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.887219360243113*^9, 3.8872193609821043`*^9}, 
   3.8872745459537373`*^9, {3.88727472220506*^9, 3.887274755175342*^9}, 
   3.887275495247362*^9, {3.8872764830811462`*^9, 3.88727651929204*^9}, {
   3.887276822617558*^9, 3.887276837074575*^9}, {3.887282946369032*^9, 
   3.8872829533543997`*^9}, {3.8872830716088333`*^9, 3.887283097717045*^9}, {
   3.887283242963402*^9, 3.887283262791504*^9}, {3.8872833073136177`*^9, 
   3.887283308633436*^9}, {3.8872834093183804`*^9, 3.887283411604768*^9}, {
   3.887283598018445*^9, 3.8872836081068277`*^9}, {3.9031836646647177`*^9, 
   3.903183665414885*^9}, {3.905349104998761*^9, 3.905349106350767*^9}, 
   3.9139894300325117`*^9, 3.9172654507811623`*^9, {3.920805349809081*^9, 
   3.9208053508242493`*^9}, 3.9282497889376917`*^9, 3.928249828351698*^9, {
   3.928253730311035*^9, 3.928253742267763*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"5060bf67-bb44-477e-9415-125a92f223aa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolations & Plotting", "Section",
 CellChangeTimes->{{3.8872192195265017`*^9, 3.8872192204394073`*^9}, {
  3.887219325881373*^9, 3.887219330876498*^9}, {3.887219430358536*^9, 
  3.887219437062042*^9}},ExpressionUUID->"cb747d5d-f73e-494a-b9ff-\
d29dba124eaf"],

Cell[CellGroupData[{

Cell["Initial prevalence", "Subsection",
 CellChangeTimes->{{3.887219345736392*^9, 3.887219358910851*^9}, {
  3.887284323410316*^9, 
  3.8872843280435963`*^9}},ExpressionUUID->"060a3a68-aec7-4db5-97e9-\
778c46e1bee0"],

Cell["\<\
Create an interpolating polynomial of the initial prevalence and plotting \
this interpolation for three different points in time. Since we have turned \
discrete data into continuous data, we need an upper bound for the \
interpolation, set to the value of the highest age in the given data set.\
\>", "Text",
 CellChangeTimes->{{3.887282965070787*^9, 3.887282994957725*^9}, {
  3.887283035893827*^9, 3.887283052104137*^9}, {3.88728429256264*^9, 
  3.887284296884962*^9}, {3.887284368990685*^9, 3.887284369409996*^9}, {
  3.913896424859973*^9, 
  3.913896546327568*^9}},ExpressionUUID->"101066de-ed45-4bda-8c4c-\
03bd16057d70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prevalenceAgeMaxes", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevalenceInterps", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", 
      RowBox[{"Length", "[", "prevalences", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"prevalenceAgeMax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "prevalences", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "j", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "prevalences", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"prevalenceAgeMaxes", ",", "prevalenceAgeMax"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interp", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{
         RowBox[{"prevalences", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
         "InterpolationOrder", "->", "prevalenceInterpolationOrder"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prevalenceInterp", "[", "a_", "]"}], ":=", 
       RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"a", "<", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"interp", "[", "a", "]"}], ",", 
            RowBox[{"0", "<=", "a", "<=", "prevalenceAgeMax"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"a", ">", "prevalenceAgeMax"}]}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"prevalenceInterps", ",", 
        RowBox[{"prevalenceInterp", "[", "a", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prevalenceAgeMax", "=", 
    RowBox[{"Max", "[", "prevalenceAgeMaxes", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"prevIndexes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "prevalenceInterps", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prevalencesToPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"prevalenceInterps", "\[LeftDoubleBracket]", 
        RowBox[{
        "prevIndexes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
         "\[RightDoubleBracket]"}], "\[Times]", "100"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "prevIndexes", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{"prevalencesToPlot", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "prevalenceAgeMax"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], "}"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"LabelStyle", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontSize", "->", "18"}], ",", 
      RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], "}"}]}], 
   ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.887283057579887*^9, 3.887283058820381*^9}, {
   3.8872831030812473`*^9, 3.887283109254694*^9}, {3.8872834191556*^9, 
   3.8872834326472387`*^9}, {3.887283616387024*^9, 3.887283734105216*^9}, {
   3.887283770357841*^9, 3.887283801168603*^9}, {3.88728390135*^9, 
   3.887283916646825*^9}, {3.8872839509416924`*^9, 3.8872839717029943`*^9}, {
   3.8872840627636747`*^9, 3.887284092849635*^9}, 3.8872841712813063`*^9, {
   3.887284218835792*^9, 3.887284307977002*^9}, {3.8872843779576683`*^9, 
   3.8872846232010393`*^9}, {3.887284672593461*^9, 3.8872846824632893`*^9}, {
   3.8872847679735117`*^9, 3.887284842304677*^9}, {3.8872853341979237`*^9, 
   3.8872854236724863`*^9}, {3.887285486002966*^9, 3.887285500249741*^9}, {
   3.887285554259871*^9, 3.8872855601002483`*^9}, {3.8873591985474977`*^9, 
   3.887359211263669*^9}, {3.887378065470436*^9, 3.887378078478878*^9}, {
   3.887378531462685*^9, 3.8873785422139177`*^9}, 3.887456701773633*^9, 
   3.8874571609991217`*^9, {3.889603462935212*^9, 3.889603489166086*^9}, {
   3.8896036268233013`*^9, 3.8896036864257174`*^9}, {3.889603827974759*^9, 
   3.889603847482671*^9}, 3.889604242153599*^9, 3.889888099474537*^9, {
   3.890134318427842*^9, 3.890134376661268*^9}, {3.89014331387011*^9, 
   3.890143334726248*^9}, 3.8901433974748383`*^9, {3.89014343776637*^9, 
   3.89014364267352*^9}, {3.890144569445627*^9, 3.890144575925887*^9}, {
   3.890146343102412*^9, 3.890146355527952*^9}, {3.891687545158971*^9, 
   3.891687559850835*^9}, {3.891695656534511*^9, 3.891695683988809*^9}, {
   3.8916960116141233`*^9, 3.8916962360802937`*^9}, {3.89169633964986*^9, 
   3.891696369445188*^9}, {3.891696487391868*^9, 3.891696776947397*^9}, {
   3.891696810189992*^9, 3.891696905373066*^9}, {3.8916969681851254`*^9, 
   3.891697122692061*^9}, {3.89169716040441*^9, 3.8916971869575567`*^9}, {
   3.8916972610336647`*^9, 3.8916972678786783`*^9}, {3.891697435401263*^9, 
   3.891697435465353*^9}, {3.891697548286957*^9, 3.891697713575262*^9}, {
   3.891697815944119*^9, 3.891698342495474*^9}, {3.891698403750286*^9, 
   3.8916985257794724`*^9}, {3.891698590089945*^9, 3.8916986348951807`*^9}, {
   3.891698716501256*^9, 3.891698729397881*^9}, {3.8916988560939493`*^9, 
   3.891699000806459*^9}, {3.891699050062175*^9, 3.891699053501596*^9}, {
   3.891699130487323*^9, 3.89169916473177*^9}, {3.891706192498475*^9, 
   3.8917061950693903`*^9}, {3.891772330742506*^9, 3.891772367669262*^9}, {
   3.891872132737952*^9, 3.8918721525293217`*^9}, {3.901983134939361*^9, 
   3.901983135251219*^9}, {3.90198334287247*^9, 3.9019833458510647`*^9}, {
   3.9019834914265413`*^9, 3.901983513410232*^9}, 3.902499692144162*^9, {
   3.9025000330635233`*^9, 3.902500056890416*^9}, {3.902500100603641*^9, 
   3.902500100841034*^9}, {3.902500539169353*^9, 3.9025005643488073`*^9}, {
   3.902500649854445*^9, 3.902500653697241*^9}, {3.902500850420068*^9, 
   3.9025008524212513`*^9}, {3.9025016530056963`*^9, 3.902501710282228*^9}, {
   3.902502076629037*^9, 3.902502128921352*^9}, {3.902843369378901*^9, 
   3.902843369449893*^9}, {3.9033585149609537`*^9, 3.903358533927023*^9}, 
   3.904819960204321*^9, 3.904820014000012*^9, {3.904893618889011*^9, 
   3.904893647414894*^9}, {3.908627219033931*^9, 3.9086272716700583`*^9}, {
   3.908632906724042*^9, 3.908632969810549*^9}, {3.908876484969666*^9, 
   3.90887660436826*^9}, {3.908876680692088*^9, 3.908876776925696*^9}, {
   3.908881504422175*^9, 3.9088815166234818`*^9}, {3.908974562458076*^9, 
   3.908974578169364*^9}, {3.9089771929012403`*^9, 3.908977217719645*^9}, {
   3.908977267433339*^9, 3.9089772674817677`*^9}, {3.9089888150717497`*^9, 
   3.908988815233473*^9}, {3.908988961015781*^9, 3.908988964442165*^9}, {
   3.9089911179947453`*^9, 3.908991147464274*^9}, {3.908991394209293*^9, 
   3.9089914065847473`*^9}, 3.90899190773409*^9, 3.908992210108343*^9, {
   3.909056315884852*^9, 3.909056361582385*^9}, {3.909056432133709*^9, 
   3.909056433311248*^9}, {3.9090652305510073`*^9, 3.909065232548717*^9}, 
   3.909218131318265*^9, {3.90921968471627*^9, 3.9092196852416697`*^9}, 
   3.909224523825007*^9, {3.913896533216654*^9, 3.913896743212983*^9}, {
   3.913896788795721*^9, 3.9138968122917128`*^9}, {3.913896871779565*^9, 
   3.913897089617577*^9}, {3.91389727854751*^9, 3.9138973070217237`*^9}, {
   3.9138983785086317`*^9, 3.913898384560937*^9}, {3.913898849340845*^9, 
   3.913898887310967*^9}, {3.9138993206919413`*^9, 3.913899321896666*^9}, {
   3.913974523089963*^9, 3.91397452342413*^9}, 3.913991952389072*^9, 
   3.917006104588249*^9, {3.917265459643738*^9, 3.917265553388176*^9}, 
   3.917265745720242*^9, 3.91727085669786*^9, {3.920381880774622*^9, 
   3.9203818963363247`*^9}, {3.920382254779026*^9, 3.9203822562735157`*^9}, {
   3.920448649328299*^9, 3.920448656340632*^9}, {3.920448806364105*^9, 
   3.920448850450803*^9}, 3.920541649274935*^9, {3.9205440438167973`*^9, 
   3.920544120197506*^9}, {3.920717615355336*^9, 3.920717789596833*^9}, {
   3.920717824895108*^9, 3.92071804766676*^9}, 3.920718153987831*^9, {
   3.9207181887039843`*^9, 3.920718455288562*^9}, {3.920718762852479*^9, 
   3.920718812845056*^9}, {3.920719029275277*^9, 3.920719031202352*^9}, {
   3.9207223808313437`*^9, 3.920722484629325*^9}, {3.920739015955021*^9, 
   3.9207390257170897`*^9}, {3.920797860498611*^9, 3.920797913321108*^9}, 
   3.920798318469668*^9, {3.9207983726010027`*^9, 3.920798375454426*^9}, {
   3.920798464688699*^9, 3.9207984777892437`*^9}, 3.920801226352314*^9, {
   3.920801462101603*^9, 3.9208014682360973`*^9}, {3.9208821265253963`*^9, 
   3.92088215325546*^9}, {3.920882274643457*^9, 3.920882277735012*^9}, 
   3.920890250763606*^9, 3.9208964902344513`*^9, {3.9211392305424013`*^9, 
   3.921139259084725*^9}, {3.921156650682809*^9, 3.9211567225027237`*^9}, {
   3.921156789090469*^9, 3.9211568835607033`*^9}, {3.921157686778645*^9, 
   3.921157709887847*^9}, {3.92115778394728*^9, 3.921157797768045*^9}, {
   3.921157890748715*^9, 3.9211579093371553`*^9}, {3.923066477145176*^9, 
   3.923066549742185*^9}, {3.9230667540781727`*^9, 3.923066786608349*^9}, {
   3.923068798564644*^9, 3.923068805856812*^9}, {3.923129710215613*^9, 
   3.923129721061274*^9}, 3.923129753541727*^9, {3.923137691768078*^9, 
   3.92313770212251*^9}, 3.923663848311311*^9, {3.929783195675918*^9, 
   3.9297831981570673`*^9}, 3.9387773498420467`*^9, {3.938777395416595*^9, 
   3.93877744800343*^9}, {3.938777677098695*^9, 
   3.9387777142786694`*^9}},ExpressionUUID->"5b11d0d0-8689-477d-84e9-\
d04e97fc58dc"],

Cell["\<\
Save the prevalence age structure for the three curves above.\
\>", "Text",
 CellChangeTimes->{
  3.891713721280713*^9, {3.8917159428978767`*^9, 3.891715967851944*^9}, {
   3.902229079271006*^9, 3.9022290803489857`*^9}, {3.913896830557694*^9, 
   3.913896859899741*^9}},ExpressionUUID->"05f1a6a3-a053-4511-8754-\
6d09bfd8891f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"saveInitialData", "==", "True"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"popAges", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "prevalenceAgeMax"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"years", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"prevalenceYears", "\[LeftDoubleBracket]", 
         RowBox[{"prevIndexes", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "prevIndexes", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<Age [Years]\>\"", ",", "\"\<Prevalence [%]\>\""}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "years", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"filePath", "=", 
         RowBox[{
         "rootOutputDir", "<>", "\"\<initial_prevalences/\>\"", "<>", 
          "subType", "<>", "\"\</\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"years", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\<.csv\>\""}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "popAges", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"100", "\[Times]", 
               RowBox[{
               "prevalenceInterps", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "/.", 
              RowBox[{"a", "->", 
               RowBox[{
               "popAges", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "popAges", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{"data", ",", "header"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"filePath", "=", 
      RowBox[{
      "rootOutputDir", "<>", "\"\<initial_prevalences/\>\"", "<>", "subType", 
       "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "years", "]"}], "]"}], "<>", 
       "\"\<_examples.csv\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{
          "years", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "]"}], "<>", "\"\< Data Prevalence [%]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"header", ",", "\"\<Age [Years]\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "popAges", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"100", "\[Times]", 
               RowBox[{"prevalenceInterps", "\[LeftDoubleBracket]", 
                RowBox[{
                "prevIndexes", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], "/.", 
              RowBox[{"a", "->", 
               RowBox[{
               "popAges", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "years", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "popAges", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"data", ",", "header"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.891713601430751*^9, 3.891713618852212*^9}, {
   3.89171368117647*^9, 3.891713768263701*^9}, {3.891713818947914*^9, 
   3.8917139356253843`*^9}, {3.891714209498476*^9, 3.891714294702354*^9}, {
   3.8917143419814987`*^9, 3.891714515989423*^9}, {3.891714676947504*^9, 
   3.891714757353074*^9}, {3.8917147930204353`*^9, 3.891714844458756*^9}, {
   3.8917148906981897`*^9, 3.891714968361058*^9}, {3.891715088466803*^9, 
   3.891715097522706*^9}, {3.8917158164500217`*^9, 3.891715845632351*^9}, 
   3.891716001743334*^9, {3.891716061564986*^9, 3.8917161476506777`*^9}, {
   3.891716207196189*^9, 3.8917163874903183`*^9}, {3.891716673917235*^9, 
   3.891716698283546*^9}, {3.891716729142755*^9, 3.891716771615168*^9}, {
   3.891717281968384*^9, 3.891717309268437*^9}, {3.891717346926488*^9, 
   3.891717374830799*^9}, {3.891887478383637*^9, 3.8918874899944*^9}, {
   3.901962618054942*^9, 3.901962624642909*^9}, {3.901962659866063*^9, 
   3.9019626602820673`*^9}, {3.9019835502430162`*^9, 3.90198356174785*^9}, {
   3.902223758080257*^9, 3.902223891028561*^9}, 3.902223943264954*^9, 
   3.902224010155636*^9, {3.9022289493047113`*^9, 3.902229009522941*^9}, {
   3.902229051060115*^9, 3.902229051621689*^9}, {3.902229105307356*^9, 
   3.902229115207162*^9}, {3.902229235303364*^9, 3.902229255848563*^9}, {
   3.902500475162006*^9, 3.902500497975656*^9}, {3.902500577222323*^9, 
   3.902500586695429*^9}, {3.902500620403392*^9, 3.902500661392932*^9}, {
   3.902500798259362*^9, 3.9025008016349277`*^9}, 3.9025008924897842`*^9, {
   3.904813695965657*^9, 3.9048137168694344`*^9}, {3.908633011217856*^9, 
   3.908633027391531*^9}, {3.9086370404103937`*^9, 3.908637044992947*^9}, 
   3.908637114359449*^9, 3.9089911623861*^9, {3.9138971083251657`*^9, 
   3.9138971569603024`*^9}, {3.91389740437309*^9, 3.9138974119086857`*^9}, {
   3.913989382839926*^9, 3.913989390531824*^9}, {3.9139894559427233`*^9, 
   3.9139894562785063`*^9}, {3.913990674552614*^9, 3.913990707445463*^9}, {
   3.913990754065621*^9, 3.913990762570676*^9}, {3.913990826048382*^9, 
   3.91399086463345*^9}, {3.9139910684684*^9, 3.913991082146307*^9}, {
   3.913991239487214*^9, 3.9139912958679323`*^9}, {3.913991342079537*^9, 
   3.913991395790667*^9}, {3.92825416599298*^9, 3.928254180968934*^9}, {
   3.9282542355028954`*^9, 3.928254273564179*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"ef859127-62e2-4200-a0a8-1ae6d0d338c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Incidences", "Subsection",
 CellChangeTimes->{{3.887219345736392*^9, 3.887219358910851*^9}, {
  3.887284323410316*^9, 3.887284353773122*^9}, {3.8901443064409246`*^9, 
  3.890144315956683*^9}},ExpressionUUID->"ae15a872-cb05-4953-b0d0-\
93fe9efbbd3f"],

Cell["\<\
Create interpolating polynomials of the incidence in specific years for \
plotting.\
\>", "Text",
 CellChangeTimes->{{3.887282965070787*^9, 3.887282994957725*^9}, {
  3.887283035893827*^9, 3.887283052104137*^9}, {3.88728429256264*^9, 
  3.887284296884962*^9}, {3.8872843565396214`*^9, 3.887284365888502*^9}, {
  3.8896128211486483`*^9, 3.889612827120493*^9}, {3.890146699622108*^9, 
  3.8901467152594213`*^9}},ExpressionUUID->"84e4f979-c891-4cc4-8a05-\
f646ea240d67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"To", " ", "plot", " ", "more", " ", "incidence", " ", "rates"}], 
    ",", " ", 
    RowBox[{
    "increase", " ", "the", " ", "number", " ", "of", " ", "elements", " ", 
     "in", " ", "the", " ", "incidenceIndexes", " ", "list"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"incidenceIndexes", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"Length", "[", "incidences", "]"}], "/", "2.0"}], "]"}], ",", 
       RowBox[{"Length", "[", "incidences", "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"incidenceInterpolations", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"incidenceAgeMaxes", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<=", 
       RowBox[{"Length", "[", "incidenceIndexes", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"incidenceAgeMax", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"incidences", "\[LeftDoubleBracket]", 
              RowBox[{
              "incidenceIndexes", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"incidences", "\[LeftDoubleBracket]", 
               RowBox[{
               "incidenceIndexes", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "]"}]}],
             "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"incidenceAgeMaxes", ",", "incidenceAgeMax"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"incidenceInterp", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"incidences", "\[LeftDoubleBracket]", 
           RowBox[{
           "incidenceIndexes", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
          "InterpolationOrder", "->", "incidenceInterpolationOrder"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"incidenceInterpolation", "[", "a_", "]"}], "=", 
        RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"a", "<", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"incidenceInterp", "[", "a", "]"}], ",", 
             RowBox[{"0", "<=", "a", "<=", "incidenceAgeMax"}]}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"a", ">", "incidenceAgeMax"}]}], "}"}]}], "}"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"incidenceInterpolations", ",", 
         RowBox[{
          RowBox[{"incidenceInterpolation", "[", "a", "]"}], "\[Times]", 
          "100000"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"incidenceAgeMax", "=", 
     RowBox[{"Max", "[", "incidenceAgeMaxes", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{"incidenceInterpolations", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "incidenceAgeMax"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Incidence [per 100,000]\>\"", "]"}]}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"LabelStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "->", "18"}], ",", 
        RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.887219360243113*^9, 3.8872193609821043`*^9}, {
   3.887285586069487*^9, 3.887285800378274*^9}, {3.887285837717031*^9, 
   3.88728584847326*^9}, {3.887285892712298*^9, 3.887285985429957*^9}, {
   3.8872860266278*^9, 3.887286045099168*^9}, 3.8872860798253107`*^9, {
   3.887286207450388*^9, 3.887286291578559*^9}, {3.8872867190702047`*^9, 
   3.887286727315382*^9}, {3.887287409325219*^9, 3.887287431687763*^9}, 
   3.887313721814048*^9, {3.8873138345860653`*^9, 3.887313849383276*^9}, {
   3.8873592180108*^9, 3.887359233480401*^9}, 3.887378092647417*^9, {
   3.887378551097804*^9, 3.887378552294235*^9}, 3.887456710999468*^9, 
   3.887457165807736*^9, {3.889604214399794*^9, 3.889604233761681*^9}, {
   3.889611011961447*^9, 3.889611017330241*^9}, {3.889611074370908*^9, 
   3.889611098879826*^9}, {3.8896111790410233`*^9, 3.889611218091861*^9}, {
   3.88961281880858*^9, 3.889612982609705*^9}, {3.889613101535665*^9, 
   3.889613136893725*^9}, {3.889699105234435*^9, 3.889699114892295*^9}, {
   3.889888088065351*^9, 3.889888092718741*^9}, {3.890144107584943*^9, 
   3.8901441643618107`*^9}, {3.8901442208106737`*^9, 
   3.8901442807279787`*^9}, {3.8901443397525263`*^9, 3.890144483449636*^9}, {
   3.890144517492865*^9, 3.890144555547394*^9}, {3.8901447036491337`*^9, 
   3.890144707616997*^9}, {3.890144910950926*^9, 3.89014494643445*^9}, {
   3.890145048988451*^9, 3.890145074559763*^9}, {3.8916992104877577`*^9, 
   3.891699214891135*^9}, {3.891699464903372*^9, 3.89169947177639*^9}, {
   3.891772447118443*^9, 3.8917724794324083`*^9}, {3.891772816116948*^9, 
   3.891772825228496*^9}, 3.891880195598262*^9, {3.901983572634695*^9, 
   3.901983712383614*^9}, {3.901983755652268*^9, 3.901983765416733*^9}, {
   3.902229274384575*^9, 3.902229314470945*^9}, {3.902499729289875*^9, 
   3.902499729363575*^9}, {3.902499786162355*^9, 3.902499834859001*^9}, {
   3.902500083574602*^9, 3.902500143556469*^9}, {3.902843392555401*^9, 
   3.90284346257373*^9}, {3.90482002392255*^9, 3.904820035759624*^9}, {
   3.9048201670907927`*^9, 3.9048201940042543`*^9}, {3.904820229415142*^9, 
   3.90482028904261*^9}, {3.9048203420288754`*^9, 3.904820342748145*^9}, {
   3.905349111072463*^9, 3.9053491128005047`*^9}, {3.9086272975555267`*^9, 
   3.908627297615274*^9}, {3.9089745963859787`*^9, 3.908974601388036*^9}, {
   3.908988860496904*^9, 3.9089888606511707`*^9}, {3.9089889277813272`*^9, 
   3.908988951395028*^9}, {3.908991178415851*^9, 3.908991181487891*^9}, {
   3.908992221402916*^9, 3.90899222585175*^9}, {3.9138975771569347`*^9, 
   3.913898037596517*^9}, {3.913898072620075*^9, 3.9138981739973927`*^9}, {
   3.913898217271625*^9, 3.913898269466667*^9}, {3.9138983277986317`*^9, 
   3.913898368292201*^9}, {3.913898402241517*^9, 3.913898458945786*^9}, {
   3.913899314560597*^9, 3.913899316106326*^9}, 3.913991960671278*^9, {
   3.9170061175963182`*^9, 3.917006122150083*^9}, {3.91708651294549*^9, 
   3.9170865227643957`*^9}, 3.917086626265278*^9, 3.91726581421692*^9, 
   3.91727086423328*^9, {3.9203807098246727`*^9, 3.920380820452877*^9}, {
   3.920380893492476*^9, 3.9203810570860023`*^9}, {3.920381101615881*^9, 
   3.920381190218706*^9}, {3.920381255430419*^9, 3.920381359171915*^9}, {
   3.920448430498665*^9, 3.9204484427710247`*^9}, {3.920448957011621*^9, 
   3.920448962227798*^9}, {3.920449002073372*^9, 3.9204490103568983`*^9}, {
   3.920544141450858*^9, 3.9205443604325447`*^9}, {3.920544404697528*^9, 
   3.920544412793919*^9}, {3.920549689488242*^9, 3.9205497161698513`*^9}, {
   3.920549757905787*^9, 3.9205498508223352`*^9}, {3.9206450738671217`*^9, 
   3.9206450958287277`*^9}, {3.920722513133765*^9, 3.92072251497845*^9}, {
   3.920804155667988*^9, 3.9208041570393057`*^9}, {3.920884813984889*^9, 
   3.920884823671247*^9}, {3.920884860168168*^9, 3.9208848950973587`*^9}, 
   3.921064863505094*^9, {3.921156773033805*^9, 3.921156773361092*^9}, {
   3.921156914438877*^9, 3.921157086869487*^9}, {3.938777481647416*^9, 
   3.938777511487214*^9}},ExpressionUUID->"7c5bfbb3-b2a2-47bd-9269-\
9671b5f29115"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean Incidences", "Subsection",
 CellChangeTimes->{{3.887219345736392*^9, 3.887219358910851*^9}, {
  3.887284323410316*^9, 3.887284353773122*^9}, {3.8901443064409246`*^9, 
  3.8901443069576187`*^9}},ExpressionUUID->"63468aed-46ba-4a59-a779-\
9ba18249e8b9"],

Cell["\<\
Create interpolating polynomials of the average, lower, and upper bound \
incidences. Note that if there is only a single data set, all three curves \
will be identical.\
\>", "Text",
 CellChangeTimes->{{3.887282965070787*^9, 3.887282994957725*^9}, {
  3.887283035893827*^9, 3.887283052104137*^9}, {3.88728429256264*^9, 
  3.887284296884962*^9}, {3.8872843565396214`*^9, 3.887284365888502*^9}, {
  3.8896128211486483`*^9, 3.889612827120493*^9}, {3.902667998256564*^9, 
  3.902667999748654*^9}, {3.913978181772365*^9, 
  3.913978204902176*^9}},ExpressionUUID->"3a210247-1ea5-424a-96a4-\
2b2a7f680627"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aveInterp", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"aveIncidence", ",", 
     RowBox[{"InterpolationOrder", "->", "incidenceInterpolationOrder"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerInterp", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"lowerIncidence", ",", 
     RowBox[{"InterpolationOrder", "->", "incidenceInterpolationOrder"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"upperInterp", "=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"upperIncidence", ",", 
      RowBox[{"InterpolationOrder", "->", "incidenceInterpolationOrder"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aveIncidenceInterp", "[", "a_", "]"}], "=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"a", "<", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"aveInterp", "[", "a", "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"0", "<=", "a", "<=", "incidenceAgeMax"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"a", ">", "incidenceAgeMax"}]}], "}"}]}], "}"}], 
      "\[IndentingNewLine]", "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lowerIncidenceInterp", "[", "a_", "]"}], "=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"a", "<", "0"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lowerInterp", "[", "a", "]"}], ",", 
          RowBox[{"0", "<=", "a", "<=", "incidenceAgeMax"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"a", ">", "incidenceAgeMax"}]}], "}"}]}], "}"}], 
      "\[IndentingNewLine]", "]"}], ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"upperIncidenceInterp", "[", "a_", "]"}], "=", 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"a", "<", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"upperInterp", "[", "a", "]"}], ",", 
           RowBox[{"0", "<=", "a", "<=", "incidenceAgeMax"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"a", ">", "incidenceAgeMax"}]}], "}"}]}], "}"}], 
       "\[IndentingNewLine]", "]"}], ",", "0"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"aveIncidenceInterp", "[", "a", "]"}], "\[Times]", "100000"}], 
     ",", 
     RowBox[{
      RowBox[{"lowerIncidenceInterp", "[", "a", "]"}], "\[Times]", "100000"}],
      ",", 
     RowBox[{
      RowBox[{"upperIncidenceInterp", "[", "a", "]"}], "\[Times]", 
      "100000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "incidenceAgeMax"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "Black", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Black", ",", " ", "Dashed"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Black", ",", " ", "Dashed"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", "\"\<Incidence [per 100,000]\>\"", "]"}]}]}], 
     "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"LabelStyle", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontSize", "->", "18"}], ",", 
      RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.887219360243113*^9, 3.8872193609821043`*^9}, {
   3.887285586069487*^9, 3.887285800378274*^9}, {3.887285837717031*^9, 
   3.88728584847326*^9}, {3.887285892712298*^9, 3.887285985429957*^9}, {
   3.8872860266278*^9, 3.887286045099168*^9}, 3.8872860798253107`*^9, {
   3.887286207450388*^9, 3.887286291578559*^9}, {3.8872867190702047`*^9, 
   3.887286727315382*^9}, {3.887287409325219*^9, 3.887287431687763*^9}, 
   3.887313721814048*^9, {3.8873138345860653`*^9, 3.887313849383276*^9}, {
   3.8873592180108*^9, 3.887359233480401*^9}, 3.887378092647417*^9, {
   3.887378551097804*^9, 3.887378552294235*^9}, 3.887456710999468*^9, 
   3.887457165807736*^9, {3.889604214399794*^9, 3.889604233761681*^9}, {
   3.889611011961447*^9, 3.889611017330241*^9}, {3.889611074370908*^9, 
   3.889611098879826*^9}, {3.8896111790410233`*^9, 3.889611218091861*^9}, {
   3.88961281880858*^9, 3.889612982609705*^9}, {3.889613101535665*^9, 
   3.889613136893725*^9}, {3.889699105234435*^9, 3.889699114892295*^9}, {
   3.889888088065351*^9, 3.889888092718741*^9}, {3.890144107584943*^9, 
   3.8901441643618107`*^9}, {3.8901442208106737`*^9, 
   3.8901442807279787`*^9}, {3.890145412216544*^9, 3.890145445445776*^9}, 
   3.891701457086617*^9, {3.891772492612544*^9, 3.89177250179615*^9}, 
   3.8918802829167557`*^9, 3.891880327760788*^9, {3.9019837810541143`*^9, 
   3.901983808812419*^9}, {3.902230725021184*^9, 3.902230741511841*^9}, {
   3.902500751035654*^9, 3.902500754916418*^9}, {3.902501738679171*^9, 
   3.902501770850629*^9}, {3.905349114724736*^9, 3.905349116042498*^9}, {
   3.908627315904621*^9, 3.9086273159976463`*^9}, {3.9089746160776587`*^9, 
   3.908974621888712*^9}, {3.908988873007687*^9, 3.908988876507094*^9}, {
   3.908988982290825*^9, 3.908988986711298*^9}, {3.9089911886784477`*^9, 
   3.908991188739946*^9}, {3.908992231619865*^9, 3.90899223498619*^9}, 
   3.9092205935041924`*^9, 3.909224539258978*^9, {3.913898494644392*^9, 
   3.913898526631723*^9}, 3.9138987234982557`*^9, {3.9138993094318657`*^9, 
   3.913899311254217*^9}, {3.9170061321296177`*^9, 3.917006142313696*^9}, {
   3.9170865327973833`*^9, 3.9170865372180233`*^9}, {3.917086632290453*^9, 
   3.9170866345268583`*^9}, {3.917270870058716*^9, 3.9172708860213633`*^9}, {
   3.917348352907248*^9, 3.9173484337015543`*^9}, {3.917348624523554*^9, 
   3.917348632263088*^9}, {3.9204484841733503`*^9, 3.920448527600247*^9}, {
   3.920448968643242*^9, 3.92044898083086*^9}, {3.921157100803911*^9, 
   3.9211571395748863`*^9}, 
   3.9387775368079863`*^9},ExpressionUUID->"24600e74-4327-4629-9932-\
37dae216260c"],

Cell["Save the average incidence age structure to a file.", "Text",
 CellChangeTimes->{
  3.891713721280713*^9, {3.8917159428978767`*^9, 3.891715967851944*^9}, {
   3.902230760815563*^9, 3.902230763638525*^9}, {3.913899359025573*^9, 
   3.913899365479244*^9}},ExpressionUUID->"434b1606-13cc-4209-a27a-\
bc800d19feba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"saveInitialData", "==", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filePath", "=", 
      RowBox[{
      "rootOutputDir", "<>", "\"\<averaged_incidence/\>\"", "<>", "subType", 
       "<>", "\"\</AverageIncidence.csv\>\""}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"popAges", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "incidenceAgeMax"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Age [Years]\>\"", ",", "\"\<Incidence [per 100,000]\>\"", ",", 
        "\"\<Lower CI [per 100,000]\>\"", ",", 
        "\"\<Upper CI [per 100,000]\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "popAges", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"100000", "\[Times]", 
           RowBox[{"aveIncidenceInterp", "[", 
            RowBox[{
            "popAges", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"100000", "\[Times]", 
           RowBox[{"lowerIncidenceInterp", "[", 
            RowBox[{
            "popAges", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"100000", "\[Times]", 
           RowBox[{"upperIncidenceInterp", "[", 
            RowBox[{
            "popAges", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
             "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "popAges", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"data", ",", "header"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.891713601430751*^9, 3.891713618852212*^9}, {
   3.89171368117647*^9, 3.891713768263701*^9}, {3.891713818947914*^9, 
   3.8917139356253843`*^9}, {3.891714209498476*^9, 3.891714294702354*^9}, {
   3.8917143419814987`*^9, 3.891714515989423*^9}, {3.891714676947504*^9, 
   3.891714757353074*^9}, {3.8917147930204353`*^9, 3.891714844458756*^9}, {
   3.8917148906981897`*^9, 3.891714968361058*^9}, {3.891715088466803*^9, 
   3.891715097522706*^9}, {3.8917158164500217`*^9, 3.891715845632351*^9}, 
   3.891716001743334*^9, {3.891716061564986*^9, 3.8917161476506777`*^9}, {
   3.891716207196189*^9, 3.8917163874903183`*^9}, {3.891716445702321*^9, 
   3.891716529083415*^9}, {3.891716600958119*^9, 3.891716614277999*^9}, {
   3.891717237692254*^9, 3.8917172515034723`*^9}, {3.8917750749683533`*^9, 
   3.891775077435668*^9}, {3.891880182792368*^9, 3.891880202954898*^9}, {
   3.8918876982883787`*^9, 3.8918877048041286`*^9}, {3.8918877620884943`*^9, 
   3.891887798280225*^9}, {3.901962672262924*^9, 3.901962672694665*^9}, {
   3.904813724738777*^9, 3.904813736759001*^9}, {3.913990087444313*^9, 
   3.913990089147287*^9}, {3.9139914221159782`*^9, 3.913991424376678*^9}, {
   3.920803837377792*^9, 3.9208038394922657`*^9}, {3.92825429393673*^9, 
   3.9282543063619747`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"6708ad2c-014e-4037-b05b-bba618212cc7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Population", "Subsection",
 CellChangeTimes->{{3.93877759397999*^9, 
  3.93877760133923*^9}},ExpressionUUID->"82bd3dba-17ab-45cb-b0e8-\
392c22ae7655"],

Cell[TextData[{
 "Create interpolating polynomials of the population fractions.\n\n",
 StyleBox["NOTE",
  FontWeight->"Bold"],
 ": For the Canadian data, using a linear interpolation here seems most \
prudent. Higher order interpolations (second and third) seem to produce a \
greatly exaggerated peak in population density at age greater than 80. For \
countries with yearly data, this is not a concern (nor will higher-order \
interpolations be necessary)."
}], "Text",
 CellChangeTimes->{{3.887282965070787*^9, 3.887282994957725*^9}, {
  3.887283035893827*^9, 3.887283052104137*^9}, {3.88728429256264*^9, 
  3.887284296884962*^9}, {3.8872843565396214`*^9, 3.887284365888502*^9}, {
  3.887286316051178*^9, 3.887286336953795*^9}, {3.890043457880514*^9, 
  3.890043503093624*^9}, {3.890043574635191*^9, 3.890043627888826*^9}, {
  3.9086275942037687`*^9, 3.9086276401247663`*^9}, {3.93877758618721*^9, 
  3.938777589079362*^9}},ExpressionUUID->"03fb0196-ee28-48c6-ac29-\
a2aa223904fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"populationAgeMaxes", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"populationInterps", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", 
      RowBox[{"Length", "[", "populations", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"populationAgeMax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "populations", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "j", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"populations", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"populationAgeMaxes", ",", "populationAgeMax"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pop", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "populations", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "populations", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"populations", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"interp", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"pop", ",", 
         RowBox[{
         "InterpolationOrder", "->", "populationInterpolationOrder"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"populationInterp", "[", "a_", "]"}], "=", 
       RowBox[{"Piecewise", "[", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"a", "<", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"interp", "[", "a", "]"}], ",", 
            RowBox[{"0", "<=", "a", "<=", "populationAgeMax"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"a", ">", "populationAgeMax"}]}], "}"}]}], "}"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{"1", "/", 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"populationInterp", "[", "a", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "0", ",", 
            RowBox[{"1.2", "populationAgeMax"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"popInterp", "[", "a_", "]"}], "=", 
       RowBox[{"norm", "\[Times]", 
        RowBox[{"populationInterp", "[", "a", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"populationInterps", ",", 
        RowBox[{"popInterp", "[", "a", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"populationAgeMax", "=", 
    RowBox[{"Max", "[", "populationAgeMaxes", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"populationIndexes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "populationInterps", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"popInterpsToPlot", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"populationInterps", "\[LeftDoubleBracket]", 
       RowBox[{
       "populationIndexes", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "populationIndexes", "]"}]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{"popInterpsToPlot", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"a", ",", "0", ",", "populationAgeMax"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Green", ",", "Blue"}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
      RowBox[{"Text", "@", 
       RowBox[{"Style", "[", "\"\<Normalised Population\>\"", "]"}]}]}], 
     "}"}]}], ",", 
   RowBox[{"LabelStyle", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FontSize", "->", "18"}], ",", 
      RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.887219360243113*^9, 3.8872193609821043`*^9}, {
   3.887285586069487*^9, 3.887285800378274*^9}, {3.887285837717031*^9, 
   3.88728584847326*^9}, {3.887285892712298*^9, 3.887285985429957*^9}, {
   3.8872860266278*^9, 3.887286045099168*^9}, 3.8872860798253107`*^9, {
   3.887286207450388*^9, 3.887286291578559*^9}, {3.887286340333386*^9, 
   3.887286556211894*^9}, {3.8872866696777353`*^9, 3.887286732906238*^9}, 
   3.8872874411639843`*^9, {3.887313863536965*^9, 3.887313877005376*^9}, {
   3.887359240510151*^9, 3.887359256122908*^9}, 3.887378103581545*^9, {
   3.8873785592719393`*^9, 3.887378560165167*^9}, 3.8874567180451403`*^9, 
   3.8874571692511473`*^9, {3.889604444464073*^9, 3.889604458872768*^9}, {
   3.889613438677451*^9, 3.889613646802655*^9}, 3.889698806351512*^9, {
   3.8896991211693077`*^9, 3.889699126913866*^9}, 3.889699236351688*^9, {
   3.889710963552949*^9, 3.88971096558392*^9}, {3.8898881066312323`*^9, 
   3.889888128457737*^9}, {3.890043518838646*^9, 3.89004356181358*^9}, 
   3.890043634039136*^9, 3.890043687701902*^9, {3.890146615011619*^9, 
   3.8901466768092318`*^9}, {3.8901467324031143`*^9, 3.890146749888144*^9}, {
   3.890146780060038*^9, 3.89014681337923*^9}, {3.890146845626048*^9, 
   3.890146873595778*^9}, {3.890147570889525*^9, 3.890147594686214*^9}, {
   3.890147649732479*^9, 3.8901476669187517`*^9}, 3.8916937249066973`*^9, {
   3.8917065026798563`*^9, 3.891706529947193*^9}, {3.899971919881722*^9, 
   3.8999719479457083`*^9}, {3.901983838765861*^9, 3.901983842192795*^9}, {
   3.901984061449834*^9, 3.901984098865405*^9}, 3.902223687637615*^9, {
   3.9022346489737873`*^9, 3.9022346777839813`*^9}, {3.9025007678428183`*^9, 
   3.902500770927554*^9}, {3.902501779116845*^9, 3.9025017838149767`*^9}, {
   3.9025021927304153`*^9, 3.902502194583205*^9}, {3.90284350599962*^9, 
   3.902843559299939*^9}, {3.902863739813455*^9, 3.902863784408394*^9}, 
   3.9031810902172937`*^9, {3.903198230440921*^9, 3.903198231981627*^9}, {
   3.9053517663763523`*^9, 3.905351770504554*^9}, {3.907420354771208*^9, 
   3.907420453681388*^9}, {3.907420583122714*^9, 3.9074205957873*^9}, {
   3.9074206686751623`*^9, 3.907420678501009*^9}, {3.907420709596182*^9, 
   3.9074209333127937`*^9}, {3.907423844846363*^9, 3.90742388385187*^9}, {
   3.907424439922007*^9, 3.9074244674039583`*^9}, {3.907427280366946*^9, 
   3.907427301904235*^9}, {3.907427343656288*^9, 3.907427348097926*^9}, {
   3.90752017674428*^9, 3.907520251660104*^9}, {3.9075206103077497`*^9, 
   3.9075206235982723`*^9}, {3.908627391307405*^9, 3.908627542647056*^9}, {
   3.908627738355384*^9, 3.90862777645124*^9}, {3.908883532212161*^9, 
   3.908883572600432*^9}, {3.908883646940916*^9, 3.908883670651639*^9}, {
   3.908890303185714*^9, 3.908890391068234*^9}, {3.9092245931527853`*^9, 
   3.909224642061222*^9}, {3.9092254256865873`*^9, 3.909225460043351*^9}, {
   3.9094828472130947`*^9, 3.909482870824131*^9}, {3.909483075722986*^9, 
   3.9094830802639427`*^9}, {3.909483239232254*^9, 3.909483244719095*^9}, {
   3.909483385481703*^9, 3.909483419187224*^9}, {3.913898738568375*^9, 
   3.913898831980714*^9}, {3.913898897010192*^9, 3.9138990678616734`*^9}, {
   3.913899098610099*^9, 3.913899172444888*^9}, {3.9138992154335823`*^9, 
   3.9138992336325197`*^9}, {3.9138992787630663`*^9, 3.913899302243181*^9}, 
   3.917086558662023*^9, 3.917086646210309*^9, {3.920448752212031*^9, 
   3.920448764987802*^9}, 3.9204510340406513`*^9, {3.920544925217311*^9, 
   3.920544938152031*^9}, 3.920545067190901*^9, {3.9207391024640207`*^9, 
   3.920739119771297*^9}, {3.920739201520258*^9, 3.920739201658785*^9}, {
   3.9208034706266527`*^9, 3.92080353573773*^9}, {3.9208035831451283`*^9, 
   3.920803599837605*^9}, {3.920885358722948*^9, 3.920885359894949*^9}, {
   3.929783220836589*^9, 3.9297832703565607`*^9}, {3.938777633541149*^9, 
   3.938777651372806*^9}},ExpressionUUID->"83107b97-5082-4d63-b879-\
5d3186dcc0cb"],

Cell["\<\
Save the population age structure for the data plotted above into individual \
data sets and as a combined data set.\
\>", "Text",
 CellChangeTimes->{
  3.891713721280713*^9, {3.8917159428978767`*^9, 3.891715967851944*^9}, {
   3.913899377173355*^9, 3.9138993833519173`*^9}, {3.913899441112899*^9, 
   3.91389947615935*^9}},ExpressionUUID->"411dcd5f-33ef-43c5-9f78-\
3c21429b4a1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"saveInitialData", "==", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"The", " ", "individual", " ", "data", " ", "sets"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"popAges", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "populationAgeMax"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "populationIndexes", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"filePath", "=", 
         RowBox[{
         "rootOutputDir", "<>", "\"\<pop_age_structure/\>\"", "<>", "subType",
           "<>", "\"\</\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"populationYears", "\[LeftDoubleBracket]", 
            RowBox[{"populationIndexes", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[RightDoubleBracket]"}], "]"}],
           "<>", "\"\<.csv\>\""}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"header", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Age [Years]\>\"", ",", "\"\<Normalized Population\>\""}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "popAges", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"populationInterps", "\[LeftDoubleBracket]", 
               RowBox[{
               "populationIndexes", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"a", "->", 
               RowBox[{
               "popAges", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "popAges", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{"data", ",", "header"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"The", " ", "combined", " ", "data", " ", "set"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"filePath", "=", 
      RowBox[{
      "rootOutputDir", "<>", "\"\<pop_age_structure/\>\"", "<>", "subType", 
       "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"Length", "[", "populationIndexes", "]"}], "]"}], "<>", 
       "\"\<_examples.csv\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"populationYears", "\[LeftDoubleBracket]", 
           RowBox[{
           "populationIndexes", "\[LeftDoubleBracket]", "j", 
            "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "]"}], 
         "<>", "\"\< Normalized Population Density\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "populationIndexes", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"PrependTo", "[", 
      RowBox[{"header", ",", "\"\<Age [Years]\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "popAges", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"populationInterps", "\[LeftDoubleBracket]", 
               RowBox[{
               "populationIndexes", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"a", "->", 
               RowBox[{
               "popAges", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "populationIndexes", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "popAges", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"data", ",", "header"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.891713601430751*^9, 3.891713618852212*^9}, {
   3.89171368117647*^9, 3.891713768263701*^9}, {3.891713818947914*^9, 
   3.8917139356253843`*^9}, {3.891714209498476*^9, 3.891714294702354*^9}, {
   3.8917143419814987`*^9, 3.891714515989423*^9}, {3.891714676947504*^9, 
   3.891714757353074*^9}, {3.8917147930204353`*^9, 3.891714844458756*^9}, {
   3.8917148906981897`*^9, 3.891714968361058*^9}, {3.891715088466803*^9, 
   3.891715097522706*^9}, {3.8917158164500217`*^9, 3.891715845632351*^9}, 
   3.891716001743334*^9, {3.891716061564986*^9, 3.8917161476506777`*^9}, {
   3.891716207196189*^9, 3.8917163874903183`*^9}, {3.8917171768950653`*^9, 
   3.891717177920824*^9}, {3.891887846576132*^9, 3.891887869312006*^9}, {
   3.899972032904112*^9, 3.899972052041901*^9}, {3.899972409018118*^9, 
   3.899972425204788*^9}, {3.901962685126524*^9, 3.901962722706859*^9}, 
   3.901962757189768*^9, {3.901984116709873*^9, 3.901984119439529*^9}, {
   3.902220513903935*^9, 3.902220558478085*^9}, {3.902220712510491*^9, 
   3.902220781118432*^9}, {3.902220839009893*^9, 3.902220955534707*^9}, {
   3.9022210272044067`*^9, 3.9022210680753813`*^9}, {3.9022233738391447`*^9, 
   3.902223391985515*^9}, {3.902223573133868*^9, 3.90222360362077*^9}, {
   3.9022346900646477`*^9, 3.902234706157051*^9}, {3.9048137494005957`*^9, 
   3.9048137593246202`*^9}, {3.907427329248118*^9, 3.907427330008978*^9}, {
   3.9074273620628767`*^9, 3.9074274112146997`*^9}, {3.907760231889604*^9, 
   3.907760232688611*^9}, 3.909225451302616*^9, {3.90948315353511*^9, 
   3.90948317659737*^9}, {3.909483305162373*^9, 3.909483310101818*^9}, {
   3.909483395430304*^9, 3.909483412763962*^9}, {3.913899409202533*^9, 
   3.913899428642106*^9}, {3.913899480938616*^9, 3.913899484799267*^9}, {
   3.913899517874961*^9, 3.913899619207522*^9}, {3.913989514735565*^9, 
   3.913989515949403*^9}, {3.913989594467573*^9, 3.9139895964468193`*^9}, {
   3.9139900738046427`*^9, 3.913990077159274*^9}, {3.9139914545140877`*^9, 
   3.913991462618416*^9}, {3.921056437060137*^9, 3.921056438959777*^9}, {
   3.928254320239843*^9, 3.928254342926166*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"05a14298-f712-4ff1-9651-6e339341b8e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Age- and Time-Dependent Prevalence", "Section",
 CellChangeTimes->{{3.887287520703251*^9, 
  3.887287545767766*^9}},ExpressionUUID->"e9928256-1700-4915-945d-\
168cfe1e3dac"],

Cell[TextData[{
 "This section calculates the prevalence as a function of age and time from \
the initial prevalence and the mean incidence. Here, the incidence will be a \
function of age and time. The age dependence is given through the average of \
the yearly incidence rates. The time dependence takes the form of an \
exponential growth/decay rate (see ",
 StyleBox["timeDepInc",
  FontWeight->"Bold"],
 " function) that begins in the year 2025 (see ",
 StyleBox["timeCutOff",
  FontWeight->"Bold"],
 " variable). The growth factor, ",
 StyleBox["g",
  FontSlant->"Italic"],
 ", is the base for the exponential growth (i.e., ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", 
    RowBox[{"t", "-", 
     SubscriptBox["t", "0"]}]], TraditionalForm]],ExpressionUUID->
  "678fecb9-ffe2-483e-acd0-a53343912ccc"],
 ")",
 " and will be a number near unity (i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"g", "=", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[Epsilon]"}], ")"}]}], ",", " ", 
    RowBox[{"|", "\[Epsilon]", "|", 
     RowBox[{"<<", "1"}]}]}], TraditionalForm]],ExpressionUUID->
  "376fb1e9-854e-4859-b97c-53497859658d"],
 ")",
 ".",
 "\n\nNote that the calculation is broken up into three parts, in order to \
properly determine the bounds of the piecewise continuous functions involved, \
and to provide a solution to the prevalence where ",
 StyleBox["a",
  FontSlant->"Italic"],
 " = ",
 StyleBox["t",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.8872875545089293`*^9, 3.887287601285473*^9}, {
   3.887298935926903*^9, 3.887298967482923*^9}, 3.887299002325294*^9, {
   3.887299147542891*^9, 3.887299158522037*^9}, {3.887358554520084*^9, 
   3.887358594706077*^9}, {3.890043739942271*^9, 3.890043764783267*^9}, {
   3.913899636606886*^9, 3.9138996424189177`*^9}, {3.913903703700513*^9, 
   3.9139037078890553`*^9}, {3.9139039445091963`*^9, 3.913904024003437*^9}, {
   3.913907199622168*^9, 3.913907397552828*^9}, {3.9139086404056*^9, 
   3.9139088063430843`*^9}},ExpressionUUID->"6677d032-c05b-48e9-8bb7-\
9efc61a6c380"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "=", 
    RowBox[{"1.0", "\[Times]", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Time", " ", "range", " ", "for", " ", "the", " ", "prevalance", " ", "as",
     " ", "a", " ", "function", " ", "of", " ", "age", " ", "and", " ", 
    "time"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"beginYear", "=", "0"}], ";", 
   RowBox[{"endYear", "=", "120"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "p0", ",", "aveInc", ",", "avep1Integral", ",", "avep2Integral", ",", 
     "avePrevalences"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"growthStartYear", "=", "2024"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"growthStartTime", "=", 
   RowBox[{"growthStartYear", "-", "projectionStartYear"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"timeDepInc", "[", 
     RowBox[{"t_", ",", "g_"}], "]"}], "=", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t", " ", "-", "growthStartTime"}], ")"}], 
           RowBox[{"Log", "[", "g", "]"}]}]], ",", 
         RowBox[{"t", ">=", "growthStartTime"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"t", "<", "growthStartTime"}]}], "}"}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "latest", " ", "prevalence", " ", "data", " ", "set", " ", 
    "is", " ", "the", " ", "initial", " ", "condition", " ", "for", " ", 
    "the", " ", "model"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p0", "[", 
    RowBox[{"t_", ",", "a_"}], "]"}], "=", 
   RowBox[{"prevalenceInterps", "\[LeftDoubleBracket]", 
    RowBox[{"Length", "[", "prevalenceInterps", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aveInc", "[", 
     RowBox[{"t_", ",", "a_", ",", "g_"}], "]"}], "=", 
    RowBox[{
     RowBox[{"aveIncidenceInterp", "[", "a", "]"}], 
     RowBox[{"timeDepInc", "[", 
      RowBox[{"t", ",", "g"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avep1Integral", "[", 
    RowBox[{
     RowBox[{"t_", "?", "NumericQ"}], ",", 
     RowBox[{"a_", "?", "NumericQ"}], ",", 
     RowBox[{"g_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"aveInc", "[", 
      RowBox[{
       RowBox[{"x", "+", "t", "-", "a"}], ",", "x", ",", "g"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "a"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"avep2Integral", "[", 
     RowBox[{
      RowBox[{"t_", "?", "NumericQ"}], ",", 
      RowBox[{"a_", "?", "NumericQ"}], ",", 
      RowBox[{"g_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"aveInc", "[", 
       RowBox[{"x", ",", 
        RowBox[{"x", "+", "a", "-", "t"}], ",", "g"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Terms", " ", "containing", " ", "\[Epsilon]", " ", "are", " ", "for", 
     " ", "the", " ", "case", " ", "where", " ", 
     StyleBox["a",
      FontSlant->"Italic"]}], "=", 
    StyleBox["t",
     FontSlant->"Italic"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"avePrevalences", "[", 
    RowBox[{"t_", ",", "a_", ",", "g_"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"p0", "[", 
             RowBox[{
              RowBox[{"t", "-", "a"}], ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"avep1Integral", "[", 
             RowBox[{"t", ",", "a", ",", "g"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "<=", "a", "<", "t"}], "&&", 
         RowBox[{"beginYear", "<=", "t", "<=", "endYear"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p0", "[", 
                RowBox[{
                 RowBox[{"t", "-", "a", "+", 
                  RowBox[{"2", "\[Epsilon]"}]}], ",", "0"}], "]"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"avep1Integral", "[", 
                RowBox[{
                 RowBox[{"t", "+", "\[Epsilon]"}], ",", 
                 RowBox[{"a", "-", "\[Epsilon]"}], ",", "g"}], "]"}]}], 
              "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p0", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"a", "-", "t", "+", 
                  RowBox[{"2", "\[Epsilon]"}]}]}], "]"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"avep2Integral", "[", 
                RowBox[{
                 RowBox[{"t", "-", "\[Epsilon]"}], ",", 
                 RowBox[{"a", "+", "\[Epsilon]"}], ",", "g"}], "]"}]}], 
              "]"}]}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "==", "a"}], "&&", 
         RowBox[{"beginYear", "<=", "t", "<=", "endYear"}], "&&", 
         RowBox[{"a", ">", "\[Epsilon]"}], "&&", 
         RowBox[{"t", ">", "\[Epsilon]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"p0", "[", 
             RowBox[{"0", ",", 
              RowBox[{"a", "-", "t"}]}], "]"}]}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"avep2Integral", "[", 
             RowBox[{"t", ",", "a", ",", "g"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "<=", "t", "<", "a"}], "&&", 
         RowBox[{"beginYear", "<=", "t", "<=", "endYear"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.887299259850396*^9, 3.887299321044408*^9}, {
   3.887299423879355*^9, 3.887299657959144*^9}, {3.88730155093342*^9, 
   3.88730157971056*^9}, {3.8873111278178368`*^9, 3.887311325394731*^9}, {
   3.88731135597333*^9, 3.887311377304256*^9}, {3.887311413415682*^9, 
   3.887311477652627*^9}, {3.8873115367215014`*^9, 3.887311623995984*^9}, {
   3.887312703537251*^9, 3.887312939728744*^9}, {3.887312987754027*^9, 
   3.887313088329582*^9}, {3.887313134254386*^9, 3.887313241040443*^9}, {
   3.887313399148994*^9, 3.88731340065007*^9}, {3.887313471935905*^9, 
   3.887313474771649*^9}, {3.8873135440231457`*^9, 3.887313649458856*^9}, 
   3.887313917231102*^9, {3.887313973121331*^9, 3.8873139754132433`*^9}, 
   3.887358444054453*^9, {3.887359356517378*^9, 3.8873593877408*^9}, {
   3.887360593691155*^9, 3.88736069627044*^9}, {3.887367713708445*^9, 
   3.887367740728696*^9}, {3.8873781149336233`*^9, 3.887378143903512*^9}, {
   3.887378575970633*^9, 3.88737864103098*^9}, {3.88737879698736*^9, 
   3.887378805716061*^9}, {3.887448287607134*^9, 3.887448309105535*^9}, {
   3.887448371959199*^9, 3.8874484087947693`*^9}, 3.8874484687334948`*^9, {
   3.887448505176359*^9, 3.887448513702545*^9}, {3.887448610593742*^9, 
   3.8874486189557953`*^9}, {3.887454626737575*^9, 3.887454656853447*^9}, {
   3.887456045653953*^9, 3.887456073045829*^9}, {3.887456733230859*^9, 
   3.8874567527750387`*^9}, {3.887457177256776*^9, 3.887457239949696*^9}, {
   3.887457297911943*^9, 3.887457319273514*^9}, {3.8874574230366488`*^9, 
   3.887457453184984*^9}, {3.887457496565194*^9, 3.8874577465530567`*^9}, {
   3.887458247773571*^9, 3.887458264709344*^9}, {3.887460639464182*^9, 
   3.887460928341406*^9}, 3.887463454729433*^9, {3.8896137486070433`*^9, 
   3.889613757487714*^9}, {3.889613822854261*^9, 3.889613852519085*^9}, {
   3.889613927828888*^9, 3.8896139309714527`*^9}, {3.8896140279229603`*^9, 
   3.8896140334383783`*^9}, {3.889614067272966*^9, 3.8896140686969557`*^9}, {
   3.889636176428335*^9, 3.889636347240491*^9}, 3.88969649946637*^9, {
   3.8900412884460783`*^9, 3.8900413027751904`*^9}, {3.890041351014533*^9, 
   3.890041385645314*^9}, {3.8900437808533287`*^9, 3.890043874475263*^9}, {
   3.890043904853778*^9, 3.890043950930476*^9}, {3.890044018477137*^9, 
   3.890044055816175*^9}, {3.8900441392101803`*^9, 3.89004416279226*^9}, {
   3.890044207208314*^9, 3.8900442330820227`*^9}, {3.8900443755106487`*^9, 
   3.890044411283821*^9}, {3.890044564912367*^9, 3.890044690081077*^9}, {
   3.890044725838007*^9, 3.890044810883185*^9}, {3.89004493856922*^9, 
   3.890044953416696*^9}, 3.890045140751519*^9, {3.890045722444385*^9, 
   3.89004572957479*^9}, {3.890045899050664*^9, 3.8900459183712482`*^9}, 
   3.890144093447811*^9, {3.89169930748493*^9, 3.891699332581985*^9}, {
   3.891715770041286*^9, 3.891715770882168*^9}, 3.891716006148477*^9, {
   3.891717157218131*^9, 3.891717157959049*^9}, 3.891717524917293*^9, 
   3.8917244161849613`*^9, {3.891766566591785*^9, 3.891766567155415*^9}, 
   3.89176832690711*^9, {3.891873958018857*^9, 3.891874023706607*^9}, {
   3.891874671521791*^9, 3.8918747181609983`*^9}, {3.8918747484026527`*^9, 
   3.891874849956655*^9}, 3.901984145443907*^9, {3.902230937575272*^9, 
   3.902230997514206*^9}, {3.9048137618238297`*^9, 3.904813762681533*^9}, {
   3.907427477048242*^9, 3.907427484690288*^9}, 3.907679860670315*^9, {
   3.9086278312348824`*^9, 3.908627858017268*^9}, {3.908881835244544*^9, 
   3.9088818352955713`*^9}, 3.908991298764533*^9, {3.913910702348362*^9, 
   3.913910761320826*^9}, 3.9139114956508217`*^9, {3.913911538983994*^9, 
   3.9139116439584713`*^9}, {3.9139747868793488`*^9, 3.913974852688738*^9}, 
   3.9139748861417437`*^9, {3.9139753963346977`*^9, 3.913975399921713*^9}, {
   3.9139770899193993`*^9, 3.9139770937990227`*^9}, 3.920633360254353*^9, {
   3.9208040121870747`*^9, 3.9208040129028893`*^9}, {3.923683008063056*^9, 
   3.9236830088976307`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"ff4a715e-abe5-44d8-933d-02eeef04241d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Time-Dependent Prevalence: Increasing/Decreasing Incidence (1% & 2% per Year)\
\
\>", "Section",
 CellChangeTimes->{{3.887314023986989*^9, 3.887314029296854*^9}, {
   3.889714389611265*^9, 3.889714406971233*^9}, {3.889715075827804*^9, 
   3.889715083031666*^9}, {3.889887608902398*^9, 3.889887619431911*^9}, 
   3.890046384476453*^9},ExpressionUUID->"fbeb8a4c-3e11-4d46-9b20-\
15f23a9f2eae"],

Cell[TextData[{
 "Calculate the age-independent prevalence at all times for which there \
exists age-structured population data. To do this, We multiply the the \
prevalence as a function of time and age, ",
 StyleBox["p",
  FontSlant->"Italic"],
 "(",
 StyleBox["t",
  FontSlant->"Italic"],
 ", ",
 StyleBox["a",
  FontSlant->"Italic"],
 "), by the normalised population age-distribution at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "t"], "(", "a", ")"}], TraditionalForm]],ExpressionUUID->
  "84fabf6d-78ba-4651-a8e5-fa5e0798c3d1"],
 ", as per\n\n(6)\t\t\t \t\t\t\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"p", "(", "t", ")"}], "=", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
     RowBox[{
      RowBox[{"p", "(", 
       RowBox[{"t", ",", "a"}], ")"}], 
      RowBox[{
       SubscriptBox["q", "t"], "(", "a", ")"}], 
      RowBox[{"\[DifferentialD]", "a"}]}]}]}], TraditionalForm]],
  InitializationCell->True,ExpressionUUID->
  "8db4be80-a394-4887-ac36-e0b15e6778ca"],
 ".\n\nWe use growth rates on the average incidence of -2%, -1%, 0%, 1%, and \
2% per year to model five different scenarios for the overall prevalence as a \
function of time. These growth rates correspond to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "\[Element]", 
    RowBox[{"{", 
     RowBox[{"0.98", ",", "0.99", ",", "1", ",", "1.01", ",", "1.02"}], 
     "}"}]}], TraditionalForm]],ExpressionUUID->
  "0a556393-2c19-4b97-97e4-6fafd235008e"],
 ".\n\nThe following portions of the notebook will calculate the projected \
prevalence as a function of time for five different incidence growth \
scenarios, compare the zero-growth scenario to available historical \
prevalence data, plot the five different prevalence scenarios, and save the \
data to a file."
}], "Text",
 CellChangeTimes->{{3.887314032517355*^9, 3.887314061514039*^9}, {
   3.8873579752242537`*^9, 3.887357993060452*^9}, {3.887358967060794*^9, 
   3.8873589694125147`*^9}, {3.890046306532206*^9, 3.890046309500472*^9}, {
   3.8900463885023823`*^9, 3.890046395488164*^9}, {3.890047851353046*^9, 
   3.890047901662342*^9}, {3.890047934513542*^9, 3.8900480192022676`*^9}, {
   3.9042278887575502`*^9, 3.904227902100314*^9}, {3.904227984808976*^9, 
   3.904227999907393*^9}, {3.904228041937055*^9, 3.9042280512943983`*^9}, 
   3.9048139006903353`*^9, {3.90862788043968*^9, 3.908627883240693*^9}, {
   3.91391080301082*^9, 3.913910871025497*^9}, {3.913910901306077*^9, 
   3.913910949390726*^9}, {3.913910985652532*^9, 3.913911275597364*^9}, {
   3.913911660523245*^9, 3.913911791182376*^9}, {3.913911959441916*^9, 
   3.9139119604425*^9}, {3.913975068549625*^9, 3.913975068549675*^9}, 
   3.938777815084642*^9},ExpressionUUID->"9f121b8c-4a3f-4e9c-80d1-\
1ca7b3f2483e"],

Cell[CellGroupData[{

Cell["Projected Prevalence Versus Time", "Subsubsection",
 CellChangeTimes->{{3.904228102689445*^9, 3.904228117230076*^9}, 
   3.904813904064292*^9, {3.913911281444809*^9, 3.91391129749647*^9}, {
   3.913911827881501*^9, 
   3.913911844710024*^9}},ExpressionUUID->"e5e3e6d1-7790-4db6-bad8-\
8ea213257423"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"projectionEndEpoch", "=", 
   RowBox[{"projectionEndYear", "-", "projectionStartYear"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"incidenceGrowthRates", "=", 
   RowBox[{"{", 
    RowBox[{"0.98", ",", "0.99", ",", "1.00", ",", "1.01", ",", "1.02"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTsAll", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "<=", 
      RowBox[{"Length", "[", "incidenceGrowthRates", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"growth", "=", 
       RowBox[{
       "incidenceGrowthRates", "\[LeftDoubleBracket]", "j", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Now", ",", "\"\< Growth = \>\"", ",", "growth"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pTs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "projectionStartYear", "<=", "year", "<=", "projectionEndYear"}], 
           ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"year", ",", "5"}], "]"}], "==", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"Now", ",", "\"\<    Year = \>\"", ",", "year"}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"epoch", "=", 
             RowBox[{"year", "-", "projectionStartYear"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"i", " ", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"populationYears", ",", "year"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"p", "=", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"avePrevalences", "[", 
                 RowBox[{"epoch", ",", "a", ",", "growth"}], "]"}], 
                RowBox[{
                "populationInterps", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "0", ",", 
                 RowBox[{"1.2", "populationAgeMax"}]}], "}"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pTs", ",", 
              RowBox[{"{", 
               RowBox[{"year", ",", "p"}], "}"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"year", ",", "populationYears"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"pTsAll", ",", "pTs"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTsInterps", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", 
      RowBox[{"Length", "[", "pTsAll", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"pTsInterps", ",", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"pTsAll", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Now", ",", "\"\< Done\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.887358331130344*^9, 3.887358337545207*^9}, {
   3.8873583726415157`*^9, 3.887358385012588*^9}, {3.887358451025672*^9, 
   3.887358518512269*^9}, 3.8873586547808332`*^9, {3.887358691259654*^9, 
   3.887358960355356*^9}, 3.887359064730361*^9, {3.887367771034425*^9, 
   3.887367774920968*^9}, {3.887367852862728*^9, 3.8873678585087843`*^9}, 
   3.887367968596622*^9, {3.887368088778867*^9, 3.8873682770985823`*^9}, {
   3.887368307638739*^9, 3.887368344648225*^9}, {3.887368525071755*^9, 
   3.88736868321145*^9}, {3.887368733590711*^9, 3.887368775047707*^9}, {
   3.8873688345283422`*^9, 3.887368936743723*^9}, 3.88736898817562*^9, {
   3.8873779497570343`*^9, 3.887377957999837*^9}, {3.887378152797379*^9, 
   3.887378165631863*^9}, {3.887378223481379*^9, 3.887378228271598*^9}, 
   3.887378709887683*^9, {3.887378814491173*^9, 3.887378818764213*^9}, {
   3.887447991370281*^9, 3.887447994338664*^9}, 3.8874487024935093`*^9, 
   3.887454677884726*^9, {3.8874558764081507`*^9, 3.887455879195092*^9}, {
   3.88745597108456*^9, 3.887456009799924*^9}, 3.887456402610628*^9, {
   3.887456445902803*^9, 3.887456487320518*^9}, 3.887456768152205*^9, {
   3.887457371551684*^9, 3.887457373073625*^9}, {3.889629591009309*^9, 
   3.889629592876206*^9}, {3.889636392183509*^9, 3.889636434078546*^9}, {
   3.889696414887166*^9, 3.889696459566949*^9}, {3.88969666427973*^9, 
   3.88969667611032*^9}, {3.8896968012809353`*^9, 3.889696904075815*^9}, {
   3.889696956970392*^9, 3.8896970264297943`*^9}, {3.889697130939476*^9, 
   3.8896974933943567`*^9}, {3.889697569570784*^9, 3.889697633411322*^9}, {
   3.889697711655798*^9, 3.889697778211239*^9}, {3.8896978970710917`*^9, 
   3.8896979128594713`*^9}, {3.889698041569232*^9, 3.8896980621429663`*^9}, {
   3.889698202876075*^9, 3.889698220354082*^9}, {3.8896984808323936`*^9, 
   3.889698487872266*^9}, 3.889698566008771*^9, {3.889698626050446*^9, 
   3.889698652296451*^9}, {3.8896987120068502`*^9, 3.8896987140099783`*^9}, {
   3.8896989490882473`*^9, 3.8896989494978933`*^9}, {3.8896994078262568`*^9, 
   3.8896994411644573`*^9}, {3.889714534004341*^9, 3.889714619609455*^9}, {
   3.889714669190083*^9, 3.889714685488308*^9}, {3.8897147435352077`*^9, 
   3.889714807954927*^9}, {3.889714855169042*^9, 3.889715070848309*^9}, {
   3.8897151072165413`*^9, 3.88971537237267*^9}, {3.889715406750763*^9, 
   3.889715480906598*^9}, {3.889715650074916*^9, 3.8897156504598627`*^9}, {
   3.889715687767106*^9, 3.889715718575659*^9}, {3.889715841466835*^9, 
   3.8897158647325*^9}, {3.889715937686779*^9, 3.889715975186961*^9}, {
   3.889716013950581*^9, 3.889716014019268*^9}, {3.889716044388723*^9, 
   3.8897160536025753`*^9}, {3.8897160875120564`*^9, 3.889716096048971*^9}, {
   3.889716166702798*^9, 3.889716175952538*^9}, {3.8897162120816507`*^9, 
   3.889716343486149*^9}, {3.889716432306909*^9, 3.889716490416991*^9}, {
   3.889716898041285*^9, 3.889717006630774*^9}, {3.889717110963208*^9, 
   3.8897172389748297`*^9}, {3.8897172795274878`*^9, 
   3.8897173437403383`*^9}, {3.889717446935511*^9, 3.889717502813933*^9}, {
   3.889717623431131*^9, 3.889717654358508*^9}, {3.889793383460477*^9, 
   3.889793504589546*^9}, {3.8897935360880413`*^9, 3.8897936157480927`*^9}, {
   3.8898876294497337`*^9, 3.889887827807869*^9}, {3.889887870223185*^9, 
   3.889887909618328*^9}, {3.889887984073073*^9, 3.889888034790812*^9}, {
   3.8898882015144777`*^9, 3.889888219305242*^9}, 3.8899626360331697`*^9, {
   3.889962749343498*^9, 3.8899628016386414`*^9}, {3.889962850083323*^9, 
   3.8899628518568583`*^9}, {3.889962931668974*^9, 3.889962931960195*^9}, {
   3.889963043167191*^9, 3.889963095235859*^9}, {3.8899631493694677`*^9, 
   3.889963156491118*^9}, {3.889963188922072*^9, 3.889963278528323*^9}, {
   3.88996333264443*^9, 3.889963368280046*^9}, {3.889963561123947*^9, 
   3.889963572860587*^9}, {3.889963764428499*^9, 3.8899639063171053`*^9}, {
   3.889963963380328*^9, 3.889963968335417*^9}, {3.8899644112922087`*^9, 
   3.8899644702186403`*^9}, {3.889964547583868*^9, 3.8899646000591173`*^9}, {
   3.8900413423160133`*^9, 3.890041344728033*^9}, {3.8900464054270353`*^9, 
   3.890046445964369*^9}, {3.8900465260971813`*^9, 3.890046529369362*^9}, {
   3.8900477709005423`*^9, 3.890047787552906*^9}, {3.89169561200264*^9, 
   3.891695615183701*^9}, {3.891701527614975*^9, 3.891701527886539*^9}, {
   3.89171525954679*^9, 3.891715260077186*^9}, 3.891872195945499*^9, {
   3.8918723142253933`*^9, 3.8918723142793493`*^9}, {3.891874046818303*^9, 
   3.891874046888736*^9}, 3.891874883180377*^9, {3.901984159750663*^9, 
   3.901984163262694*^9}, 3.902227201480669*^9, 3.902232493372054*^9, {
   3.9028436021961517`*^9, 3.902843604162624*^9}, {3.902843663329508*^9, 
   3.902843719781798*^9}, {3.902844608849036*^9, 3.9028446153671703`*^9}, {
   3.902844649667347*^9, 3.902844691273278*^9}, {3.902844749908826*^9, 
   3.902844756456558*^9}, {3.9028450851633263`*^9, 3.902845135653061*^9}, {
   3.902845828441094*^9, 3.902845875488552*^9}, {3.902846605309565*^9, 
   3.902846639510538*^9}, {3.9028609981108103`*^9, 3.9028610114237432`*^9}, {
   3.902861087465005*^9, 3.902861089736959*^9}, {3.9028611450886173`*^9, 
   3.902861158570857*^9}, 3.902861565072619*^9, {3.902861675159827*^9, 
   3.902861714600607*^9}, {3.9028618749462833`*^9, 3.902861877372401*^9}, {
   3.902861983793544*^9, 3.9028620147748137`*^9}, {3.902862265627429*^9, 
   3.90286231650198*^9}, {3.9028624740983143`*^9, 3.902862482497302*^9}, {
   3.903357239703268*^9, 3.90335725238276*^9}, {3.9033625611253633`*^9, 
   3.903362585901827*^9}, 3.903362829713368*^9, {3.903363491908291*^9, 
   3.903363506346746*^9}, {3.904227692652421*^9, 3.9042277613408937`*^9}, {
   3.904227799347987*^9, 3.9042278567900267`*^9}, 3.904227908043395*^9, {
   3.9042279692575703`*^9, 3.9042279797068977`*^9}, {3.904228071213402*^9, 
   3.9042281010003366`*^9}, {3.904228942890815*^9, 3.904228953916421*^9}, {
   3.9042290133633423`*^9, 3.90422902468547*^9}, {3.904813801971199*^9, 
   3.9048138209914*^9}, {3.904813909450186*^9, 3.904813938487998*^9}, {
   3.904814219474105*^9, 3.9048142434595423`*^9}, {3.9074275233426037`*^9, 
   3.907427565289856*^9}, {3.9074275988001623`*^9, 3.907427626526634*^9}, {
   3.9074276712451267`*^9, 3.907427696748651*^9}, {3.907519572917644*^9, 
   3.90751957319586*^9}, {3.9075197124527397`*^9, 3.907519713579288*^9}, {
   3.9075207289173727`*^9, 3.9075207290631657`*^9}, {3.9076798799546957`*^9, 
   3.907679935196068*^9}, {3.907680056352915*^9, 3.907680068169249*^9}, {
   3.907680761593052*^9, 3.907680765884735*^9}, {3.907682698685651*^9, 
   3.907682703126018*^9}, {3.907683712931714*^9, 3.907683743759967*^9}, {
   3.9076888739323473`*^9, 3.9076888759633007`*^9}, 3.9076890115386353`*^9, {
   3.907689393317401*^9, 3.907689430087563*^9}, {3.907689468819745*^9, 
   3.9076894706428347`*^9}, {3.907760250730901*^9, 3.90776025085268*^9}, {
   3.9077603073314743`*^9, 3.9077603076256857`*^9}, {3.907760354804267*^9, 
   3.907760369869781*^9}, 3.9077604921523867`*^9, {3.90862789921869*^9, 
   3.908627899496377*^9}, {3.908627952759618*^9, 3.908628146776019*^9}, {
   3.908628198770596*^9, 3.908628211075285*^9}, {3.908628264088986*^9, 
   3.908628406364369*^9}, {3.908628453113611*^9, 3.908628480563816*^9}, 
   3.908628523436192*^9, {3.908628575043044*^9, 3.908628575658863*^9}, {
   3.908628618951498*^9, 3.908628628809114*^9}, {3.908632037980591*^9, 
   3.908632041301619*^9}, {3.9086322023603783`*^9, 3.908632202634943*^9}, {
   3.9086334955565243`*^9, 3.908633516888198*^9}, 3.908633572566852*^9, {
   3.908635636440791*^9, 3.908635637965872*^9}, {3.9090652617824097`*^9, 
   3.9090652787444*^9}, {3.909066564195928*^9, 3.909066567819397*^9}, {
   3.913911317965678*^9, 3.913911485930731*^9}, {3.913912169771937*^9, 
   3.913912180195875*^9}, 3.913912531124661*^9, {3.91397489703887*^9, 
   3.91397492602711*^9}, 3.9139917780140877`*^9, {3.9207997394860897`*^9, 
   3.920799752259955*^9}, {3.920801258276257*^9, 3.9208012641400347`*^9}, {
   3.920804170671294*^9, 3.9208041749727383`*^9}, {3.920804545596672*^9, 
   3.920804590821498*^9}, {3.920804632402306*^9, 3.9208046336173143`*^9}, {
   3.9208047119120483`*^9, 3.9208047246997633`*^9}, {3.9208047563278503`*^9, 
   3.920804906257156*^9}, {3.920805182983073*^9, 3.9208051950652103`*^9}, {
   3.920805250418247*^9, 3.9208052523449507`*^9}, {3.920805454809127*^9, 
   3.92080545598738*^9}, {3.920886467312077*^9, 3.920886477197301*^9}, {
   3.920886510841175*^9, 3.920886529412421*^9}, 3.920886579062643*^9, {
   3.9208866147222853`*^9, 3.920886652321651*^9}, {3.920886695116722*^9, 
   3.920886733915365*^9}, {3.920886774230947*^9, 3.920886916543051*^9}, {
   3.920887038203006*^9, 3.920887159448744*^9}, {3.9208872023593893`*^9, 
   3.920887267249817*^9}, {3.920887453585658*^9, 3.920887678917878*^9}, {
   3.9208877170603123`*^9, 3.920887790337964*^9}, {3.920888492639924*^9, 
   3.920888513586689*^9}, {3.920888544595613*^9, 3.920888566397378*^9}, {
   3.9208886272571383`*^9, 3.920888809902721*^9}, {3.9208888413608303`*^9, 
   3.920888879152117*^9}, {3.9208892679211073`*^9, 3.9208893287329493`*^9}, {
   3.92088937087888*^9, 3.920889375603409*^9}, {3.920889451136065*^9, 
   3.9208894512553387`*^9}, {3.920890605682536*^9, 3.920890622804483*^9}, {
   3.920896537702293*^9, 3.920896541426743*^9}, 3.921053624119195*^9, {
   3.923663993095131*^9, 3.923664011748763*^9}, {3.923674034953587*^9, 
   3.923674036202199*^9}, {3.923674589127747*^9, 3.923674594749584*^9}, {
   3.9236746538847322`*^9, 3.923674655357437*^9}, {3.9236818787704268`*^9, 
   3.923681887530403*^9}, {3.928254639083548*^9, 3.928254704194941*^9}, {
   3.9283296332062674`*^9, 3.928329850375524*^9}, {3.9291992520206947`*^9, 
   3.9291992539525757`*^9}, {3.9296261737694263`*^9, 3.929626176917452*^9}, {
   3.929808021028496*^9, 3.929808024377898*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"b6a8e162-346e-4023-95b9-d27e4bfb1ff7"],

Cell["\<\
Save the prevalence projections as a function of age for all incidence growth \
rates and for the years 2023, 2033, and 2043.\
\>", "Text",
 CellChangeTimes->{{3.9283298984044933`*^9, 3.928329925552355*^9}, {
  3.928330239036028*^9, 
  3.928330253024625*^9}},ExpressionUUID->"014b0d2b-3888-4781-858f-\
fadb9eb110dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"projectionDir", "=", 
   RowBox[{
   "rootOutputDir", "<>", "\"\<model_prevalence_vs_age/\>\"", "<>", 
    "subType"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"growthRatePercents", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "incidenceGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "-", "1"}], ")"}], "\[Times]", "100"}],
         ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "incidenceGrowthRates", "]"}]}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Change", " ", "the", " ", "following", " ", "list", " ", "to", " ", 
     "save", " ", "the", " ", "age"}], "-", 
    RowBox[{
    "dependent", " ", "prevalence", " ", "projections", " ", "for", " ", 
     "different", " ", "years"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"saveYears", "=", 
    RowBox[{"{", 
     RowBox[{"2024", ",", "2034", ",", "2043"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "saveYears", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      "-", "projectionStartYear"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "saveYears", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modelAges", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "110"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Age\>\"", ",", "\"\<Prevalence [%]\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "epochs", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "incidenceGrowthRates", "]"}]}], " ", ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"filePath", "=", 
         RowBox[{"projectionDir", "<>", "\"\</\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
           "saveYears", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "]"}], "<>", "\"\</\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
           "growthRatePercents", "\[LeftDoubleBracket]", "j", 
            "\[RightDoubleBracket]"}], "]"}], "<>", 
          "\"\<PctIncidenceGrowth.csv\>\""}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "modelAges", "\[LeftDoubleBracket]", "k", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"avePrevalences", "[", 
               RowBox[{
                RowBox[{
                "epochs", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "modelAges", "\[LeftDoubleBracket]", "k", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "incidenceGrowthRates", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], "]"}], "\[Times]", "100"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"Length", "[", "modelAges", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Prepend", "[", 
          RowBox[{"data", ",", "header"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.928329853707904*^9, 3.928329861494314*^9}, {
  3.9283299396818447`*^9, 3.928330008429851*^9}, {3.928330039178774*^9, 
  3.928330530703196*^9}, {3.928330566889443*^9, 3.928330663259851*^9}, {
  3.928330695322467*^9, 3.928330720075941*^9}, {3.928330755669757*^9, 
  3.928330774151547*^9}, {3.928330810834262*^9, 3.928330811358005*^9}, {
  3.928330851918585*^9, 3.928330853694583*^9}, {3.9283309856354*^9, 
  3.92833100669584*^9}, {3.929199617689273*^9, 3.9291996188806*^9}, {
  3.929434390602803*^9, 3.929434398414*^9}, {3.929626259073558*^9, 
  3.929626270012166*^9}, {3.938777837338654*^9, 
  3.9387778695473633`*^9}},ExpressionUUID->"b1351623-ca0c-441f-acea-\
82291465911e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison to Historical Data", "Subsubsection",
 CellChangeTimes->{{3.913911813415332*^9, 
  3.91391182134643*^9}},ExpressionUUID->"a8a23944-c731-40fa-b766-\
6a56e741f114"],

Cell[TextData[{
 "Now, calculate the historical prevalence from the interpolated prevalence \
data and the population interpolation. This is done instead of using the more \
accurate numerator over denominator approach because it ensures that the \
historical data and projection are calculated in the same way; hence, will be \
continuous at the transition between the final date of the historical \
prevalence data and initial date of the projection. For the data tested, the ",
 StyleBox["relative",
  FontWeight->"Bold"],
 " difference is no more than ",
 StyleBox["\[PlusMinus]",
  FontSize->16],
 "3% (the absolute difference being less than \[PlusMinus]0.05%)."
}], "Text",
 CellChangeTimes->{{3.908632116856941*^9, 3.9086321448137608`*^9}, {
   3.908632364023018*^9, 3.908632365393383*^9}, {3.908632580067493*^9, 
   3.908632596343666*^9}, {3.908635125502268*^9, 3.908635235057509*^9}, {
   3.913911872839671*^9, 3.913911945735744*^9}, {3.913978346602833*^9, 
   3.91397835555825*^9}, 3.938777889483348*^9, {3.938777931987146*^9, 
   3.93877808402387*^9}},ExpressionUUID->"f92edd6a-e5ec-4479-90cf-\
20e9fab188ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"p", ",", "rawPrevs"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rawPrevs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "prevalenceYears", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"popYear", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"populationYears", ",", 
         RowBox[{"prevalenceYears", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "\[LeftDoubleBracket]", 
       "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"popIndex", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"populationYears", ",", "popYear"}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "prevalenceInterps", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], "\[Times]", 
         RowBox[{
         "populationInterps", "\[LeftDoubleBracket]", "popIndex", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"a", ",", "0", ",", 
          RowBox[{"1.2", "populationAgeMax"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"rawPrevs", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "prevalenceYears", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], ",", "p"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.908632180131007*^9, 3.9086321815898314`*^9}, {
   3.90863221511762*^9, 3.9086322404530563`*^9}, {3.908632273878216*^9, 
   3.908632344044526*^9}, {3.908632376149143*^9, 3.908632574518248*^9}, {
   3.908632720580513*^9, 3.90863283851145*^9}, {3.908633113597474*^9, 
   3.908633132506979*^9}, {3.90863316475601*^9, 3.908633206185231*^9}, 
   3.909225581369754*^9, {3.920885701229433*^9, 3.920885726338313*^9}, {
   3.920889512312746*^9, 3.920889623239415*^9}, {3.920889689938281*^9, 
   3.9208896909432163`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"a9725832-e0db-413a-9a88-744f022cddf6"],

Cell["\<\
Plot the historical prevalence time-series and the projection for zero growth \
on the same plot.\
\>", "Text",
 CellChangeTimes->{{3.90863258705354*^9, 3.908632588682941*^9}, {
  3.9139119516998453`*^9, 3.913911953061613*^9}, {3.920926504703579*^9, 
  3.920926505739197*^9}, {3.9292004086693907`*^9, 
  3.929200415929337*^9}},ExpressionUUID->"638380bc-437d-4754-9081-\
b970a2bf9cdb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pHistorical", "=", 
   RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
          "rawPrevs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "rawPrevs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
            "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "\[Times]", "100"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "rawPrevs", "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", "Blue", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Year\>\"", "]"}]}], ",", 
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"LabelStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "->", "18"}], ",", 
        RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pProjected", "=", 
    RowBox[{"Plot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "pTsInterps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "[", "t", "]"}], "\[Times]", "100"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "projectionStartYear", ",", "projectionEndYear"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", "Red", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Frame", "->", "True"}], ",", 
      RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", "\"\<Year\>\"", "]"}]}], ",", 
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"LabelStyle", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontSize", "->", "18"}], ",", 
         RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"pHistorical", ",", "pProjected", ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.908633268880172*^9, 3.908633482494337*^9}, {
   3.9086335659824*^9, 3.9086335799141293`*^9}, {3.908633622524149*^9, 
   3.908633695084247*^9}, {3.9086350328074617`*^9, 3.908635033166244*^9}, 
   3.908635648621697*^9, {3.908883826646866*^9, 3.90888385165561*^9}, 
   3.9089759858389997`*^9, 3.908976206153481*^9, {3.908991624306148*^9, 
   3.908991625833728*^9}, {3.909057315843254*^9, 3.9090573472956963`*^9}, {
   3.909065336435651*^9, 3.9090653455381927`*^9}, {3.909066781259721*^9, 
   3.9090667855623283`*^9}, {3.909067669801709*^9, 3.909067671139093*^9}, 
   3.909067733445451*^9, {3.909218189491235*^9, 3.909218193057178*^9}, {
   3.913911970935047*^9, 3.913912065886003*^9}, {3.913912390386877*^9, 
   3.91391239535994*^9}, {3.913974957365893*^9, 3.913974987188816*^9}, {
   3.9139751921248007`*^9, 3.913975198131693*^9}, {3.9139752546873627`*^9, 
   3.913975270597245*^9}, {3.913975664694065*^9, 3.913975675517796*^9}, {
   3.920801272447133*^9, 3.92080127835323*^9}, 3.920801410682597*^9, 
   3.9208033657763653`*^9, {3.920803877559374*^9, 3.920803877917647*^9}, 
   3.920804181670315*^9, 3.920805262918283*^9, 3.920805462900487*^9, 
   3.920889711691844*^9, {3.921065208027083*^9, 3.921065214033814*^9}, {
   3.921080463696042*^9, 3.921080502828155*^9}, {3.921080541470487*^9, 
   3.921080565304439*^9}, {3.923664027650807*^9, 3.92366403667284*^9}, 
   3.923671380024323*^9, 3.923674026584539*^9, {3.9236744814028673`*^9, 
   3.923674491707178*^9}, {3.9236746358635187`*^9, 3.9236746420455303`*^9}, {
   3.923682212520545*^9, 3.9236822408806353`*^9}, 3.923683020512135*^9, 
   3.923748953377987*^9, {3.928254547586565*^9, 3.9282545517619257`*^9}, 
   3.929626301029831*^9, {3.929626827284721*^9, 3.929626827366824*^9}, {
   3.9298082821649513`*^9, 3.9298082891743507`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"b9340c8b-0ab7-41e9-93de-4884b21e9c2c"],

Cell["\<\
Save the interpolated historical prevalence and projected prevalence. \
\>", "Text",
 CellChangeTimes->{{3.9086356554052677`*^9, 3.908635680951721*^9}, {
  3.91398966394385*^9, 
  3.9139896738092003`*^9}},ExpressionUUID->"22d8a929-1444-4f13-89d4-\
fabec27bd83d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"filePath", "=", 
   RowBox[{
   "rootOutputDir", "<>", "\"\<prevalence/raw_and_model_plots/\>\"", "<>", 
    "subType", "<>", "\"\</PseudoRawPrevalence.csv\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"header", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<Year\>\"", ",", "\"\<Prevalence [%]\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
        "rawPrevs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"100", "\[Times]", 
        RowBox[{
         RowBox[{
         "rawPrevs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "rawPrevs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"data", ",", "header"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filePath", "=", 
    RowBox[{
    "rootOutputDir", "<>", "\"\<prevalence/raw_and_model_plots/\>\"", "<>", 
     "subType", "<>", "\"\</ModelPrevalence.csv\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelPrevYears", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"projectionStartYear", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "projectionEndEpoch"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
       "modelPrevYears", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"100", "\[Times]", 
        RowBox[{
         RowBox[{
         "pTsInterps", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
          "[", 
         RowBox[{
         "modelPrevYears", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "modelPrevYears", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"data", ",", "header"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.9086357942971888`*^9, 3.90863588063594*^9}, {
   3.908635922575111*^9, 3.9086359510800037`*^9}, {3.9086359985682487`*^9, 
   3.908636286402247*^9}, {3.908636345024785*^9, 3.908636422190523*^9}, {
   3.909398246429002*^9, 3.909398256598845*^9}, {3.909399401989696*^9, 
   3.9093994031401787`*^9}, {3.913912148687621*^9, 3.913912155114471*^9}, 
   3.913912195800088*^9, {3.913989548054274*^9, 3.913989561974657*^9}, {
   3.913989621984226*^9, 3.9139896550570383`*^9}, {3.9139915255632753`*^9, 
   3.913991530198606*^9}, {3.920633525074711*^9, 3.920633527769206*^9}, {
   3.9236740193617496`*^9, 3.923674022783697*^9}, {3.923682231007134*^9, 
   3.923682234863002*^9}, 3.9236830273862457`*^9, 3.9237489455760393`*^9, {
   3.928254364350251*^9, 3.928254371290072*^9}, {3.9282545378522387`*^9, 
   3.928254564673847*^9}, 3.929626295518311*^9, {3.9296268354059687`*^9, 
   3.9296268354670362`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"0af02396-70b6-4088-922b-0637e952ae1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Five Growth Scenarios", "Subsubsection",
 CellChangeTimes->{{3.913912125759651*^9, 
  3.913912132014736*^9}},ExpressionUUID->"dd283d07-236d-43b2-a72a-\
0993793bbfc2"],

Cell["Plotting the prevalence as a function of time .", "Text",
 CellChangeTimes->{{3.887368355200468*^9, 3.8873683627683973`*^9}, {
  3.887368396822844*^9, 
  3.8873684012902107`*^9}},ExpressionUUID->"e5f7125a-48bd-4cd9-903e-\
815709ca6aa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tMin", "=", "projectionStartYear"}], ";", 
  RowBox[{"tMax", "=", "projectionEndYear"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colours", "=", 
    RowBox[{"{", 
     RowBox[{
     "Red", ",", "Orange", ",", "Green", ",", "Cyan", ",", "Blue", ",", 
      "Magenta", ",", "Black"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", 
      RowBox[{"Length", "[", "pTsInterps", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"Plot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
            "pTsInterps", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "[", "t", "]"}], "\[Times]", "100"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
            "colours", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             "}"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Frame", "->", "True"}], ",", 
         RowBox[{"ImageSize", "->", "450"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Text", "@", 
             RowBox[{"Style", "[", "\"\<Year\>\"", "]"}]}], ",", 
            RowBox[{"Text", "@", 
             RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"LabelStyle", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontSize", "->", "18"}], ",", 
            RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"plots", ",", "p"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"plots", ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.887374452974875*^9, 3.887374562367646*^9}, {
   3.8873746006258707`*^9, 3.887374631857692*^9}, {3.887374690108712*^9, 
   3.887374733739263*^9}, 3.887374867072234*^9, {3.887376093844734*^9, 
   3.887376124881712*^9}, {3.8873762048711*^9, 3.887376205839898*^9}, {
   3.8873762517931767`*^9, 3.887376288374549*^9}, {3.8873763813531437`*^9, 
   3.88737645968991*^9}, {3.887378179990857*^9, 3.88737819661346*^9}, {
   3.887448554728174*^9, 3.887448585893846*^9}, {3.8874547596698847`*^9, 
   3.887454816203002*^9}, {3.887455806250174*^9, 3.887455807661797*^9}, {
   3.887455839279964*^9, 3.887455839773593*^9}, {3.887455907473192*^9, 
   3.8874559931758337`*^9}, {3.887456826200391*^9, 3.88745682731684*^9}, {
   3.887457384532905*^9, 3.887457386599321*^9}, {3.8874578447932587`*^9, 
   3.887457867448543*^9}, {3.8874634824477253`*^9, 3.887463491262924*^9}, {
   3.88746377268329*^9, 3.88746381399576*^9}, {3.887467684979083*^9, 
   3.887467741330337*^9}, 3.8896296478210382`*^9, {3.889629749394525*^9, 
   3.8896297496517982`*^9}, {3.8896364457660913`*^9, 
   3.8896364715695457`*^9}, {3.889636607680511*^9, 3.889636609590137*^9}, 
   3.889696308698206*^9, {3.889698124962833*^9, 3.8896981958526773`*^9}, {
   3.889698233633511*^9, 3.8896984235146837`*^9}, {3.889698456933632*^9, 
   3.889698457401669*^9}, {3.889698579462387*^9, 3.889698580747445*^9}, {
   3.8896989696625338`*^9, 3.889699027895309*^9}, {3.8896994540026503`*^9, 
   3.889699562673903*^9}, {3.889706388792384*^9, 3.889706433394278*^9}, 
   3.889711002558743*^9, {3.889711046041235*^9, 3.8897110770028553`*^9}, {
   3.889711234220108*^9, 3.8897112416353273`*^9}, {3.88972111092614*^9, 
   3.889721119680956*^9}, {3.889721156101473*^9, 3.889721246107099*^9}, {
   3.889971171544331*^9, 3.88997126512181*^9}, 3.889982121315189*^9, {
   3.889982402496166*^9, 3.889982406573202*^9}, {3.890040867243126*^9, 
   3.890040884228114*^9}, {3.890040972498436*^9, 3.8900410118488398`*^9}, {
   3.890047803294045*^9, 3.890047813665574*^9}, {3.890048427637945*^9, 
   3.8900484314231853`*^9}, {3.890048478017223*^9, 3.89004857858596*^9}, {
   3.890048626943212*^9, 3.890048978795967*^9}, {3.890049023034871*^9, 
   3.890049075647849*^9}, {3.8900491216981077`*^9, 3.890049167426456*^9}, {
   3.890049211873114*^9, 3.8900492539055433`*^9}, {3.890049286463825*^9, 
   3.890049598799461*^9}, {3.890049630165312*^9, 3.890049640492362*^9}, {
   3.890150561364359*^9, 3.890150573329927*^9}, {3.890150636895007*^9, 
   3.890150760138061*^9}, {3.890150792346743*^9, 3.890150825934215*^9}, {
   3.8901510249377193`*^9, 3.8901510364145517`*^9}, {3.891695450482256*^9, 
   3.8916954628337107`*^9}, {3.8916955549254837`*^9, 3.8916955589687147`*^9}, 
   3.891715799169314*^9, 3.891717115537243*^9, {3.891724271544545*^9, 
   3.891724278712068*^9}, {3.8917680121685534`*^9, 3.891768111233151*^9}, {
   3.8917683177452593`*^9, 3.891768319691512*^9}, {3.89176997609365*^9, 
   3.891769995435429*^9}, {3.89187229716068*^9, 3.891872299668139*^9}, {
   3.891876538899431*^9, 3.891876575506998*^9}, {3.901995401582546*^9, 
   3.901995426017569*^9}, {3.902239738198676*^9, 3.90223974063979*^9}, 
   3.902661663139304*^9, {3.904813954740231*^9, 3.904813983265707*^9}, {
   3.907427759294765*^9, 3.907427759397965*^9}, {3.90742803118791*^9, 
   3.907428069690436*^9}, {3.9075196100921097`*^9, 3.907519610203309*^9}, {
   3.907519796386849*^9, 3.9075198332986917`*^9}, {3.907519882496023*^9, 
   3.907519918158222*^9}, {3.907520343638885*^9, 3.907520359594043*^9}, {
   3.907520653240817*^9, 3.9075206847115726`*^9}, {3.907521507282125*^9, 
   3.907521515470427*^9}, {3.90767991812568*^9, 3.907679943294935*^9}, {
   3.90768007583808*^9, 3.907680078348075*^9}, {3.90768949505753*^9, 
   3.9076894951517067`*^9}, {3.9076896709015007`*^9, 3.907689694417838*^9}, {
   3.908632066081115*^9, 3.90863207917096*^9}, {3.908636460502508*^9, 
   3.908636472957348*^9}, 3.9089761562823877`*^9, {3.908976224255102*^9, 
   3.908976233466618*^9}, {3.908989061609633*^9, 3.908989067662367*^9}, 
   3.908990676009939*^9, 3.90899132317826*^9, {3.908991650667096*^9, 
   3.9089917954508038`*^9}, {3.908991982934723*^9, 3.908991994615086*^9}, 
   3.908992271797966*^9, 3.908993310624174*^9, 3.9090676568533688`*^9, {
   3.909220410884984*^9, 3.909220422353303*^9}, {3.9092270018888807`*^9, 
   3.909227003820945*^9}, {3.9139122155891867`*^9, 3.9139123841548357`*^9}, {
   3.913912418898278*^9, 3.9139124390537777`*^9}, {3.913975500077683*^9, 
   3.913975519932617*^9}, {3.913975776345374*^9, 3.9139758205012913`*^9}, {
   3.920799791964275*^9, 3.920799792307743*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"56ff3fa0-94e4-4f75-bfbf-ca841e9c369c"],

Cell["\<\
Save the five prevalence scenarios as a function of time, separately and \
together in a single file.\
\>", "Text",
 CellChangeTimes->{
  3.891713721280713*^9, 3.8917159428978767`*^9, {3.891774757295362*^9, 
   3.891774791809289*^9}, {3.913912470419383*^9, 3.9139124797541656`*^9}, {
   3.9139762824778137`*^9, 
   3.9139762902052517`*^9}},ExpressionUUID->"3d667c12-9b6c-4fd1-bf78-\
bc9f29a2c94c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"csvTimes", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"projectionStartYear", "+", "i"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "projectionEndEpoch"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"growthRatePercents", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "incidenceGrowthRates", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "-", "1"}], ")"}], "\[Times]", "100"}],
         ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "incidenceGrowthRates", "]"}]}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Individual", " ", "prevalence", " ", "curves"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", 
     RowBox[{"Length", "[", "pTsInterps", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filePath", "=", 
      RowBox[{
      "rootOutputDir", "<>", "\"\<prevalence/full_incidence/\>\"", "<>", 
       "subType", "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
        "growthRatePercents", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "]"}], "<>", 
       "\"\<PctIncidenceGrowth.csv\>\""}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"header", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<Year\>\"", ",", "\"\<Prevalence [%]\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "csvTimes", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"100", "\[Times]", 
           RowBox[{
            RowBox[{
            "pTsInterps", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "[", 
            RowBox[{
            "csvTimes", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "]"}]}]}], "\[IndentingNewLine]", 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "csvTimes", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{"data", ",", "header"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filePath", "=", 
    RowBox[{
    "rootOutputDir", "<>", "\"\<prevalence/full_incidence/\>\"", "<>", 
     "subType", "<>", "\"\</AllGrowthRates.csv\>\""}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "All", " ", "prevalence", " ", "data", " ", "in", " ", "one", " ", 
    "file"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\"\<Prevalence [%]: \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{
       "growthRatePercents", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], "]"}], "<>", 
      "\"\<% Incidence Growth per Year\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "growthRatePercents", "]"}]}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{"header", ",", "\"\<Year\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "csvTimes", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"100", "\[Times]", 
           RowBox[{
            RowBox[{
            "pTsInterps", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}], "[", 
            RowBox[{
            "csvTimes", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "growthRatePercents", "]"}]}], "}"}]}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "csvTimes", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"data", ",", "header"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.891713601430751*^9, 3.891713618852212*^9}, {
   3.89171368117647*^9, 3.891713768263701*^9}, {3.891713818947914*^9, 
   3.8917139356253843`*^9}, {3.891714209498476*^9, 3.891714294702354*^9}, {
   3.8917143419814987`*^9, 3.891714515989423*^9}, {3.891714676947504*^9, 
   3.891714757353074*^9}, {3.8917147930204353`*^9, 3.891714844458756*^9}, {
   3.8917148906981897`*^9, 3.891714968361058*^9}, {3.891715088466803*^9, 
   3.891715097522706*^9}, {3.8917158164500217`*^9, 3.891715845632351*^9}, {
   3.8917683839662733`*^9, 3.891768387982761*^9}, {3.8917747667616463`*^9, 
   3.891774957472804*^9}, {3.891888730308518*^9, 3.891888825519601*^9}, {
   3.902220177824374*^9, 3.902220193888143*^9}, {3.902220262656171*^9, 
   3.902220265671555*^9}, {3.90481399638544*^9, 3.904813999556518*^9}, 
   3.9082854099023647`*^9, 3.908883102740444*^9, {3.9139124490253572`*^9, 
   3.91391245131774*^9}, {3.9139750163042393`*^9, 3.913975018035973*^9}, {
   3.913975689922151*^9, 3.9139756905969543`*^9}, {3.91397572536097*^9, 
   3.913975759276011*^9}, {3.913975829515047*^9, 3.913975849582562*^9}, {
   3.913975934990755*^9, 3.913976085593789*^9}, {3.913976138367371*^9, 
   3.9139761536211777`*^9}, {3.9139761924811077`*^9, 3.913976244269339*^9}, {
   3.9139784169667177`*^9, 3.9139784213293*^9}, {3.91398969416663*^9, 
   3.9139897183988037`*^9}, {3.9139900032313013`*^9, 
   3.9139900155981913`*^9}, {3.9139915394914093`*^9, 
   3.9139915511910133`*^9}, {3.9282543973914757`*^9, 3.9282544107785482`*^9}},
 
 CellLabel->
  "In[113]:=",ExpressionUUID->"6e197265-86f4-497a-bc2d-a7a6c1592001"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Age-Dependent Prevalence: Comparing the Model to Reality", "Section",
 CellChangeTimes->{{3.887314023986989*^9, 3.887314029296854*^9}, {
   3.889714389611265*^9, 3.889714406971233*^9}, {3.889715075827804*^9, 
   3.889715083031666*^9}, {3.889887608902398*^9, 3.889887619431911*^9}, 
   3.890046384476453*^9, {3.8917670920931053`*^9, 3.891767118316515*^9}, {
   3.902242559768258*^9, 3.902242561398855*^9}, 
   3.9088820090752773`*^9},ExpressionUUID->"e8ecc4a9-291c-46d7-93ad-\
80d2683ba3d8"],

Cell["\<\
To check the effect of neglecting the mortality and migration terms on the \
accuracy of our model, this section will calculate the age-independent \
prevalence at the model start date and compare it to the actual age-dependent \
prevalence. The model will start at the earliest date for which we have \
prevalence data and will be advanced to the last year for which we have \
prevalence data, using the average incidence data from a specific period that \
falls within these two date bounds. \
\>", "Text",
 CellChangeTimes->{{3.887314032517355*^9, 3.887314061514039*^9}, {
  3.8873579752242537`*^9, 3.887357993060452*^9}, {3.887358967060794*^9, 
  3.8873589694125147`*^9}, {3.890046306532206*^9, 3.890046309500472*^9}, {
  3.8900463885023823`*^9, 3.890046395488164*^9}, {3.890047851353046*^9, 
  3.890047901662342*^9}, {3.890047934513542*^9, 3.8900480192022676`*^9}, {
  3.891767129003188*^9, 3.89176716007593*^9}, {3.891767195435368*^9, 
  3.8917673651755247`*^9}, {3.891767576486353*^9, 3.891767604307404*^9}, {
  3.908882063687623*^9, 3.908882210748048*^9}, {3.913912582160453*^9, 
  3.913912588972929*^9}, {3.9139763073408213`*^9, 
  3.913976319668779*^9}},ExpressionUUID->"c86db1ce-675f-4cd9-a39d-\
ccfe3a1e68da"],

Cell[TextData[{
 "As before, the calculation is broken up into three parts, in order to \
properly determine the bounds of the piecewise continuous functions involved, \
and to provide a solution to the prevalence where ",
 StyleBox["a",
  FontSlant->"Italic"],
 " = ",
 StyleBox["t",
  FontSlant->"Italic"],
 ". We remove the growth term, as it is not required."
}], "Text",
 CellChangeTimes->{{3.8872875545089293`*^9, 3.887287601285473*^9}, {
   3.887298935926903*^9, 3.887298967482923*^9}, 3.887299002325294*^9, {
   3.887299147542891*^9, 3.887299158522037*^9}, {3.887358554520084*^9, 
   3.887358594706077*^9}, {3.890043739942271*^9, 3.890043764783267*^9}, {
   3.913899636606886*^9, 3.9138996424189177`*^9}, {3.913903703700513*^9, 
   3.9139037078890553`*^9}, {3.9139039445091963`*^9, 3.913904024003437*^9}, {
   3.913907199622168*^9, 3.913907397552828*^9}, {3.9139086404056*^9, 
   3.9139088063430843`*^9}, {3.9139769371196613`*^9, 3.913977032207535*^9}, {
   3.938778214367622*^9, 
   3.938778243365497*^9}},ExpressionUUID->"9ee94525-5e1e-4bf6-bf53-\
0ad5e2c1c21f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "=", 
    RowBox[{"1.0", "\[Times]", 
     SuperscriptBox["10", 
      RowBox[{"-", "10"}]]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Time", " ", "range", " ", "for", " ", "the", " ", "prevalance", " ", "as",
     " ", "a", " ", "function", " ", "of", " ", "age", " ", "and", " ", 
    "time"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"beginYear", "=", "0"}], ";", 
   RowBox[{"endYear", "=", "120"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "p0", ",", "integral1", ",", "integral2", ",", "modelPrevalence"}], "]"}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "earliest", " ", "prevalence", " ", "data", " ", "set", " ", 
    "is", " ", "the", " ", "initial", " ", "condition", " ", "for", " ", 
    "the", " ", "model"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"p0", "[", 
     RowBox[{"t_", ",", "a_"}], "]"}], "=", 
    RowBox[{
    "prevalenceInterps", "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"integral1", "[", 
    RowBox[{"a_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"aveIncidenceInterp", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "a"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"integral2", "[", 
     RowBox[{
      RowBox[{"t_", "?", "NumericQ"}], ",", 
      RowBox[{"a_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"aveIncidenceInterp", "[", 
       RowBox[{"x", "+", "a", "-", "t"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "t"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Terms", " ", "containing", " ", "\[Epsilon]", " ", "are", " ", "for", 
     " ", "the", " ", "case", " ", "where", " ", 
     StyleBox["a",
      FontSlant->"Italic"]}], "=", 
    StyleBox["t",
     FontSlant->"Italic"]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modelPrevalence", "[", 
    RowBox[{"t_", ",", "a_"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"p0", "[", 
             RowBox[{
              RowBox[{"t", "-", "a"}], ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"integral1", "[", "a", "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "<=", "a", "<", "t"}], "&&", 
         RowBox[{"beginYear", "<=", "t", "<=", "endYear"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p0", "[", 
                RowBox[{
                 RowBox[{"t", "-", "a", "+", 
                  RowBox[{"2", "\[Epsilon]"}]}], ",", "0"}], "]"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"integral1", "[", 
                RowBox[{"a", "-", "\[Epsilon]"}], "]"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"p0", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"a", "-", "t", "+", 
                  RowBox[{"2", "\[Epsilon]"}]}]}], "]"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"integral2", "[", 
                RowBox[{
                 RowBox[{"t", "-", "\[Epsilon]"}], ",", 
                 RowBox[{"a", "+", "\[Epsilon]"}]}], "]"}]}], "]"}]}]}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"t", "==", "a"}], "&&", 
         RowBox[{"beginYear", "<=", "t", "<=", "endYear"}], "&&", 
         RowBox[{"a", ">", "\[Epsilon]"}], "&&", 
         RowBox[{"t", ">", "\[Epsilon]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"p0", "[", 
             RowBox[{"0", ",", 
              RowBox[{"a", "-", "t"}]}], "]"}]}], ")"}], 
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"integral2", "[", 
             RowBox[{"t", ",", "a"}], "]"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"0", "<=", "t", "<", "a"}], "&&", 
         RowBox[{"beginYear", "<=", "t", "<=", "endYear"}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.887299259850396*^9, 3.887299321044408*^9}, {
   3.887299423879355*^9, 3.887299657959144*^9}, {3.88730155093342*^9, 
   3.88730157971056*^9}, {3.8873111278178368`*^9, 3.887311325394731*^9}, {
   3.88731135597333*^9, 3.887311377304256*^9}, {3.887311413415682*^9, 
   3.887311477652627*^9}, {3.8873115367215014`*^9, 3.887311623995984*^9}, {
   3.887312703537251*^9, 3.887312939728744*^9}, {3.887312987754027*^9, 
   3.887313088329582*^9}, {3.887313134254386*^9, 3.887313241040443*^9}, {
   3.887313399148994*^9, 3.88731340065007*^9}, {3.887313471935905*^9, 
   3.887313474771649*^9}, {3.8873135440231457`*^9, 3.887313649458856*^9}, 
   3.887313917231102*^9, {3.887313973121331*^9, 3.8873139754132433`*^9}, 
   3.887358444054453*^9, {3.887359356517378*^9, 3.8873593877408*^9}, {
   3.887360593691155*^9, 3.88736069627044*^9}, {3.887367713708445*^9, 
   3.887367740728696*^9}, {3.8873781149336233`*^9, 3.887378143903512*^9}, {
   3.887378575970633*^9, 3.88737864103098*^9}, {3.88737879698736*^9, 
   3.887378805716061*^9}, {3.887448287607134*^9, 3.887448309105535*^9}, {
   3.887448371959199*^9, 3.8874484087947693`*^9}, 3.8874484687334948`*^9, {
   3.887448505176359*^9, 3.887448513702545*^9}, {3.887448610593742*^9, 
   3.8874486189557953`*^9}, {3.887454626737575*^9, 3.887454656853447*^9}, {
   3.887456045653953*^9, 3.887456073045829*^9}, {3.887456733230859*^9, 
   3.8874567527750387`*^9}, {3.887457177256776*^9, 3.887457239949696*^9}, {
   3.887457297911943*^9, 3.887457319273514*^9}, {3.8874574230366488`*^9, 
   3.887457453184984*^9}, {3.887457496565194*^9, 3.8874577465530567`*^9}, {
   3.887458247773571*^9, 3.887458264709344*^9}, {3.887460639464182*^9, 
   3.887460928341406*^9}, 3.887463454729433*^9, {3.8896137486070433`*^9, 
   3.889613757487714*^9}, {3.889613822854261*^9, 3.889613852519085*^9}, {
   3.889613927828888*^9, 3.8896139309714527`*^9}, {3.8896140279229603`*^9, 
   3.8896140334383783`*^9}, {3.889614067272966*^9, 3.8896140686969557`*^9}, {
   3.889636176428335*^9, 3.889636347240491*^9}, 3.88969649946637*^9, {
   3.8900412884460783`*^9, 3.8900413027751904`*^9}, {3.890041351014533*^9, 
   3.890041385645314*^9}, {3.8900437808533287`*^9, 3.890043874475263*^9}, {
   3.890043904853778*^9, 3.890043950930476*^9}, {3.890044018477137*^9, 
   3.890044055816175*^9}, {3.8900441392101803`*^9, 3.89004416279226*^9}, {
   3.890044207208314*^9, 3.8900442330820227`*^9}, {3.8900443755106487`*^9, 
   3.890044411283821*^9}, {3.890044564912367*^9, 3.890044690081077*^9}, {
   3.890044725838007*^9, 3.890044810883185*^9}, {3.89004493856922*^9, 
   3.890044953416696*^9}, 3.890045140751519*^9, {3.890045722444385*^9, 
   3.89004572957479*^9}, {3.890045899050664*^9, 3.8900459183712482`*^9}, 
   3.890144093447811*^9, {3.89169930748493*^9, 3.891699332581985*^9}, {
   3.891715770041286*^9, 3.891715770882168*^9}, 3.891716006148477*^9, {
   3.891717157218131*^9, 3.891717157959049*^9}, 3.891717524917293*^9, 
   3.8917244161849613`*^9, {3.891766566591785*^9, 3.891766567155415*^9}, 
   3.89176832690711*^9, {3.891873958018857*^9, 3.891874023706607*^9}, {
   3.891874671521791*^9, 3.8918747181609983`*^9}, {3.8918747484026527`*^9, 
   3.891874849956655*^9}, 3.901984145443907*^9, {3.902230937575272*^9, 
   3.902230997514206*^9}, {3.9048137618238297`*^9, 3.904813762681533*^9}, {
   3.907427477048242*^9, 3.907427484690288*^9}, 3.907679860670315*^9, {
   3.9086278312348824`*^9, 3.908627858017268*^9}, {3.908881835244544*^9, 
   3.9088818352955713`*^9}, 3.908991298764533*^9, {3.913910702348362*^9, 
   3.913910761320826*^9}, 3.9139114956508217`*^9, {3.913911538983994*^9, 
   3.9139116439584713`*^9}, {3.9139747868793488`*^9, 3.913974852688738*^9}, 
   3.9139748861417437`*^9, {3.9139753963346977`*^9, 3.913975399921713*^9}, {
   3.913977041882327*^9, 3.913977250186741*^9}, {3.913977322673087*^9, 
   3.9139774232793207`*^9}, {3.913977601658992*^9, 3.913977632982275*^9}, {
   3.913978432715642*^9, 3.913978435280348*^9}, {3.929808038545875*^9, 
   3.9298080402232447`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"6cbe6514-08e5-486d-b9d5-4e5745add00e"],

Cell[TextData[{
 "Plotting the interpolated data and the model data at the last date for \
which we have prevalence data.\n\n",
 StyleBox["Note",
  FontWeight->"Bold"],
 ". When the ",
 StyleBox["NIntegrate",
  FontSlant->"Italic"],
 " error occurs, it is due to the prevalence at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "9161b15c-e28d-4b3e-8607-3ad9e51bfbf7"],
 " always being zero and can be safely ignored."
}], "Text",
 CellChangeTimes->{{3.891768440005138*^9, 3.891768461446211*^9}, {
  3.908882269877451*^9, 3.908882286695714*^9}, {3.9139767019200478`*^9, 
  3.913976762065152*^9}, {3.913978459467021*^9, 3.913978503496538*^9}, {
  3.938778146920176*^9, 
  3.938778160175782*^9}},ExpressionUUID->"85a7377e-8aa1-4241-976d-\
3f0b6bb392cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"modelStartYear", "=", 
   RowBox[{
   "prevalenceYears", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelEndYear", "=", 
   RowBox[{"prevalenceYears", "\[LeftDoubleBracket]", 
    RowBox[{"Length", "[", "prevalenceYears", "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"modelEndTime", "=", 
    RowBox[{"modelEndYear", "-", "modelStartYear"}]}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"startIdx", "=", "1"}], ";", 
  RowBox[{"endIdx", "=", 
   RowBox[{"Length", "[", "prevalenceYears", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"modelGrowthRate", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"Plot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
        "prevalenceInterps", "\[LeftDoubleBracket]", "startIdx", 
         "\[RightDoubleBracket]"}], "\[Times]", "100"}], ",", 
       RowBox[{
        RowBox[{
        "prevalenceInterps", "\[LeftDoubleBracket]", "endIdx", 
         "\[RightDoubleBracket]"}], "\[Times]", "100"}], ",", 
       RowBox[{
        RowBox[{"modelPrevalence", "[", 
         RowBox[{"modelEndTime", ",", "a"}], "]"}], "\[Times]", "100"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "100"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "Red", "}"}], ",", 
        RowBox[{"{", "Green", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", "Dashed"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "->", "450"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"LabelStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "->", "18"}], ",", 
        RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "prevalences", "\[LeftDoubleBracket]", "endIdx", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "prevalences", "\[LeftDoubleBracket]", "endIdx", 
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "\[Times]", "100"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{
          "prevalences", "\[LeftDoubleBracket]", "endIdx", 
           "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotStyle", "->", 
      RowBox[{"{", 
       RowBox[{"Green", ",", 
        RowBox[{"PointSize", "[", "0.02", "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "->", "450"}], ",", 
     RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
        RowBox[{"Text", "@", 
         RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"LabelStyle", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontSize", "->", "18"}], ",", 
        RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p3", "=", 
    RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"prevalences", "[", 
             RowBox[{"[", "endIdx", "]"}], "]"}], "\[LeftDoubleBracket]", "i",
             "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"modelPrevalence", "[", 
            RowBox[{"modelEndTime", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"prevalences", "[", 
                RowBox[{"[", "endIdx", "]"}], "]"}], "\[LeftDoubleBracket]", 
               "i", "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "]"}], "\[Times]", "100"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{
           "prevalences", "\[LeftDoubleBracket]", "endIdx", 
            "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"PointSize", "[", "0.02", "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "->", "450"}], ",", 
      RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", "\"\<Age [Years]\>\"", "]"}]}], ",", 
         RowBox[{"Text", "@", 
          RowBox[{"Style", "[", "\"\<Prevalence [%]\>\"", "]"}]}]}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"LabelStyle", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontSize", "->", "18"}], ",", 
         RowBox[{"FontFamily", "->", "\"\<Times\>\""}], ",", "Black"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8917686352596817`*^9, 3.891768725336357*^9}, {
   3.8917688498308163`*^9, 3.891768875243235*^9}, {3.891768910671853*^9, 
   3.8917689452854548`*^9}, 3.891768975681869*^9, {3.891771500445554*^9, 
   3.891771511931747*^9}, {3.891771583396261*^9, 3.8917715857701483`*^9}, {
   3.891771793728704*^9, 3.891771835233*^9}, {3.891771975985668*^9, 
   3.891772056255025*^9}, {3.8917725632305183`*^9, 3.891772573160617*^9}, {
   3.891773018722084*^9, 3.891773056768791*^9}, {3.891774260558276*^9, 
   3.891774273137492*^9}, {3.891786467472865*^9, 3.8917865299018793`*^9}, 
   3.891786591777607*^9, {3.891786654650331*^9, 3.891786821316792*^9}, {
   3.8917868827280912`*^9, 3.891786992672099*^9}, {3.891787038390193*^9, 
   3.891787046502087*^9}, {3.891787098309785*^9, 3.891787143191169*^9}, 
   3.8917873671133204`*^9, {3.891790677107821*^9, 3.891790715774876*^9}, {
   3.891790763078807*^9, 3.891790787167368*^9}, {3.908882592520442*^9, 
   3.908882633438264*^9}, {3.908989135976734*^9, 3.908989137337154*^9}, {
   3.90899072534542*^9, 3.908990802112897*^9}, 3.9089908438718576`*^9, {
   3.908991818178389*^9, 3.9089918254006*^9}, 3.908993322210147*^9, {
   3.909064920567396*^9, 3.909064922151928*^9}, 3.909065003538334*^9, {
   3.913973012186681*^9, 3.9139732222634*^9}, {3.913973257634941*^9, 
   3.91397328940275*^9}, {3.913973334341692*^9, 3.913973346532908*^9}, {
   3.9139763586928062`*^9, 3.91397640992166*^9}, {3.913976545259842*^9, 
   3.913976567584784*^9}, {3.913976653913273*^9, 3.913976685412384*^9}, {
   3.913977281980592*^9, 3.913977289201236*^9}, {3.913977585756501*^9, 
   3.913977606092428*^9}, {3.913977639281754*^9, 3.9139776508862867`*^9}, {
   3.9139922541243963`*^9, 3.913992257804694*^9}, 3.929808043089926*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"97b4b12b-f4f0-4027-9973-ba277b699133"],

Cell["\<\
The integrated prevalence for the data and model, using the population data \
set for the last date for which we have prevalence data.\
\>", "Text",
 CellChangeTimes->{{3.89178996846351*^9, 3.8917899982373037`*^9}, {
  3.9088900874914*^9, 
  3.908890102522457*^9}},ExpressionUUID->"e7495a45-671f-42b3-9089-\
4e7d3fc73c75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"populationAgeMax", "=", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "populations", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
         "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "populations", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"populations", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"1", "/", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"populationInterps", "[", 
       RowBox[{"[", "endIdx", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", "populationAgeMax"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"popInterp", "[", "a_", "]"}], "=", 
    RowBox[{"norm", "\[Times]", 
     RowBox[{
     "populationInterps", "\[LeftDoubleBracket]", "endIdx", 
      "\[RightDoubleBracket]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pModel", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"modelPrevalence", "[", 
       RowBox[{"modelEndTime", ",", "a"}], "]"}], 
      RowBox[{"popInterp", "[", "a", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "populationAgeMax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Model prevalence \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{
     "prevalenceYears", "\[LeftDoubleBracket]", "endIdx", 
      "\[RightDoubleBracket]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
    RowBox[{"ToString", "[", 
     RowBox[{"pModel", "\[Times]", "100"}], "]"}], "<>", "\"\<%\>\""}], "]"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pData", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "prevalenceInterps", "\[LeftDoubleBracket]", "endIdx", 
       "\[RightDoubleBracket]"}], "\[Times]", 
      RowBox[{"popInterp", "[", "a", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "0", ",", "populationAgeMax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Data prevalence in \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{
    "prevalenceYears", "\[LeftDoubleBracket]", "endIdx", 
     "\[RightDoubleBracket]"}], "]"}], "<>", "\"\< = \>\"", "<>", 
   RowBox[{"ToString", "[", 
    RowBox[{"pData", "\[Times]", "100"}], "]"}], "<>", "\"\<%\>\""}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.891790018319532*^9, 3.8917900590325317`*^9}, {
   3.891790112528818*^9, 3.891790137581736*^9}, 3.891790224107328*^9, {
   3.891790261691475*^9, 3.8917903291374903`*^9}, {3.8917907372610483`*^9, 
   3.891790756932172*^9}, {3.8917908077408733`*^9, 3.8917908166218853`*^9}, 
   3.8917908608072577`*^9, {3.891791030049074*^9, 3.891791057915362*^9}, {
   3.891791229782816*^9, 3.8917912640855417`*^9}, {3.89179151027177*^9, 
   3.891791531524859*^9}, {3.891791570872099*^9, 3.891791598171142*^9}, {
   3.908882648242013*^9, 3.908882747138358*^9}, {3.90888292832201*^9, 
   3.908882967618146*^9}, {3.908883003040656*^9, 3.908883015976323*^9}, {
   3.908883158426091*^9, 3.9088831588052893`*^9}, {3.90906493100272*^9, 
   3.909064933830529*^9}, {3.9139734937264967`*^9, 3.913973581221056*^9}, {
   3.913977470213644*^9, 3.913977494985776*^9}, {3.913977546328923*^9, 
   3.913977561843647*^9}, {3.91397765709829*^9, 3.913977660392714*^9}, {
   3.9139777928855352`*^9, 3.913977798906386*^9}, {3.929436071662314*^9, 
   3.929436114710216*^9}, {3.929436388056872*^9, 3.929436389982111*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"30ec953c-81e8-4898-b6ee-f9824e0ab43d"],

Cell["Save the prevalence data as a function of time.", "Text",
 CellChangeTimes->{
  3.891713721280713*^9, 3.8917159428978767`*^9, {3.891774153540851*^9, 
   3.891774156529948*^9}},ExpressionUUID->"96255731-43ed-4524-aacd-\
e91d873c5470"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"filePath", "=", 
    RowBox[{"rootOutputDir", "<>", "\"\<prevalence/model_data_\>\"", "<>", 
     RowBox[{"ToString", "[", "modelEndYear", "]"}], "<>", 
     "\"\<_comparison/\>\"", "<>", "subType", "<>", 
     "\"\</PrevalencesCompared.csv\>\""}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"csvAges", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "populationAgeMax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Age [Years]\>\"", ",", 
     RowBox[{
      RowBox[{"ToString", "[", "modelStartYear", "]"}], "<>", 
      "\"\< Data Prevalence [%]\>\""}], ",", 
     RowBox[{
      RowBox[{"ToString", "[", "modelEndYear", "]"}], "<>", 
      "\"\< Data Prevalence [%]\>\""}], ",", 
     RowBox[{
      RowBox[{"ToString", "[", "modelEndYear", "]"}], "<>", 
      "\"\< Model Prevalence [%]\>\""}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "csvAges", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"100", "\[Times]", 
         RowBox[{
         "prevalenceInterps", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], "/.", 
        RowBox[{"a", "->", 
         RowBox[{
         "csvAges", "\[LeftDoubleBracket]", "j", 
          "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"100", "\[Times]", 
         RowBox[{
         "prevalenceInterps", "\[LeftDoubleBracket]", "endIdx", 
          "\[RightDoubleBracket]"}]}], "/.", 
        RowBox[{"a", "->", 
         RowBox[{
         "csvAges", "\[LeftDoubleBracket]", "j", 
          "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"100", "\[Times]", 
        RowBox[{"modelPrevalence", "[", 
         RowBox[{"modelEndTime", ",", 
          RowBox[{
          "csvAges", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}],
          "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "csvAges", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"data", ",", "header"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"filePath", ",", "data", ",", "\"\<CSV\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Saving to: \>\"", "<>", "filePath"}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.891713601430751*^9, 3.891713618852212*^9}, {
   3.89171368117647*^9, 3.891713768263701*^9}, {3.891713818947914*^9, 
   3.8917139356253843`*^9}, {3.891714209498476*^9, 3.891714294702354*^9}, {
   3.8917143419814987`*^9, 3.891714515989423*^9}, {3.891714676947504*^9, 
   3.891714757353074*^9}, {3.8917147930204353`*^9, 3.891714844458756*^9}, {
   3.8917148906981897`*^9, 3.891714968361058*^9}, {3.891715088466803*^9, 
   3.891715097522706*^9}, {3.8917158164500217`*^9, 3.891715845632351*^9}, {
   3.8917683839662733`*^9, 3.891768387982761*^9}, {3.8917742204778357`*^9, 
   3.891774229984682*^9}, {3.891774283327365*^9, 3.891774483606463*^9}, {
   3.891775103209073*^9, 3.8917751053522882`*^9}, {3.8918882860467033`*^9, 
   3.891888342527273*^9}, {3.891888556295498*^9, 3.891888556830885*^9}, 
   3.9025764259912853`*^9, 3.908882306899338*^9, {3.908882790709667*^9, 
   3.908882840796383*^9}, {3.908989144504107*^9, 3.9089891647649612`*^9}, {
   3.913977517779525*^9, 3.913977567641265*^9}, {3.9139776784272633`*^9, 
   3.9139776813125973`*^9}, {3.913979836896152*^9, 3.913979837196426*^9}, {
   3.913990029592532*^9, 3.913990039108541*^9}, {3.9139904437704*^9, 
   3.913990448268632*^9}, {3.913991711394395*^9, 3.913991714411134*^9}, {
   3.913992167496183*^9, 3.913992225968133*^9}, {3.9283342428981447`*^9, 
   3.928334250621788*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"9441c568-16e7-4d54-979a-0a6f6582267b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1728, 1027},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"351c260d-dece-4bff-9abe-81c784351214"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 326, 5, 103, "Chapter",ExpressionUUID->"e430721c-6c94-4807-8361-69747299fb80"],
Cell[CellGroupData[{
Cell[931, 31, 159, 3, 101, "Section",ExpressionUUID->"7bd6f294-6512-4c33-b551-23c2f5d5cd00"],
Cell[1093, 36, 8093, 199, 2134, "Text",ExpressionUUID->"86175990-b432-49f8-8008-a9587fef0032"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9223, 240, 159, 3, 101, "Section",ExpressionUUID->"2fec88c8-fcd3-4a3d-8ba3-099c31e7900a"],
Cell[9385, 245, 9667, 243, 1469, "Text",ExpressionUUID->"8e7fecf3-81af-4c99-91cd-c5c999a09c19"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19089, 493, 291, 4, 101, "Section",ExpressionUUID->"2befff29-4607-43ee-b123-d9cc4ba1f79d"],
Cell[19383, 499, 1078, 18, 226, "Text",ExpressionUUID->"f1f05168-c25b-4119-932b-dc60df1c1edc"],
Cell[CellGroupData[{
Cell[20486, 521, 157, 3, 67, "Subsubsection",ExpressionUUID->"579eb7ff-cc38-456b-9e23-2900d76ac18e"],
Cell[20646, 526, 2059, 49, 264, "Input",ExpressionUUID->"95366923-800c-4510-bbca-c99dce6b2b3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22742, 580, 160, 3, 67, "Subsubsection",ExpressionUUID->"cda8a5c9-65a1-4d8a-a948-017a5c9f8634"],
Cell[22905, 585, 2111, 50, 264, "Input",ExpressionUUID->"62e2124d-bb5b-490d-ae13-5c501600d4f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25053, 640, 396, 6, 67, "Subsubsection",ExpressionUUID->"755412ed-7b01-492a-b3e6-5e44fcd37f2e"],
Cell[25452, 648, 599, 12, 53, "Text",ExpressionUUID->"fbcc6daa-7dd3-4746-9b19-0d37b4ff1117"],
Cell[26054, 662, 2316, 52, 264, "Input",ExpressionUUID->"abe92b34-73aa-4c67-992e-eaa963301146"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28419, 720, 161, 3, 101, "Section",ExpressionUUID->"b2dbf604-abce-4337-9fc1-b443afbda1d8"],
Cell[28583, 725, 2339, 46, 536, "Text",ExpressionUUID->"90a716b0-6034-4129-a192-046569864003"],
Cell[CellGroupData[{
Cell[30947, 775, 160, 3, 67, "Subsubsection",ExpressionUUID->"72ad302b-a21c-4f1a-9793-fb8412f55a94"],
Cell[31110, 780, 651, 11, 122, "Text",ExpressionUUID->"d8762fda-d5f7-4226-a04f-787e3bc081b5"],
Cell[31764, 793, 1219, 22, 450, "Input",ExpressionUUID->"d75a6f22-ab2b-4fb8-acac-95f22676a355"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33020, 820, 164, 3, 67, "Subsubsection",ExpressionUUID->"14631489-77a5-476d-9529-294c77a7f26c"],
Cell[33187, 825, 187, 3, 53, "Text",ExpressionUUID->"5c8305e4-8cdf-4bd3-a986-dd65d9c462e6"],
Cell[33377, 830, 12848, 225, 729, "Input",ExpressionUUID->"82f4fafa-4f2f-4091-a9ad-cbd08216daa1"],
Cell[46228, 1057, 365, 8, 53, "Text",ExpressionUUID->"d8de29b1-3f47-40fe-8538-f82f205b9ac0"],
Cell[46596, 1067, 2101, 49, 450, "Input",ExpressionUUID->"494ba29f-5b85-4fe9-8963-163ce1c6a0ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48734, 1121, 166, 3, 81, "Subsection",ExpressionUUID->"50b9eff3-6281-41eb-8969-730523eebc02"],
Cell[48903, 1126, 345, 7, 53, "Text",ExpressionUUID->"b4eda8b7-6282-4405-83eb-54bfe8c31a9c"],
Cell[49251, 1135, 3500, 70, 326, "Input",ExpressionUUID->"bfc140f6-6b51-45eb-8d93-2f442c5a7070"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52788, 1210, 160, 3, 81, "Subsection",ExpressionUUID->"b58a7232-80ea-48f0-9ea0-cbb99490d807"],
Cell[52951, 1215, 553, 12, 122, "Text",ExpressionUUID->"3f922bad-4440-4dc2-9cde-e07e33730685"],
Cell[53507, 1229, 2882, 62, 326, "Input",ExpressionUUID->"1e3e5f02-afe2-41f2-afdc-d6f221602c77"],
Cell[56392, 1293, 1376, 31, 124, "Text",ExpressionUUID->"2588b0dc-243e-47cd-a0a8-d928233055a9"],
Cell[57771, 1326, 6174, 143, 705, "Input",ExpressionUUID->"eb4cafcb-5fdf-4c75-91ec-16376a08aa09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63982, 1474, 173, 3, 81, "Subsection",ExpressionUUID->"556f98b9-67ea-47b3-8b22-510e694ba59e"],
Cell[64158, 1479, 424, 8, 88, "Text",ExpressionUUID->"89b7075d-a9ea-4d9c-b5da-e4412bd27f61"],
Cell[64585, 1489, 2764, 60, 326, "Input",ExpressionUUID->"5060bf67-bb44-477e-9415-125a92f223aa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67398, 1555, 269, 4, 101, "Section",ExpressionUUID->"cb747d5d-f73e-494a-b9ff-d29dba124eaf"],
Cell[CellGroupData[{
Cell[67692, 1563, 217, 4, 81, "Subsection",ExpressionUUID->"060a3a68-aec7-4db5-97e9-778c46e1bee0"],
Cell[67912, 1569, 638, 11, 88, "Text",ExpressionUUID->"101066de-ed45-4bda-8c4c-03bd16057d70"],
Cell[68553, 1582, 11109, 209, 915, "Input",ExpressionUUID->"5b11d0d0-8689-477d-84e9-d04e97fc58dc"],
Cell[79665, 1793, 337, 7, 53, "Text",ExpressionUUID->"05f1a6a3-a053-4511-8754-6d09bfd8891f"],
Cell[80005, 1802, 8154, 169, 1194, "Input",ExpressionUUID->"ef859127-62e2-4200-a0a8-1ae6d0d338c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88196, 1976, 255, 4, 81, "Subsection",ExpressionUUID->"ae15a872-cb05-4953-b0d0-93fe9efbbd3f"],
Cell[88454, 1982, 477, 9, 53, "Text",ExpressionUUID->"84e4f979-c891-4cc4-8a05-f646ea240d67"],
Cell[88934, 1993, 9015, 176, 884, "Input",ExpressionUUID->"7c5bfbb3-b2a2-47bd-9269-9671b5f29115"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97986, 2174, 262, 4, 81, "Subsection",ExpressionUUID->"63468aed-46ba-4a59-a779-9ba18249e8b9"],
Cell[98251, 2180, 610, 11, 53, "Text",ExpressionUUID->"3a210247-1ea5-424a-96a4-2b2a7f680627"],
Cell[98864, 2193, 6997, 159, 698, "Input",ExpressionUUID->"24600e74-4327-4629-9932-37dae216260c"],
Cell[105864, 2354, 317, 5, 53, "Text",ExpressionUUID->"434b1606-13cc-4209-a27a-bc800d19feba"],
Cell[106184, 2361, 3933, 80, 605, "Input",ExpressionUUID->"6708ad2c-014e-4037-b05b-bba618212cc7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110154, 2446, 156, 3, 81, "Subsection",ExpressionUUID->"82bd3dba-17ab-45cb-b0e8-392c22ae7655"],
Cell[110313, 2451, 984, 17, 157, "Text",ExpressionUUID->"03fb0196-ee28-48c6-ac29-a2aa223904fd"],
Cell[111300, 2470, 9889, 208, 1039, "Input",ExpressionUUID->"83107b97-5082-4d63-b879-5d3186dcc0cb"],
Cell[121192, 2680, 391, 8, 53, "Text",ExpressionUUID->"411dcd5f-33ef-43c5-9f78-3c21429b4a1f"],
Cell[121586, 2690, 8068, 165, 1225, "Input",ExpressionUUID->"05a14298-f712-4ff1-9651-6e339341b8e4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129703, 2861, 179, 3, 101, "Section",ExpressionUUID->"e9928256-1700-4915-945d-168cfe1e3dac"],
Cell[129885, 2866, 2071, 52, 263, "Text",ExpressionUUID->"6677d032-c05b-48e9-8bb7-9efc61a6c380"],
Cell[131959, 2920, 10929, 250, 884, "Input",ExpressionUUID->"ff4a715e-abe5-44d8-933d-02eeef04241d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142925, 3175, 401, 8, 101, "Section",ExpressionUUID->"fbeb8a4c-3e11-4d46-9b20-15f23a9f2eae"],
Cell[143329, 3185, 2829, 65, 372, "Text",ExpressionUUID->"9f121b8c-4a3f-4e9c-80d1-1ca7b3f2483e"],
Cell[CellGroupData[{
Cell[146183, 3254, 305, 5, 67, "Subsubsection",ExpressionUUID->"e5e3e6d1-7790-4db6-bad8-8ea213257423"],
Cell[146491, 3261, 14234, 242, 1101, "Input",ExpressionUUID->"b6a8e162-346e-4023-95b9-d27e4bfb1ff7"],
Cell[160728, 3505, 326, 7, 53, "Text",ExpressionUUID->"014b0d2b-3888-4781-858f-fadb9eb110dc"],
Cell[161057, 3514, 5313, 136, 667, "Input",ExpressionUUID->"b1351623-ca0c-441f-acea-82291465911e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166407, 3655, 179, 3, 67, "Subsubsection",ExpressionUUID->"a8a23944-c731-40fa-b766-6a56e741f114"],
Cell[166589, 3660, 1121, 20, 158, "Text",ExpressionUUID->"f92edd6a-e5ec-4479-90cf-20e9fab188ae"],
Cell[167713, 3682, 2531, 61, 357, "Input",ExpressionUUID->"a9725832-e0db-413a-9a88-744f022cddf6"],
Cell[170247, 3745, 394, 8, 53, "Text",ExpressionUUID->"638380bc-437d-4754-9081-b970a2bf9cdb"],
Cell[170644, 3755, 4898, 102, 543, "Input",ExpressionUUID->"b9340c8b-0ab7-41e9-93de-4884b21e9c2c"],
Cell[175545, 3859, 272, 6, 53, "Text",ExpressionUUID->"22d8a929-1444-4f13-89d4-fabec27bd83d"],
Cell[175820, 3867, 4250, 111, 574, "Input",ExpressionUUID->"0af02396-70b6-4088-922b-0637e952ae1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180107, 3983, 172, 3, 67, "Subsubsection",ExpressionUUID->"dd283d07-236d-43b2-a72a-0993793bbfc2"],
Cell[180282, 3988, 242, 4, 53, "Text",ExpressionUUID->"e5f7125a-48bd-4cd9-903e-815709ca6aa3"],
Cell[180527, 3994, 7189, 130, 543, "Input",ExpressionUUID->"56ff3fa0-94e4-4f75-bfbf-ca841e9c369c"],
Cell[187719, 4126, 407, 9, 53, "Text",ExpressionUUID->"3d667c12-9b6c-4fd1-bf78-bc9f29a2c94c"],
Cell[188129, 4137, 7238, 177, 1163, "Input",ExpressionUUID->"6e197265-86f4-497a-bc2d-a7a6c1592001"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[195416, 4320, 496, 7, 101, "Section",ExpressionUUID->"e8ecc4a9-291c-46d7-93ad-80d2683ba3d8"],
Cell[195915, 4329, 1231, 19, 122, "Text",ExpressionUUID->"c86db1ce-675f-4cd9-a39d-ccfe3a1e68da"],
Cell[197149, 4350, 1072, 21, 88, "Text",ExpressionUUID->"9ee94525-5e1e-4bf6-bf53-0ad5e2c1c21f"],
Cell[198224, 4373, 9343, 207, 758, "Input",ExpressionUUID->"6cbe6514-08e5-486d-b9d5-4e5745add00e"],
Cell[207570, 4582, 797, 20, 123, "Text",ExpressionUUID->"85a7377e-8aa1-4241-976d-3f0b6bb392cc"],
Cell[208370, 4604, 8542, 203, 977, "Input",ExpressionUUID->"97b4b12b-f4f0-4027-9973-ba277b699133"],
Cell[216915, 4809, 332, 7, 53, "Text",ExpressionUUID->"e7495a45-671f-42b3-9089-4e7d3fc73c75"],
Cell[217250, 4818, 4097, 98, 326, "Input",ExpressionUUID->"30ec953c-81e8-4898-b6ee-f9824e0ab43d"],
Cell[221350, 4918, 239, 4, 53, "Text",ExpressionUUID->"96255731-43ed-4524-aacd-e91d873c5470"],
Cell[221592, 4924, 4361, 101, 543, "Input",ExpressionUUID->"9441c568-16e7-4d54-979a-0a6f6582267b"]
}, Open  ]]
}, Open  ]]
}
]
*)

